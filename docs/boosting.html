<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 æå‡æ–¹æ³• (Boosting) | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</title>
  <meta name="description" content="The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 æå‡æ–¹æ³• (Boosting) | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format is bookdown::gitbook." />
  <meta name="github-repo" content="sxpyggy/Modern-Actuarial-Models" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 æå‡æ–¹æ³• (Boosting) | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹" />
  
  <meta name="twitter:description" content="The output format is bookdown::gitbook." />
  

<meta name="author" content="Modern Actuarial Models" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nn.html"/>
<link rel="next" href="unsupervised-learning.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ğŸ‘¨â€ğŸ« æ¬¢è¿</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ç­”ç–‘"><i class="fa fa-check"></i>ğŸ¤” ç­”ç–‘</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#è¯¾ç¨‹å®‰æ’"><i class="fa fa-check"></i>ğŸ—“ï¸ è¯¾ç¨‹å®‰æ’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>ç®€ä»‹</a></li>
<li class="chapter" data-level="1" data-path="pre.html"><a href="pre.html"><i class="fa fa-check"></i><b>1</b> å‡†å¤‡å·¥ä½œ</a><ul>
<li class="chapter" data-level="1.1" data-path="pre.html"><a href="pre.html#å¸¸ç”¨é“¾æ¥"><i class="fa fa-check"></i><b>1.1</b> å¸¸ç”¨é“¾æ¥</a></li>
<li class="chapter" data-level="1.2" data-path="pre.html"><a href="pre.html#å…‹éš†ä»£ç "><i class="fa fa-check"></i><b>1.2</b> å…‹éš†ä»£ç </a></li>
<li class="chapter" data-level="1.3" data-path="pre.html"><a href="pre.html#r-interface-to-keras"><i class="fa fa-check"></i><b>1.3</b> R interface to Keras</a><ul>
<li class="chapter" data-level="1.3.1" data-path="pre.html"><a href="pre.html#rè‡ªåŠ¨å®‰è£…"><i class="fa fa-check"></i><b>1.3.1</b> Rè‡ªåŠ¨å®‰è£…</a></li>
<li class="chapter" data-level="1.3.2" data-path="pre.html"><a href="pre.html#ä½¿ç”¨reticulateå…³è”condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.3.2</b> ä½¿ç”¨reticulateå…³è”condaç¯å¢ƒ</a></li>
<li class="chapter" data-level="1.3.3" data-path="pre.html"><a href="pre.html#æŒ‡å®šcondaå®‰è£…"><i class="fa fa-check"></i><b>1.3.3</b> æŒ‡å®šcondaå®‰è£…</a></li>
<li class="chapter" data-level="1.3.4" data-path="pre.html"><a href="pre.html#ä½¿ç”¨reticulateå®‰è£…"><i class="fa fa-check"></i><b>1.3.4</b> ä½¿ç”¨reticulateå®‰è£…</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pre.html"><a href="pre.html#r-interface-to-python"><i class="fa fa-check"></i><b>1.4</b> R interface to Python</a><ul>
<li class="chapter" data-level="1.4.1" data-path="pre.html"><a href="pre.html#reticulate-å¸¸è§å‘½ä»¤"><i class="fa fa-check"></i><b>1.4.1</b> reticulate å¸¸è§å‘½ä»¤</a></li>
<li class="chapter" data-level="1.4.2" data-path="pre.html"><a href="pre.html#åˆ‡æ¢rå…³è”çš„condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.4.2</b> åˆ‡æ¢Rå…³è”çš„condaç¯å¢ƒ</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="pre.html"><a href="pre.html#python"><i class="fa fa-check"></i><b>1.5</b> Python</a><ul>
<li class="chapter" data-level="1.5.1" data-path="pre.html"><a href="pre.html#condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.5.1</b> Condaç¯å¢ƒ</a></li>
<li class="chapter" data-level="1.5.2" data-path="pre.html"><a href="pre.html#å¸¸ç”¨çš„condaå‘½ä»¤"><i class="fa fa-check"></i><b>1.5.2</b> å¸¸ç”¨çš„Condaå‘½ä»¤</a></li>
<li class="chapter" data-level="1.5.3" data-path="pre.html"><a href="pre.html#tensorflowpytorch-gpu-version"><i class="fa fa-check"></i><b>1.5.3</b> Tensorflow/Pytorch GPU version</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="french.html"><a href="french.html"><i class="fa fa-check"></i><b>2</b> è½¦é™©ç´¢èµ”é¢‘ç‡é¢„æµ‹</a><ul>
<li class="chapter" data-level="2.1" data-path="french.html"><a href="french.html#èƒŒæ™¯ä»‹ç»"><i class="fa fa-check"></i><b>2.1</b> èƒŒæ™¯ä»‹ç»</a></li>
<li class="chapter" data-level="2.2" data-path="french.html"><a href="french.html#é¢„æµ‹æ¨¡å‹æ¦‚è¿°"><i class="fa fa-check"></i><b>2.2</b> é¢„æµ‹æ¨¡å‹æ¦‚è¿°</a></li>
<li class="chapter" data-level="2.3" data-path="french.html"><a href="french.html#ç‰¹å¾å·¥ç¨‹"><i class="fa fa-check"></i><b>2.3</b> ç‰¹å¾å·¥ç¨‹</a><ul>
<li class="chapter" data-level="2.3.1" data-path="french.html"><a href="french.html#æˆªæ–­"><i class="fa fa-check"></i><b>2.3.1</b> æˆªæ–­</a></li>
<li class="chapter" data-level="2.3.2" data-path="french.html"><a href="french.html#ç¦»æ•£åŒ–"><i class="fa fa-check"></i><b>2.3.2</b> ç¦»æ•£åŒ–</a></li>
<li class="chapter" data-level="2.3.3" data-path="french.html"><a href="french.html#è®¾å®šåŸºç¡€æ°´å¹³"><i class="fa fa-check"></i><b>2.3.3</b> è®¾å®šåŸºç¡€æ°´å¹³</a></li>
<li class="chapter" data-level="2.3.4" data-path="french.html"><a href="french.html#åå˜é‡å˜å½¢"><i class="fa fa-check"></i><b>2.3.4</b> åå˜é‡å˜å½¢</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="french.html"><a href="french.html#è®­ç»ƒé›†-éªŒè¯é›†-æµ‹è¯•é›†"><i class="fa fa-check"></i><b>2.4</b> è®­ç»ƒé›†-éªŒè¯é›†-æµ‹è¯•é›†</a></li>
<li class="chapter" data-level="2.5" data-path="french.html"><a href="french.html#æ³Šæ¾åå·®æŸå¤±å‡½æ•°"><i class="fa fa-check"></i><b>2.5</b> æ³Šæ¾åå·®æŸå¤±å‡½æ•°</a></li>
<li class="chapter" data-level="2.6" data-path="french.html"><a href="french.html#æ³Šæ¾å›å½’æ¨¡å‹"><i class="fa fa-check"></i><b>2.6</b> æ³Šæ¾å›å½’æ¨¡å‹</a></li>
<li class="chapter" data-level="2.7" data-path="french.html"><a href="french.html#æ³Šæ¾å¯åŠ æ¨¡å‹"><i class="fa fa-check"></i><b>2.7</b> æ³Šæ¾å¯åŠ æ¨¡å‹</a></li>
<li class="chapter" data-level="2.8" data-path="french.html"><a href="french.html#æ³Šæ¾å›å½’æ ‘"><i class="fa fa-check"></i><b>2.8</b> æ³Šæ¾å›å½’æ ‘</a></li>
<li class="chapter" data-level="2.9" data-path="french.html"><a href="french.html#éšæœºæ£®æ—"><i class="fa fa-check"></i><b>2.9</b> éšæœºæ£®æ—</a></li>
<li class="chapter" data-level="2.10" data-path="french.html"><a href="french.html#æ³Šæ¾æå‡æ ‘"><i class="fa fa-check"></i><b>2.10</b> æ³Šæ¾æå‡æ ‘</a></li>
<li class="chapter" data-level="2.11" data-path="french.html"><a href="french.html#æ¨¡å‹æ¯”è¾ƒ"><i class="fa fa-check"></i><b>2.11</b> æ¨¡å‹æ¯”è¾ƒ</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nn.html"><a href="nn.html"><i class="fa fa-check"></i><b>3</b> ç¥ç»ç½‘ç»œ</a><ul>
<li class="chapter" data-level="3.1" data-path="nn.html"><a href="nn.html#å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸€èˆ¬æ­¥éª¤"><i class="fa fa-check"></i><b>3.1</b> å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸€èˆ¬æ­¥éª¤</a><ul>
<li class="chapter" data-level="3.1.1" data-path="nn.html"><a href="nn.html#æ˜ç¡®ç›®æ ‡å’Œæ•°æ®ç±»å‹"><i class="fa fa-check"></i><b>3.1.1</b> æ˜ç¡®ç›®æ ‡å’Œæ•°æ®ç±»å‹</a></li>
<li class="chapter" data-level="3.1.2" data-path="nn.html"><a href="nn.html#æ•°æ®é¢„å¤„ç†"><i class="fa fa-check"></i><b>3.1.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="3.1.3" data-path="nn.html"><a href="nn.html#é€‰å–åˆé€‚çš„ç¥ç»ç½‘ç»œç±»å‹"><i class="fa fa-check"></i><b>3.1.3</b> é€‰å–åˆé€‚çš„ç¥ç»ç½‘ç»œç±»å‹</a></li>
<li class="chapter" data-level="3.1.4" data-path="nn.html"><a href="nn.html#å»ºç«‹ç¥ç»ç½‘ç»œå…¨è¿æ¥ç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>3.1.4</b> å»ºç«‹ç¥ç»ç½‘ç»œï¼ˆå…¨è¿æ¥ç¥ç»ç½‘ç»œï¼‰</a></li>
<li class="chapter" data-level="3.1.5" data-path="nn.html"><a href="nn.html#è®­ç»ƒç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>3.1.5</b> è®­ç»ƒç¥ç»ç½‘ç»œ</a></li>
<li class="chapter" data-level="3.1.6" data-path="nn.html"><a href="nn.html#è°ƒå‚"><i class="fa fa-check"></i><b>3.1.6</b> è°ƒå‚</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="nn.html"><a href="nn.html#æ•°æ®é¢„å¤„ç†-1"><i class="fa fa-check"></i><b>3.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="3.3" data-path="nn.html"><a href="nn.html#ç¥ç»ç½‘ç»œæå‡æ¨¡å‹-combined-actuarial-neural-network"><i class="fa fa-check"></i><b>3.3</b> ç¥ç»ç½‘ç»œæå‡æ¨¡å‹ ï¼ˆcombined actuarial neural networkï¼‰</a></li>
<li class="chapter" data-level="3.4" data-path="nn.html"><a href="nn.html#ç¥ç»ç½‘ç»œç»“æ„"><i class="fa fa-check"></i><b>3.4</b> ç¥ç»ç½‘ç»œç»“æ„</a><ul>
<li class="chapter" data-level="3.4.1" data-path="nn.html"><a href="nn.html#ç»“æ„å‚æ•°"><i class="fa fa-check"></i><b>3.4.1</b> ç»“æ„å‚æ•°</a></li>
<li class="chapter" data-level="3.4.2" data-path="nn.html"><a href="nn.html#è¾“å…¥å±‚"><i class="fa fa-check"></i><b>3.4.2</b> è¾“å…¥å±‚</a></li>
<li class="chapter" data-level="3.4.3" data-path="nn.html"><a href="nn.html#embedding-layer"><i class="fa fa-check"></i><b>3.4.3</b> Embedding layer</a></li>
<li class="chapter" data-level="3.4.4" data-path="nn.html"><a href="nn.html#éšè—å±‚"><i class="fa fa-check"></i><b>3.4.4</b> éšè—å±‚</a></li>
<li class="chapter" data-level="3.4.5" data-path="nn.html"><a href="nn.html#è¾“å‡ºå±‚"><i class="fa fa-check"></i><b>3.4.5</b> è¾“å‡ºå±‚</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="nn.html"><a href="nn.html#è®­ç»ƒç¥ç»ç½‘ç»œ-1"><i class="fa fa-check"></i><b>3.5</b> è®­ç»ƒç¥ç»ç½‘ç»œ</a></li>
<li class="chapter" data-level="3.6" data-path="nn.html"><a href="nn.html#æ€»ç»“"><i class="fa fa-check"></i><b>3.6</b> æ€»ç»“</a></li>
<li class="chapter" data-level="3.7" data-path="nn.html"><a href="nn.html#å…¶å®ƒæ¨¡å‹"><i class="fa fa-check"></i><b>3.7</b> å…¶å®ƒæ¨¡å‹</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boosting.html"><a href="boosting.html"><i class="fa fa-check"></i><b>4</b> æå‡æ–¹æ³• (Boosting)</a><ul>
<li class="chapter" data-level="4.1" data-path="boosting.html"><a href="boosting.html#adaboost"><i class="fa fa-check"></i><b>4.1</b> AdaBoost</a></li>
<li class="chapter" data-level="4.2" data-path="boosting.html"><a href="boosting.html#logit-boost-real-discrete-gentle-adaboost"><i class="fa fa-check"></i><b>4.2</b> Logit Boost (real, discrete, gentle AdaBoost)</a></li>
<li class="chapter" data-level="4.3" data-path="boosting.html"><a href="boosting.html#adaboost.m1"><i class="fa fa-check"></i><b>4.3</b> AdaBoost.M1</a></li>
<li class="chapter" data-level="4.4" data-path="boosting.html"><a href="boosting.html#samme-stage-wise-additive-modeling-using-a-multi-class-exponential-loss-function"><i class="fa fa-check"></i><b>4.4</b> SAMME (Stage-wise Additive Modeling using a Multi-class Exponential loss function)</a></li>
<li class="chapter" data-level="4.5" data-path="boosting.html"><a href="boosting.html#samme.r-multi-class-real-adaboost"><i class="fa fa-check"></i><b>4.5</b> SAMME.R (multi-class real AdaBoost)</a></li>
<li class="chapter" data-level="4.6" data-path="boosting.html"><a href="boosting.html#gradient-boosting"><i class="fa fa-check"></i><b>4.6</b> Gradient Boosting</a></li>
<li class="chapter" data-level="4.7" data-path="boosting.html"><a href="boosting.html#newton-boosting"><i class="fa fa-check"></i><b>4.7</b> Newton Boosting</a></li>
<li class="chapter" data-level="4.8" data-path="boosting.html"><a href="boosting.html#xgboost"><i class="fa fa-check"></i><b>4.8</b> XGBoost</a></li>
<li class="chapter" data-level="4.9" data-path="boosting.html"><a href="boosting.html#case-study"><i class="fa fa-check"></i><b>4.9</b> Case study</a><ul>
<li class="chapter" data-level="4.9.1" data-path="boosting.html"><a href="boosting.html#æ•°æ®æè¿°"><i class="fa fa-check"></i><b>4.9.1</b> æ•°æ®æè¿°</a></li>
<li class="chapter" data-level="4.9.2" data-path="boosting.html"><a href="boosting.html#æ•°æ®é¢„å¤„ç†-2"><i class="fa fa-check"></i><b>4.9.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="4.9.3" data-path="boosting.html"><a href="boosting.html#ç‰¹å¾å·¥ç¨‹-1"><i class="fa fa-check"></i><b>4.9.3</b> ç‰¹å¾å·¥ç¨‹</a></li>
<li class="chapter" data-level="4.9.4" data-path="boosting.html"><a href="boosting.html#å»ºæ¨¡æµç¨‹"><i class="fa fa-check"></i><b>4.9.4</b> å»ºæ¨¡æµç¨‹</a></li>
<li class="chapter" data-level="4.9.5" data-path="boosting.html"><a href="boosting.html#æ¨¡å‹åº¦é‡giniç³»æ•°"><i class="fa fa-check"></i><b>4.9.5</b> æ¨¡å‹åº¦é‡â€”â€”Giniç³»æ•°</a></li>
<li class="chapter" data-level="4.9.6" data-path="boosting.html"><a href="boosting.html#å»ºç«‹adaboostæ¨¡å‹"><i class="fa fa-check"></i><b>4.9.6</b> å»ºç«‹AdaBoostæ¨¡å‹</a></li>
<li class="chapter" data-level="4.9.7" data-path="boosting.html"><a href="boosting.html#å»ºç«‹xgboostæ¨¡å‹"><i class="fa fa-check"></i><b>4.9.7</b> å»ºç«‹XGBoostæ¨¡å‹</a></li>
<li class="chapter" data-level="4.9.8" data-path="boosting.html"><a href="boosting.html#ç»“è®º"><i class="fa fa-check"></i><b>4.9.8</b> ç»“è®º</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="boosting.html"><a href="boosting.html#appendix-commonly-used-python-code-for-py-beginners"><i class="fa fa-check"></i><b>4.10</b> Appendix: Commonly used Python code (for py-beginners)</a><ul>
<li class="chapter" data-level="4.10.1" data-path="boosting.html"><a href="boosting.html#pythonæ ‡å‡†æ•°æ®ç±»å‹"><i class="fa fa-check"></i><b>4.10.1</b> Pythonæ ‡å‡†æ•°æ®ç±»å‹</a></li>
<li class="chapter" data-level="4.10.2" data-path="boosting.html"><a href="boosting.html#pythonå†…ç½®å‡½æ•°"><i class="fa fa-check"></i><b>4.10.2</b> Pythonå†…ç½®å‡½æ•°</a></li>
<li class="chapter" data-level="4.10.3" data-path="boosting.html"><a href="boosting.html#numpyåŒ…"><i class="fa fa-check"></i><b>4.10.3</b> numpyåŒ…</a></li>
<li class="chapter" data-level="4.10.4" data-path="boosting.html"><a href="boosting.html#pandasåŒ…"><i class="fa fa-check"></i><b>4.10.4</b> pandasåŒ…</a></li>
<li class="chapter" data-level="4.10.5" data-path="boosting.html"><a href="boosting.html#matplotlibåŒ…"><i class="fa fa-check"></i><b>4.10.5</b> MatplotlibåŒ…</a></li>
<li class="chapter" data-level="4.10.6" data-path="boosting.html"><a href="boosting.html#å¸¸ç”¨æ•™ç¨‹ç½‘å€"><i class="fa fa-check"></i><b>4.10.6</b> å¸¸ç”¨æ•™ç¨‹ç½‘å€</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>5</b> æ— ç›‘ç£å­¦ä¹ æ–¹æ³•</a><ul>
<li class="chapter" data-level="5.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä¸»æˆåˆ†åˆ†æ"><i class="fa fa-check"></i><b>5.1</b> ä¸»æˆåˆ†åˆ†æ</a></li>
<li class="chapter" data-level="5.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#è‡ªç¼–ç "><i class="fa fa-check"></i><b>5.2</b> è‡ªç¼–ç </a><ul>
<li class="chapter" data-level="5.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#æ¨¡å‹è®­ç»ƒ"><i class="fa fa-check"></i><b>5.2.1</b> æ¨¡å‹è®­ç»ƒ</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#èšç±»"><i class="fa fa-check"></i><b>5.3</b> èšç±»</a><ul>
<li class="chapter" data-level="5.3.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>5.3.1</b> K-means clustering</a></li>
<li class="chapter" data-level="5.3.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-medoids-clustering-pam"><i class="fa fa-check"></i><b>5.3.2</b> K-medoids clustering (PAM)</a></li>
<li class="chapter" data-level="5.3.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#gaussian-mixture-modelsgmms"><i class="fa fa-check"></i><b>5.3.3</b> Gaussian mixture models(GMMs)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä½ç»´å¯è§†åŒ–"><i class="fa fa-check"></i><b>5.4</b> ä½ç»´å¯è§†åŒ–</a><ul>
<li class="chapter" data-level="5.4.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#t-sne"><i class="fa fa-check"></i><b>5.4.1</b> t-SNE</a></li>
<li class="chapter" data-level="5.4.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#umap"><i class="fa fa-check"></i><b>5.4.2</b> UMAP</a></li>
<li class="chapter" data-level="5.4.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#som"><i class="fa fa-check"></i><b>5.4.3</b> SOM</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#case-study-1"><i class="fa fa-check"></i><b>5.5</b> Case study</a><ul>
<li class="chapter" data-level="5.5.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#æ•°æ®é¢„å¤„ç†-3"><i class="fa fa-check"></i><b>5.5.1</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="5.5.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä¸»æˆåˆ†åˆ†æ-1"><i class="fa fa-check"></i><b>5.5.2</b> ä¸»æˆåˆ†åˆ†æ</a></li>
<li class="chapter" data-level="5.5.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#è‡ªç¼–ç -1"><i class="fa fa-check"></i><b>5.5.3</b> è‡ªç¼–ç </a></li>
<li class="chapter" data-level="5.5.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means"><i class="fa fa-check"></i><b>5.5.4</b> K-means</a></li>
<li class="chapter" data-level="5.5.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-medoids"><i class="fa fa-check"></i><b>5.5.5</b> K-medoids</a></li>
<li class="chapter" data-level="5.5.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#gaussian-mixture-model"><i class="fa fa-check"></i><b>5.5.6</b> Gaussian mixture model</a></li>
<li class="chapter" data-level="5.5.7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#t-sne-1"><i class="fa fa-check"></i><b>5.5.7</b> t-SNE</a></li>
<li class="chapter" data-level="5.5.8" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#umap-1"><i class="fa fa-check"></i><b>5.5.8</b> UMAP</a></li>
<li class="chapter" data-level="5.5.9" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#kohonen-map"><i class="fa fa-check"></i><b>5.5.9</b> Kohonen map</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/sxpyggy/Modern-Actuarial-Models/tree/modern-actuarial-models" target="blank">GitHub ä»“åº“</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="boosting" class="section level1">
<h1><span class="header-section-number">4</span> æå‡æ–¹æ³• (Boosting)</h1>
<p><em>èŒƒé›¨æ–‡ã€æ¯›é›ªå©·ã€é«˜å…‰è¿œ</em></p>
<blockquote>
<p>Breiman called <strong>AdaBoost</strong> the <strong>â€˜best off-the-shelf classifier in the worldâ€™</strong> (NIPS Workshop 1996).</p>
</blockquote>
<blockquote>
<p>On the data science competition platform Kaggle, among <strong>29</strong> challenge winning solutions in 2015, <strong>17</strong> used <strong>XGBoost</strong>, a boosting algorithm introduced by Chen and Guestrin.</p>
</blockquote>
<p><strong>AdaBooståŠç›¸è¿‘ç®—æ³•</strong></p>
<p>AdaBoostæ˜¯ä¸€ç§è¿­ä»£ç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯è®­ç»ƒä¸åŒçš„åˆ†ç±»å™¨(å¼±åˆ†ç±»å™¨<span class="math inline">\(T\)</span>)ï¼Œç„¶åæŠŠè¿™äº›å¼±åˆ†ç±»å™¨çº¿æ€§ç»„åˆèµ·æ¥ï¼Œæ„æˆä¸€ä¸ªæ›´å¼ºçš„æœ€ç»ˆåˆ†ç±»å™¨ï¼ˆå¼ºåˆ†ç±»å™¨<span class="math inline">\(C\)</span>ï¼‰ã€‚</p>
<p>è¯¥ç®—æ³•æ˜¯ä¸€ä¸ªç®€å•çš„å¼±åˆ†ç±»ç®—æ³•æå‡è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹é€šè¿‡ä¸æ–­çš„è®­ç»ƒï¼Œå¯ä»¥æé«˜å¯¹æ•°æ®çš„åˆ†ç±»èƒ½åŠ›ã€‚æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol style="list-style-type: decimal">
<li><p>é€šè¿‡å¯¹è®­ç»ƒæ ·æœ¬<span class="math inline">\((\mathcal{D},\mathbb{\omega})\)</span>çš„å­¦ä¹ å¾—åˆ°ç¬¬<span class="math inline">\(m-1\)</span>ä¸ªå¼±åˆ†ç±»å™¨<code>WeakClassifier m-1</code>, <span class="math inline">\(T^{(m-1)}\)</span>ï¼›</p></li>
<li><p>è®¡ç®—å¾—å‡ºå…¶åˆ†ç±»é”™è¯¯ç‡<span class="math inline">\(\epsilon^{(m-1)}\)</span>ï¼Œä»¥æ­¤è®¡ç®—å‡ºå…¶å¼±åˆ†ç±»å™¨æƒé‡<span class="math inline">\(\alpha^{(m-1)}\)</span>ä¸æ•°æ®æƒé‡<span class="math inline">\(\omega^{(m-1)}_i\)</span>;</p></li>
<li><p>ç”¨æƒé‡ä¸º<span class="math inline">\(\omega^{(m-1)}_i\)</span>çš„æ•°æ®é›†è®­ç»ƒå¾—åˆ°è®­ç»ƒå¼±åˆ†ç±»å™¨<code>WeakClassifier m</code>, <span class="math inline">\(T^{(m)}\)</span>;</p></li>
<li><p>é‡å¤ä»¥ä¸Šä¸æ–­è¿­ä»£çš„è¿‡ç¨‹;</p></li>
<li><p>æœ€ç»ˆç»“æœé€šè¿‡åŠ æƒæŠ•ç¥¨è¡¨å†³çš„æ–¹æ³•ï¼Œè®©æ‰€æœ‰å¼±åˆ†ç±»å™¨<span class="math inline">\(T^{(m)}\)</span>è¿›è¡Œæƒé‡ä¸º<span class="math inline">\(\alpha^{(m)}\)</span>çš„æŠ•ç¥¨è¡¨å†³çš„æ–¹æ³•å¾—åˆ°æœ€ç»ˆé¢„æµ‹è¾“å‡ºã€‚</p></li>
</ol>
<p><img src="plots/4/overview.png" width="60%" style="display: block; margin: auto;" /></p>
<ul>
<li><p>AdaBoost: Schapire and Freund (1997, 2012)</p></li>
<li><p>LogitBoost: Friedman, Hastie, Tibshirani (1998)</p></li>
<li><p>AdaBoost.M1: Schapire and Freund (1996, 1997)</p></li>
<li><p>SAMME: Zhu, Zou, Rosset et al.Â (2006)</p></li>
<li><p>SAMME.R: Zhu, Zou, Rosset et al.Â (2006)</p></li>
</ul>
<p><strong>æ¢¯åº¦æå‡ç®—æ³•</strong></p>
<p>æ ¸å¿ƒæ€æƒ³: Gradient descent method and Newtonâ€™s method.</p>
<p><em>Gradient descent method</em></p>
<p>Minimize the following approximation over <span class="math inline">\(y\)</span>,
<span class="math display">\[f(y)\approx f(x)+\nabla f(x)^T(y-x) +\frac{1}{2t}||y-x||^2 \]</span>
we have <span class="math inline">\(y=x^+=x-t\nabla f(x)\)</span>.</p>
<p><em>Newtonâ€™s method</em></p>
<p>Minimize the following approximation over <span class="math inline">\(y\)</span>,
<span class="math display">\[f(y)\approx f(x)+\nabla f(x)^T(y-x) +\frac{1}{2}(y-x)^T\nabla^2f(x)(y-x)\]</span>
we have <span class="math inline">\(y=x^+=x-\frac{\nabla f(x)}{\nabla ^2f(x)}\)</span>.</p>
<ul>
<li><p>Gradient Boost: Friedman (2001)</p></li>
<li><p>Newton Boosting: Nielsen (2016)</p></li>
<li><p>XGBoost: Chen and Guestrin (2016)</p></li>
</ul>
<div id="adaboost" class="section level2">
<h2><span class="header-section-number">4.1</span> AdaBoost</h2>
<p><span class="math inline">\(Y\in\{0,1\}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹æƒé‡ <span class="math inline">\(\omega^{(0)}_i=\frac{1}{n}\)</span>.</p></li>
<li><p>ä½¿ç”¨<span class="math inline">\((\mathcal{D},\mathbf{\omega}^{(m-1)})\)</span>ï¼Œè®­ç»ƒå¼±å­¦ä¹ æœº<span class="math inline">\(T^{(m-1)}\)</span>.</p></li>
<li><p>è®¡ç®—åŠ æƒåˆ†ç±»é”™è¯¯ <span class="math display">\[\epsilon^{(m-1)}=\sum_{i=1}^n\omega^{(m-1)}_i \mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i))\]</span></p></li>
<li><p>è®¡ç®—æ¨¡å‹æƒé‡ <span class="math inline">\(\alpha^{(m-1)}=\ln\beta^{(m-1)}\)</span>, å…¶ä¸­<span class="math display">\[\beta^{(m-1)}=\frac{1-\epsilon^{(m-1)}}{\epsilon^{(m-1)}}\]</span></p></li>
<li><p>è®¡ç®—æ ·æœ¬æƒé‡<span class="math display">\[\omega^{(m)}_i=\omega^{(m-1)}_i\exp\left( \alpha^{(m-1)}\mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i)) \right)/w^{(m)}\]</span>, å…¶ä¸­<span class="math inline">\(w^{(m)}\)</span>ä¸ºæ ‡å‡†åŒ–å¸¸æ•°ã€‚</p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º <span class="math display">\[C(\mathbf{x})= \underset{k}{\arg \max} \sum_{m=1}^M\alpha^{(m)}\mathbb{I}(T^{(m)}(\mathbf{x})=k)\]</span></p></li>
</ol>
<p><strong>å¦å¤–ä¸€ç§ç­‰ä»·ç®—æ³•</strong></p>
<p><span class="math inline">\(Y\in\{-1,1\}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹æƒé‡ <span class="math inline">\(\omega^{(0)}_i=\frac{1}{n}\)</span>.</p></li>
<li><p>ä½¿ç”¨<span class="math inline">\((\mathcal{D},\mathbf{\omega}^{(m-1)})\)</span>ï¼Œè®­ç»ƒå¼±å­¦ä¹ æœº<span class="math inline">\(T^{(m-1)}\)</span>.</p></li>
<li><p>è®¡ç®—åŠ æƒåˆ†ç±»é”™è¯¯ <span class="math display">\[\epsilon^{(m-1)}=\sum_{i=1}^n\omega^{(m-1)}_i \mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i))\]</span></p></li>
<li><p>è®¡ç®—æ¨¡å‹æƒé‡ <span class="math inline">\(\alpha^{(m-1)}=\frac{1}{2}\ln\beta^{(m-1)}\)</span>, å…¶ä¸­<span class="math display">\[\beta^{(m-1)}=\frac{1-\epsilon^{(m-1)}}{\epsilon^{(m-1)}}.\]</span></p></li>
<li><p>è®¡ç®—æ ·æœ¬æƒé‡<span class="math display">\[\omega^{(m)}_i=\omega^{(m-1)}_i\exp\left(-\alpha^{(m-1)}y_i T^{(m-1)}(\mathbf{x}_i) \right)/w^{(m)},\]</span> å…¶ä¸­<span class="math inline">\(w^{(m)}\)</span>ä¸ºæ ‡å‡†åŒ–å¸¸æ•°ã€‚</p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º<span class="math display">\[C(\mathbf{x})= \underset{k}{\arg \max} \sum_{m=1}^M\alpha^{(m)}\mathbb{I}(T^{(m)}(\mathbf{x})=k)\]</span></p></li>
</ol>
</div>
<div id="logit-boost-real-discrete-gentle-adaboost" class="section level2">
<h2><span class="header-section-number">4.2</span> Logit Boost (real, discrete, gentle AdaBoost)</h2>
<p><span class="math inline">\(Y\in\{-1,1\}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹å¼±å­¦ä¹ æœº <span class="math inline">\(T^{(0)}=0, C^{(0)}=0\)</span>.</p></li>
<li><p>è®¡ç®—é¢„æµ‹æ¦‚ç‡ <span class="math display">\[p^{(m-1)}(Y_i|\mathbf{x_i})=\frac{1}{1+\exp(-Y_iT^{(m-1)}(\mathbf{x_i}))}\]</span> æ³¨ï¼š<span class="math display">\[p^{(m-1)}(Y_i=1|\mathbf{x_i})+p^{(m-1)}(Y_i=-1|\mathbf{x_i})=1\]</span></p></li>
<li><p>è®¡ç®—æ ·æœ¬æƒé‡ <span class="math display">\[\omega^{(m-1)}_i=p^{(m-1)}(Y_i=y_i|\mathbf{x_i})(1-p^{(m-1)}(Y_i=y_i|\mathbf{x_i}))\]</span></p></li>
<li><p>è®¡ç®—å·¥ä½œå› å˜é‡ <span class="math display">\[z^{(m)}_i = y_i(1+\exp(-y_i C^{(m-1)}(\mathbf{x_i})))\]</span></p></li>
<li><p>è®­ç»ƒå¼±å­¦ä¹ æœº<span class="math inline">\(T^{(m)}\)</span>ï¼Œä½¿ä¹‹æœ€å°åŒ–å¦‚ä¸‹åŠ æƒæŸå¤±å‡½æ•° <span class="math display">\[\sum_{i=1}^N \omega_i^{(m-1)}(T^{(m)}(\mathbf{x_i})-z^{(m-1)}_i)^2\]</span></p></li>
<li><p>ä»¤<span class="math inline">\(C^{(m)}=C^{(m-1)}+T^{(m)}\)</span></p></li>
<li><p>æœ€ç»ˆé¢„æµ‹æ¦‚ç‡ä¸º<span class="math display">\[\Pr(Y=y|\mathbf{x})= \frac{1}{1+\exp(-yC^{(m)}(\mathbf{x_i}))}\]</span></p></li>
</ol>
</div>
<div id="adaboost.m1" class="section level2">
<h2><span class="header-section-number">4.3</span> AdaBoost.M1</h2>
<p><span class="math inline">\(Y\in\{1,\ldots,K\}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹æƒé‡ <span class="math inline">\(\omega^{(0)}_i=\frac{1}{n}\)</span>.</p></li>
<li><p>ä½¿ç”¨<span class="math inline">\((\mathcal{D},\mathbf{\omega}^{(m-1)})\)</span>ï¼Œè®­ç»ƒå¼±å­¦ä¹ æœº<span class="math inline">\(T^{(m-1)}\)</span>.</p></li>
<li><p>è®¡ç®—åŠ æƒåˆ†ç±»é”™è¯¯ <span class="math display">\[\epsilon^{(m-1)}=\sum_{i=1}^n\omega^{(m-1)}_i \mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i))\]</span></p></li>
<li><p>è®¡ç®—æ¨¡å‹æƒé‡ <span class="math inline">\(\alpha^{(m-1)}=\ln\beta^{(m-1)}\)</span>, å…¶ä¸­<span class="math display">\[\beta^{(m-1)}=\frac{1-\epsilon^{(m-1)}}{\epsilon^{(m-1)}}\]</span></p></li>
<li><p>è®¡ç®—æ ·æœ¬æƒé‡<span class="math display">\[\omega^{(m)}_i=\omega^{(m-1)}_i\exp\left( \alpha^{(m-1)}\mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i)) \right)/w^{(m)},\]</span> å…¶ä¸­<span class="math inline">\(w^{(m)}\)</span>ä¸ºæ ‡å‡†åŒ–å¸¸æ•°ã€‚</p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º <span class="math display">\[C(\mathbf{x})= \underset{k}{\arg \max} \sum_{m=1}^M\alpha^{(m)}\mathbb{I}(T^{(m)}(\mathbf{x})=k)\]</span></p></li>
</ol>
</div>
<div id="samme-stage-wise-additive-modeling-using-a-multi-class-exponential-loss-function" class="section level2">
<h2><span class="header-section-number">4.4</span> SAMME (Stage-wise Additive Modeling using a Multi-class Exponential loss function)</h2>
<p><span class="math inline">\(Y\in \{1,\ldots,K\}\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹æƒé‡ <span class="math inline">\(\omega^{(0)}_i=\frac{1}{n}\)</span>.</p></li>
<li><p>ä½¿ç”¨<span class="math inline">\((\mathcal{D},\mathbf{\omega}^{(m-1)})\)</span>ï¼Œè®­ç»ƒå¼±å­¦ä¹ æœº<span class="math inline">\(T^{(m-1)}\)</span>.</p></li>
<li><p>è®¡ç®—åŠ æƒåˆ†ç±»é”™è¯¯ <span class="math display">\[\epsilon^{(m-1)}=\sum_{i=1}^n\omega^{(m-1)}_i \mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i))\]</span></p></li>
<li><p>è®¡ç®—æ¨¡å‹æƒé‡ <span class="math display">\[\alpha^{(m-1)}=\eta\left(\ln\beta^{(m-1)}+\ln (k-1)\right),\]</span> å…¶ä¸­<span class="math display">\[\beta^{(m-1)}=\frac{1-\epsilon^{(m-1)}}{\epsilon^{(m-1)}}\]</span></p></li>
<li><p>è®¡ç®—æ ·æœ¬æƒé‡<span class="math display">\[\omega^{(m)}_i=\omega^{(m-1)}_i\exp\left( \alpha^{(m-1)}\mathbb{I}(y_i \neq T^{(m-1)}(\mathbf{x}_i)) \right)/w^{(m)},\]</span> å…¶ä¸­<span class="math inline">\(w^{(m)}\)</span>ä¸ºæ ‡å‡†åŒ–å¸¸æ•°ã€‚</p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º <span class="math display">\[C(\mathbf{x})= \underset{k}{\arg \max} \sum_{m=1}^M\alpha^{(m)}\mathbb{I}(T^{(m)}(\mathbf{x})=k)\]</span></p></li>
</ol>
</div>
<div id="samme.r-multi-class-real-adaboost" class="section level2">
<h2><span class="header-section-number">4.5</span> SAMME.R (multi-class real AdaBoost)</h2>
<p>è§<a href="https://web.stanford.edu/~hastie/Papers/samme.pdf" class="uri">https://web.stanford.edu/~hastie/Papers/samme.pdf</a></p>
<p><span class="math inline">\(Y\in \{1,\ldots,K\},\mathbf{Z}=(Z_1,\ldots,Z_k)&#39;\in\{1,-1/(K-1)\}^K\)</span>, å»ºç«‹æ˜ å°„<span class="math inline">\(\{1,\ldots,K\}\rightarrow \{1,-1/(K-1)\}^K, Y\mapsto \mathbf{Z}(Y)\)</span>, å…¶ä¸­<span class="math inline">\(Z_k(k)=1\)</span>, ä¸”<span class="math inline">\(Z_{k&#39;}(k)=-1/(K-1), k&#39;\neq k\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹æƒé‡ <span class="math inline">\(\omega^{(0)}_i=\frac{1}{n}\)</span>.</p></li>
<li><p>ä½¿ç”¨<span class="math inline">\((\mathcal{D},\mathbf{\omega}^{(m-1)})\)</span>ï¼Œè®­ç»ƒå¼±å­¦ä¹ æœº<span class="math inline">\(T^{(m-1)}\)</span>.</p></li>
<li><p>æ ¹æ®<span class="math inline">\(T^{(m-1)}\)</span>è®¡ç®—(åŠ æƒ)é¢„æµ‹é¢‘ç‡ <span class="math display">\[p_k^{(m-1)}(\mathbf{x})=\Pr(y=k|\mathbf{x}),\]</span> ä»¤<span class="math inline">\(\mathbf{p}^{(m-1)}(\mathbf{x})=(p_1^{(m-1)}(\mathbf{x}), \ldots,p_K^{(m-1)}(\mathbf{x}))&#39;\)</span></p></li>
<li><p>è®¡ç®—æ¨¡å‹(é¢„æµ‹ä¸º<span class="math inline">\(k\)</span>)æƒé‡ <span class="math display">\[h^{(m-1)}_k(\mathbf{x})=(K-1)\left(\ln p^{(m-1)}_k(\mathbf{x})-\frac{1}{K}\sum_{k&#39;\neq k} \ln p_{k&#39;}^{(m-1)}(\mathbf{x})\right)\]</span></p></li>
<li><p>è®¡ç®—æ ·æœ¬æƒé‡<span class="math display">\[\omega^{(m)}_i=\omega^{(m-1)}_i\exp\left( -\frac{K-1}{K}\mathbf{Z}(y_i)^{T}\ln p^{(m-1)}(x_i) \right)/w^{(m)},\]</span> å…¶ä¸­<span class="math inline">\(w^{(m)}\)</span>ä¸ºæ ‡å‡†åŒ–å¸¸æ•°ã€‚</p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º <span class="math display">\[C(\mathbf{x})= \underset{k}{\arg \max} \sum_{m=1}^M h_k^{(m)}(\mathbf{x})\]</span></p></li>
</ol>
<p>å‚è€ƒ<code>Multiclass exponential loss</code> <span class="math display">\[L(Z,f)=\exp\left(-\frac{1}{K}Z^Tf\right)\]</span></p>
</div>
<div id="gradient-boosting" class="section level2">
<h2><span class="header-section-number">4.6</span> Gradient Boosting</h2>
<p><span class="math inline">\(Y\in\{-1,1\}\)</span>ï¼Œè®¾å®šå­¦ä¹ ç‡<span class="math inline">\(\eta\in(0,1]\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹å¼±å­¦ä¹ å™¨
<span class="math display">\[f_0(\mathbf{x})= \underset{\theta\in\mathbb{R}}{\arg \min} \sum_{i=1}^n L(Y_i, \theta)\]</span></p></li>
<li><p>è®¡ç®—ç¬¬<span class="math inline">\(m\)</span>æ¬¡è¿­ä»£ä¸­,æŸå¤±å‡½æ•°çš„è´Ÿæ¢¯åº¦<span class="math display">\[g_m(\mathbf{x_i}) = - \frac{\partial L(Y_i, f_i)}{\partial f_{m-1,i}}\]</span></p></li>
<li><p>æ±‚è§£å¼±å­¦ä¹ å™¨<span class="math inline">\(T^m\)</span>å‚æ•° <span class="math display">\[h_m^{*} = \underset{h\in\mathcal{F},\beta}{\arg \min} \sum_{i=1}^n(g_m(\mathbf{x_i}) - \beta h(\mathbf{x_i}))^2 \]</span></p></li>
<li><p>é€šè¿‡çº¿æœç´¢å¾—åˆ°æ­¥é•¿ <span class="math display">\[\rho_m = \underset{\rho&gt;0}{\arg \min} \sum_{i=1}^n L(Y_i,f_{m-1}(\mathbf{x_i}) + \rho h_m^{*}(\mathbf{x_i}))\]</span></p></li>
<li><p>shrinkageï¼Œä¹˜ä»¥æå‰ç»™å®šçš„å­¦ä¹ ç‡ <span class="math display">\[f_m^{*} = \eta\rho_m h_m^{*}\]</span></p></li>
<li><p>æ›´æ–°ï¼Œå‰<span class="math inline">\(m\)</span>ä¸ªå¼±å­¦ä¹ å™¨çš„çº¿æ€§ç»„åˆ <span class="math display">\[f_m(\mathbf{x}) = f_{m-1}(\mathbf{x}) + f_{m}^*(\mathbf{x}) \]</span></p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º <span class="math inline">\(f_M(\mathbf{x})\)</span></p></li>
</ol>
</div>
<div id="newton-boosting" class="section level2">
<h2><span class="header-section-number">4.7</span> Newton Boosting</h2>
<p><span class="math inline">\(Y\in\{-1,1\}\)</span>ï¼Œè®¾å®šå­¦ä¹ ç‡<span class="math inline">\(\eta\in(0,1]\)</span></p>
<ol style="list-style-type: decimal">
<li><p>åˆå§‹å¼±å­¦ä¹ å™¨<span class="math display">\[f_0(\mathbf{x})= \underset{\theta\in\mathbb{R}}{\arg \min} \sum_{i=1}^n L(Y_i, \theta)\]</span></p></li>
<li><p>è®¡ç®—ç¬¬<span class="math inline">\(m\)</span>æ¬¡è¿­ä»£ä¸­çš„è´Ÿæ¢¯åº¦<span class="math display">\[g_m(\mathbf{x_i}) = - \frac{\partial L(Y_i, \theta)}{\partial f_{m-1,i}}\]</span></p></li>
<li><p>è®¡ç®—Hessian Matrix <span class="math display">\[H_m(\mathbf{x_i}) = (\nabla^2\mathcal{L}(\mathbb{f_{m-1}}))_{ii}\]</span></p></li>
<li><p>æ±‚è§£å¼±å­¦ä¹ å™¨<span class="math inline">\(T^m\)</span>å‚æ•°<span class="math display">\[h_m^{*} = \underset{h\in\mathcal{F}}{\arg \min} \sum_{i=1}^n(\frac{g_m(\mathbf{x_i})}{H_m(\mathbf{x_i})} + \frac{1}{2} H_m(\mathbf{x_i})h(\mathbf{x_i}))^2 \\ 
= \underset{h\in\mathcal{F}}{\arg \min} \sum_{i=1}^n\frac{1}{2} H_m(\mathbf{x_i})(-\frac{g_m(\mathbf{x_i})}{H_m(\mathbf{x_i})} - h(\mathbf{x_i}))^2 \]</span></p></li>
<li><p>shrinkageï¼Œä¹˜ä»¥æå‰ç»™å®šçš„å­¦ä¹ ç‡<span class="math display">\[f_m^{*} = \eta h_m^{*}\]</span></p></li>
<li><p>æ›´æ–°ï¼Œå‰<span class="math inline">\(m\)</span>ä¸ªå¼±å­¦ä¹ å™¨çš„çº¿æ€§ç»„åˆ <span class="math display">\[f_m(\mathbf{x}) = f_{m-1}(\mathbf{x}) + f_{m}^*(\mathbf{x}) \]</span></p></li>
<li><p>æœ€ç»ˆé¢„æµ‹ç»“æœä¸º <span class="math inline">\(f_M(\mathbf{x})\)</span></p></li>
</ol>
</div>
<div id="xgboost" class="section level2">
<h2><span class="header-section-number">4.8</span> XGBoost</h2>
<ol style="list-style-type: decimal">
<li><p>objective function:
<span class="math display">\[\mathcal{L} =\sum_{i=1}^n L(\hat{y_i},y_i) + \sum_{m=1}^M\Omega(f_m)\]</span> where <span class="math inline">\(L(\hat{y_i},y_i)\)</span> is a differential convex loss function and <span class="math inline">\(\Omega(f_m) = \gamma T + \frac{1}{2}\lambda||\omega||^2\)</span> is a regularization term to penalize model complexity (including number of leaves <span class="math inline">\(T\)</span> and <span class="math inline">\(L^2\)</span>-norm of leaf scores <span class="math inline">\(\omega\)</span>)</p></li>
<li><p>Newton approximation of objective function:
<span class="math display">\[\tilde{\mathcal{L}}^m = \sum_{i=1}^n \lbrack L(\hat{y_i}^{m-1},y_i) + g_if_m(\mathbf{x_i}) + \frac{1}{2}h_if_m^2(\mathbf{x_i}) \rbrack+\Omega(f_m) \]</span> where <span class="math inline">\(g_i = \frac{\partial L}{\partial\hat{y_i}^{m-1}}|_{(\hat{y_i}^{m-1}, y_i)}\)</span> and <span class="math inline">\(h_i= \frac{\partial^2 L}{\partial\hat{y_i}^{m-1}\partial\hat{y_i}^{m-1}}|_{(\hat{y_i}^{m-1}, y_i)}\)</span></p></li>
<li><p>æœ€å°åŒ–ä¸Šè¿°å¼å­ï¼Œå¾—åˆ°the optimal score (or weight) <span class="math inline">\(\omega_j^*\)</span> of leaf <span class="math inline">\(j\in\{1,\dots,T\}\)</span>is:<span class="math display">\[ \omega_j^*=-\frac{\sum_{i=1}^n g_i \mathbb{I}[q(\mathbf{x_i}) = j]}{\lambda + \sum_{i=1}^nh_i\mathbb{I}[q(\mathbf{x_i}) = j]} \]</span></p></li>
</ol>
<p><img src="plots/4/summary.png" width="60%"  style="display: block; margin: auto;" /></p>
</div>
<div id="case-study" class="section level2">
<h2><span class="header-section-number">4.9</span> Case study</h2>
<p>æœ¬æ¡ˆä¾‹çš„æ•°æ®æ¥æºäºKaggleä¸Šçš„æ¯”èµ›â€œPorto Seguroâ€™s Safe Driver Prediction Competitionâ€ã€‚</p>
<p>æ¯”èµ›çš„ç›®æ ‡æ˜¯é¢„æµ‹æœªæ¥ä¸€å¹´å¸æœºæ˜¯å¦ä¼šå‘ç”Ÿäº¤é€šäº‹æ•…ï¼Œæ˜¯ä¸€ä¸ª<strong>äºŒåˆ†ç±»</strong>é—®é¢˜ã€‚æ­¤æ¡ˆä¾‹ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½ç»è¿‡äº†åŒ¿ååŒ–å¤„ç†ã€‚</p>
<div id="æ•°æ®æè¿°" class="section level3">
<h3><span class="header-section-number">4.9.1</span> æ•°æ®æè¿°</h3>
<p>æ•°æ®åŒ…å«595212æ¡è®°å½•ï¼Œ59ä¸ªå˜é‡ã€‚</p>
<p>å˜é‡åŒ…å«ä¸‰ç±»ï¼š</p>
<ul>
<li>å”¯ä¸€ç¼–ç ï¼ˆ1ä¸ªï¼‰ï¼š<code>id</code></li>
<li>ç›®æ ‡å˜é‡ï¼ˆ1ä¸ªï¼‰ï¼š<code>target</code>ï¼Œå–å€¼ä¸º<span class="math inline">\(\{0, 1\}\)</span></li>
<li>è§£é‡Šå˜é‡ï¼ˆ57ä¸ªï¼‰ï¼š<code>ps_*</code>ï¼ŒåŒ…æ‹¬å››ç§ï¼Œåˆ†åˆ«æ˜¯äºŒåˆ†ç±»å˜é‡ï¼ˆbinaryï¼‰ï¼Œå¤šåˆ†ç±»å˜é‡ï¼ˆcategoricalï¼‰ï¼Œè¿ç»­å‹å˜é‡ï¼ˆcontinuousï¼‰ï¼Œå®šåºå˜é‡ï¼ˆordinalï¼‰ã€‚</li>
</ul>
<p>æ­¤æ¡ˆä¾‹ä¸­ï¼Œç¼ºå¤±å€¼ç”¨-1è¡¨ç¤ºã€‚</p>
<p><img src="plots/4/%E6%95%B0%E6%8D%AE%E6%8F%8F%E8%BF%B0.png" width="60%"  style="display: block; margin: auto;" /></p>
</div>
<div id="æ•°æ®é¢„å¤„ç†-2" class="section level3">
<h3><span class="header-section-number">4.9.2</span> æ•°æ®é¢„å¤„ç†</h3>
<ol style="list-style-type: decimal">
<li>ç»Ÿè®¡ç¼ºå¤±å€¼</li>
</ol>
<p>æ•°æ®ä¸­ï¼Œ<code>ps_car_03_cat</code>å’Œ<code>ps_car_05_cat</code>çš„ç¼ºå¤±å€¼è¾ƒå¤šï¼Œç¼ºå¤±å€¼åˆ†åˆ«å 69.09%å’Œ44.78%ï¼Œä¹‹åå°†è¿›è¡Œç¼ºå¤±å€¼å¤„ç†ã€‚</p>
<p><img src="plots/4/%E7%BC%BA%E5%A4%B1%E5%80%BC.png" width="60%"  style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>å•å˜é‡åˆ†æ</li>
</ol>
<p>å¯¹äºä¸åŒç±»å‹çš„è§£é‡Šå˜é‡ï¼Œæˆ‘ä»¬å°†ä¾ç…§ä¸åŒçš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<ul>
<li><p>åˆ†ç±»å˜é‡ï¼Œç»Ÿè®¡å„ä¸ªç±»åˆ«çš„å æ¯”</p></li>
<li><p>å®šè·å’Œå®šåºå˜é‡ï¼Œä½œæ¡å½¢å›¾</p></li>
<li><p>æ•°å€¼å‹å˜é‡ï¼Œä½œç›´æ–¹å›¾</p></li>
</ul>
<p>å¯¹äºç›®æ ‡å˜é‡ï¼Œæˆ‘ä»¬å‘ç°å®ƒçš„å–å€¼éå¸¸ä¸å¹³è¡¡ã€‚</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="boosting.html#cb37-1"></a><span class="co"># levels for the target variable </span></span>
<span id="cb37-2"><a href="boosting.html#cb37-2"></a>lev_target <span class="op">=</span> ( pd.crosstab(index <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>], columns <span class="op">=</span> <span class="st">&#39;Frequency&#39;</span>) <span class="op">/</span> data.shape[<span class="dv">0</span>] ) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb37-3"><a href="boosting.html#cb37-3"></a>lev_target.<span class="bu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<p>é€šå¸¸æ¥è¯´ï¼Œå¤„ç†<strong>ä¸å¹³è¡¡</strong>çš„åˆ†ç±»æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li><p>SMOTEï¼ˆSynthetic Minority Oversampling Techniqueï¼‰</p></li>
<li><p>ä¸Šé‡‡æ ·ï¼ˆOver-samplingï¼‰</p></li>
<li><p>ä¸‹é‡‡æ ·ï¼ˆUnder-samplingï¼‰</p></li>
<li><p>åŠ æƒæŠ½æ ·ï¼ˆSampling Weightingï¼‰</p></li>
<li><p>æˆæœ¬æ•æ„Ÿè®­ç»ƒï¼ˆCost-sensitive Trainingï¼‰</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>å¤šå˜é‡åˆ†æ</li>
</ol>
<p>åœ¨ä¸åŒçš„è§£é‡Šå˜é‡ä¹‹é—´ï¼Œæˆ‘ä»¬å¯ä»¥ä½œç›¸å…³ç³»æ•°çŸ©é˜µçƒ­å›¾å’Œæ•£ç‚¹å›¾çŸ©é˜µã€‚</p>
<ul>
<li>ç›¸å…³ç³»æ•°çŸ©é˜µçƒ­å›¾</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="boosting.html#cb38-1"></a><span class="co"># Pearson correlation matrix: computation and visualization</span></span>
<span id="cb38-2"><a href="boosting.html#cb38-2"></a></span>
<span id="cb38-3"><a href="boosting.html#cb38-3"></a><span class="co"># use method=&#39;pearson&#39; resp. method=&#39;spearman&#39; to compute Pearson resp. Spearman correlations</span></span>
<span id="cb38-4"><a href="boosting.html#cb38-4"></a><span class="kw">def</span> corr_heatmap(v):</span>
<span id="cb38-5"><a href="boosting.html#cb38-5"></a>    correlations <span class="op">=</span> data[v].corr(method<span class="op">=</span><span class="st">&#39;pearson&#39;</span>)</span>
<span id="cb38-6"><a href="boosting.html#cb38-6"></a>    fig <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb38-7"><a href="boosting.html#cb38-7"></a></span>
<span id="cb38-8"><a href="boosting.html#cb38-8"></a>    sns.heatmap(correlations,  center<span class="op">=</span><span class="dv">0</span>, fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>, cbar<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb38-9"><a href="boosting.html#cb38-9"></a>                square<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="dv">1</span>, annot<span class="op">=</span><span class="va">True</span>,  cmap<span class="op">=</span><span class="st">&quot;YlGnBu&quot;</span>)</span>
<span id="cb38-10"><a href="boosting.html#cb38-10"></a>    plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>) </span>
<span id="cb38-11"><a href="boosting.html#cb38-11"></a>    plt.yticks(rotation<span class="op">=</span><span class="dv">0</span>) </span>
<span id="cb38-12"><a href="boosting.html#cb38-12"></a>    plt.show()</span>
<span id="cb38-13"><a href="boosting.html#cb38-13"></a></span>
<span id="cb38-14"><a href="boosting.html#cb38-14"></a><span class="co"># one applies the corr_heatmap function on the interval features    </span></span>
<span id="cb38-15"><a href="boosting.html#cb38-15"></a>v <span class="op">=</span> meta[(meta.level <span class="op">==</span> <span class="st">&#39;interval&#39;</span>) <span class="op">&amp;</span> (meta.keep)].index</span>
<span id="cb38-16"><a href="boosting.html#cb38-16"></a>corr_heatmap(v)</span></code></pre></div>
<p><img src="plots/4/%E7%9B%B8%E5%85%B3%E7%B3%BB%E6%95%B0%E7%9F%A9%E9%98%B5%E7%83%AD%E5%9B%BE.png" width="60%"  style="display: block; margin: auto;" /></p>
<ul>
<li>æ•£ç‚¹å›¾çŸ©é˜µ</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="boosting.html#cb39-1"></a><span class="co"># scatterplot high correlation interval variables</span></span>
<span id="cb39-2"><a href="boosting.html#cb39-2"></a><span class="im">import</span> seaborn</span>
<span id="cb39-3"><a href="boosting.html#cb39-3"></a>high <span class="op">=</span> pd.Index([<span class="st">&#39;ps_reg_01&#39;</span>, <span class="st">&#39;ps_reg_02&#39;</span>, <span class="st">&#39;ps_reg_03&#39;</span>, <span class="st">&#39;ps_car_12&#39;</span>, <span class="st">&#39;ps_car_13&#39;</span>, <span class="st">&#39;ps_car_15&#39;</span>])</span>
<span id="cb39-4"><a href="boosting.html#cb39-4"></a>pd.plotting.scatter_matrix(data[high], alpha <span class="op">=</span> <span class="fl">0.2</span>, figsize <span class="op">=</span> (<span class="dv">40</span>, <span class="dv">40</span>), diagonal <span class="op">=</span> <span class="st">&#39;kde&#39;</span>)</span></code></pre></div>
<p><img src="plots/4/%E6%95%A3%E7%82%B9%E5%9B%BE%E7%9F%A9%E9%98%B5.png" width="80%"  style="display: block; margin: auto;" /></p>
<p>åœ¨è§£é‡Šå˜é‡å’Œç›®æ ‡å˜é‡ä¹‹é—´ï¼Œæˆ‘ä»¬å¯ä»¥ä½œæ•£ç‚¹å›¾ã€ç®±çº¿å›¾ã€æ¡å½¢å›¾ç­‰ã€‚</p>
<p><img src="plots/4/target_vs_features.png" width="80%"  style="display: block; margin: auto;" /></p>
</div>
<div id="ç‰¹å¾å·¥ç¨‹-1" class="section level3">
<h3><span class="header-section-number">4.9.3</span> ç‰¹å¾å·¥ç¨‹</h3>
<ol style="list-style-type: decimal">
<li>åˆ é™¤å˜é‡</li>
</ol>
<p>ä¸ºäº†ç®€åŒ–åˆ†æã€æå‡è®¡ç®—é€Ÿåº¦ï¼Œåˆ é™¤14ä¸ªå®šè·å˜é‡ï¼ˆintervalï¼‰å’Œå®šåºå˜é‡ï¼ˆordinalï¼‰
<code>ps_calc_01</code>ï¼Œ<code>ps_calc_02</code>ï¼Œ<code>ps_calc_03</code>ï¼Œ<code>ps_calc_04</code>ï¼Œ<code>ps_calc_05</code>ï¼Œ<code>ps_calc_06</code>ï¼Œ<code>ps_calc_07</code>ï¼Œ<code>ps_calc_08</code>ï¼Œ<code>ps_calc_09</code>ï¼Œ<code>ps_calc_10</code>ï¼Œ<code>ps_calc_11</code>ï¼Œ<code>ps_calc_12</code>ï¼Œ<code>ps_calc_13</code>ï¼Œ<code>ps_calc_14</code>ã€‚</p>
<ol start="2" style="list-style-type: decimal">
<li>ç¼ºå¤±å€¼å¤„ç†</li>
</ol>
<ul>
<li><p>åˆ é™¤ç¼ºå¤±å€¼è¾ƒå¤šçš„å˜é‡<code>ps_car_03_cat</code>å’Œ<code>ps_car_05_cat</code></p></li>
<li><p>å‡å€¼æ’è¡¥è¿ç»­å‹å˜é‡<code>ps_reg_03</code>ï¼Œ<code>ps_car_12</code>å’Œ<code>ps_car_14</code></p></li>
<li><p>ä¼—æ•°æ’è¡¥åˆ†ç±»å˜é‡<code>ps_car_11</code></p></li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="boosting.html#cb40-1"></a><span class="co"># dropping &#39;ps_car_03_cat&#39;, &#39;ps_car_05_cat&#39; and updating meta information</span></span>
<span id="cb40-2"><a href="boosting.html#cb40-2"></a>vars_to_drop <span class="op">=</span> [<span class="st">&#39;ps_car_03_cat&#39;</span>, <span class="st">&#39;ps_car_05_cat&#39;</span>]</span>
<span id="cb40-3"><a href="boosting.html#cb40-3"></a>data.drop(vars_to_drop, inplace <span class="op">=</span> <span class="va">True</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb40-4"><a href="boosting.html#cb40-4"></a>meta.loc[(vars_to_drop), <span class="st">&#39;keep&#39;</span>] <span class="op">=</span> <span class="va">False</span>  </span>
<span id="cb40-5"><a href="boosting.html#cb40-5"></a></span>
<span id="cb40-6"><a href="boosting.html#cb40-6"></a><span class="co"># imputing with the mean or mode using Imputer from sklearn.preprocessing</span></span>
<span id="cb40-7"><a href="boosting.html#cb40-7"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> Imputer</span>
<span id="cb40-8"><a href="boosting.html#cb40-8"></a></span>
<span id="cb40-9"><a href="boosting.html#cb40-9"></a>mean_imp <span class="op">=</span> Imputer(missing_values <span class="op">=</span> <span class="dv">-1</span>, strategy <span class="op">=</span> <span class="st">&#39;mean&#39;</span>, axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb40-10"><a href="boosting.html#cb40-10"></a>mode_imp <span class="op">=</span> Imputer(missing_values <span class="op">=</span> <span class="dv">-1</span>, strategy <span class="op">=</span> <span class="st">&#39;most_frequent&#39;</span>, axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb40-11"><a href="boosting.html#cb40-11"></a></span>
<span id="cb40-12"><a href="boosting.html#cb40-12"></a>data[<span class="st">&#39;ps_reg_03&#39;</span>] <span class="op">=</span> mean_imp.fit_transform(data[[<span class="st">&#39;ps_reg_03&#39;</span>]]).ravel()</span>
<span id="cb40-13"><a href="boosting.html#cb40-13"></a>data[<span class="st">&#39;ps_car_12&#39;</span>] <span class="op">=</span> mean_imp.fit_transform(data[[<span class="st">&#39;ps_car_12&#39;</span>]]).ravel()</span>
<span id="cb40-14"><a href="boosting.html#cb40-14"></a>data[<span class="st">&#39;ps_car_14&#39;</span>] <span class="op">=</span> mean_imp.fit_transform(data[[<span class="st">&#39;ps_car_14&#39;</span>]]).ravel()</span>
<span id="cb40-15"><a href="boosting.html#cb40-15"></a>data[<span class="st">&#39;ps_car_11&#39;</span>] <span class="op">=</span> mode_imp.fit_transform(data[[<span class="st">&#39;ps_car_11&#39;</span>]]).ravel()</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>ç”Ÿæˆå“‘å˜é‡</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="boosting.html#cb41-1"></a><span class="co"># creating dummy variables</span></span>
<span id="cb41-2"><a href="boosting.html#cb41-2"></a>data <span class="op">=</span> pd.get_dummies(data, columns <span class="op">=</span> v, drop_first <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb41-3"><a href="boosting.html#cb41-3"></a><span class="bu">print</span>(<span class="st">&#39;After dummification we have </span><span class="sc">{}</span><span class="st"> variables in data&#39;</span>.<span class="bu">format</span>(data.shape[<span class="dv">1</span>]))</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>åˆ’åˆ†å­¦ä¹ é›†å’Œæµ‹è¯•é›†</li>
</ol>
<p>ä»¥80:20çš„æ¯”ä¾‹åˆ’åˆ†å­¦ä¹ é›†å’Œæµ‹è¯•é›†ï¼Œåˆ†åˆ«è®°ä½œ<code>(X_train, y_train)</code>å’Œ<code>(X_test, y_test)</code>ã€‚</p>
<p>ç»è¿‡åˆ’åˆ†ï¼Œå­¦ä¹ é›†æœ‰476169æ¡è®°å½•ï¼Œæµ‹è¯•é›†æœ‰119043æ¡è®°å½•ã€‚æ¨¡å‹å°†ä¼šåœ¨å­¦ä¹ é›†ä¸Šè®­ç»ƒï¼Œç„¶ååœ¨æµ‹è¯•é›†ä¸Šåˆ†æå…¶è¡¨ç°ã€‚</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="boosting.html#cb42-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(data.drop([<span class="st">&#39;id&#39;</span>, <span class="st">&#39;target&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>), </span>
<span id="cb42-2"><a href="boosting.html#cb42-2"></a>                                                    data[<span class="st">&#39;target&#39;</span>], </span>
<span id="cb42-3"><a href="boosting.html#cb42-3"></a>                                                    test_size<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb42-4"><a href="boosting.html#cb42-4"></a>                                                    random_state<span class="op">=</span>random_state</span>
<span id="cb42-5"><a href="boosting.html#cb42-5"></a>                                                   )</span></code></pre></div>
</div>
<div id="å»ºæ¨¡æµç¨‹" class="section level3">
<h3><span class="header-section-number">4.9.4</span> å»ºæ¨¡æµç¨‹</h3>
<table>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th align="center">æ¨¡å‹ç¼–å·</th>
<th>å»ºæ¨¡è¿‡ç¨‹</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>åŸºå‡†æ¨¡å‹ Baseline modeling</td>
<td align="center">ST0</td>
<td>ç”¨é»˜è®¤å‚æ•°è®­ç»ƒæ¨¡å‹ (no cv, no tunning)</td>
</tr>
<tr class="even">
<td>æ·±å…¥å»ºæ¨¡ In-depth modeling</td>
<td align="center">ST1, ST2</td>
<td>åŒ…æ‹¬å‚æ•°è°ƒæ•´(<code>iteration</code>, <code>depth</code>, <code>learning rate</code>)ã€äº¤å‰éªŒè¯ã€å¤–æ ·æœ¬æµ‹è¯•<br><br>æ•´ä½“æ­¥éª¤ä¸ºï¼š<br>1.é€‰æ‹©è‹¥å¹²å¥—å‚æ•° (hyper parameter tuning)<br>2.å¯¹äºæ¯å¥—å‚æ•°ï¼Œåœ¨<code>X_train</code>ä¸Šè¿›è¡Œè®­ç»ƒå’Œäº¤å‰éªŒè¯ï¼Œè®¡ç®—æ¯ä¸€æŠ˜çš„è¡¨ç°<br>(å…ˆç”¨1-4æŠ˜è®­ç»ƒï¼Œè®¡ç®—ç¬¬5æŠ˜çš„cv errorï¼›å†ç”¨ç¬¬1-3å’Œ5æŠ˜è®­ç»ƒï¼Œè®¡ç®—ç¬¬4æŠ˜çš„cv errorï¼›ä¾æ¬¡ç±»æ¨)<br>3.è®¡ç®—æ¯å¥—å‚æ•°çš„å¹³å‡è¡¨ç°(GINIï¼ŒAUCï¼Œaccuracyï¼Œlogit loss function)<br>4.é€‰æ‹©è¡¨ç°æœ€å¥½çš„ä¸€å¥—å‚æ•°åœ¨<code>X_train</code>ä¸Šè®­ç»ƒï¼Œä½œä¸ºæœ€ä¼˜æ¨¡å‹<br>5.åœ¨<code>X_test</code>ä¸Šå¯¹æœ€ä¼˜æ¨¡å‹è¿›è¡Œæµ‹è¯•</td>
</tr>
</tbody>
</table>
</div>
<div id="æ¨¡å‹åº¦é‡giniç³»æ•°" class="section level3">
<h3><span class="header-section-number">4.9.5</span> æ¨¡å‹åº¦é‡â€”â€”Giniç³»æ•°</h3>
<ol style="list-style-type: decimal">
<li>Giniç³»æ•°</li>
</ol>
<p>Giniç³»æ•°æ˜¯åº¦é‡æ¨¡å‹è¡¨ç°çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œå®ƒçš„è®¡ç®—å…¬å¼ä¸ºï¼š</p>
<p><span class="math display">\[Gini_{CAP} = \frac {a_R} {a_P}\]</span></p>
<p>å…¶ä¸­ï¼Œ<span class="math inline">\(a_R\)</span>æ˜¯æŸä¸€æ¨¡å‹CAPæ›²çº¿å’ŒéšæœºçŒœæ¨¡å‹CAPæ›²çº¿é—´çš„é¢ç§¯ï¼Œ<span class="math inline">\(a_P\)</span>æ˜¯å®Œç¾æ¨¡å‹CAPæ›²çº¿å’ŒéšæœºçŒœæ¨¡å‹CAPæ›²çº¿é—´çš„é¢ç§¯ã€‚</p>
<ol start="2" style="list-style-type: decimal">
<li>Giniç³»æ•°æ¡ˆä¾‹</li>
</ol>
<p><a href="https://www.kaggle.com/batzner/gini-coefficient-an-intuitive-explanation">Gini Coefficient - An Intuitive Explanation</a></p>
<p><img src="plots/4/gini.png" width="80%"  style="display: block; margin: auto;" /></p>
<p><span class="math display">\[Gini = \frac {0.189} {0.3} = 0.630\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Giniç³»æ•°ä»£ç </li>
</ol>
<p>åœ¨pythonä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹ä»£ç æ¥å®šä¹‰Giniç³»æ•°ã€‚</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="boosting.html#cb43-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> make_scorer</span>
<span id="cb43-2"><a href="boosting.html#cb43-2"></a></span>
<span id="cb43-3"><a href="boosting.html#cb43-3"></a><span class="co"># Gini coefficient</span></span>
<span id="cb43-4"><a href="boosting.html#cb43-4"></a><span class="kw">def</span> gini(actual, pred):</span>
<span id="cb43-5"><a href="boosting.html#cb43-5"></a>    </span>
<span id="cb43-6"><a href="boosting.html#cb43-6"></a>    <span class="co"># a structural check</span></span>
<span id="cb43-7"><a href="boosting.html#cb43-7"></a>    <span class="cf">assert</span> (<span class="bu">len</span>(actual) <span class="op">==</span> <span class="bu">len</span>(pred))</span>
<span id="cb43-8"><a href="boosting.html#cb43-8"></a>    </span>
<span id="cb43-9"><a href="boosting.html#cb43-9"></a>    <span class="co"># introducing an array called all</span></span>
<span id="cb43-10"><a href="boosting.html#cb43-10"></a>    <span class="bu">all</span> <span class="op">=</span> np.asarray(np.c_[actual, pred, np.arange(<span class="bu">len</span>(actual))], dtype<span class="op">=</span>np.<span class="bu">float</span>)  <span class="co">#slicing along second axis</span></span>
<span id="cb43-11"><a href="boosting.html#cb43-11"></a>    </span>
<span id="cb43-12"><a href="boosting.html#cb43-12"></a>    <span class="co"># sorting the array along predicted probabilities (descending order) and along the index axis all[:, 2] in case of ties</span></span>
<span id="cb43-13"><a href="boosting.html#cb43-13"></a>    <span class="bu">all</span> <span class="op">=</span> <span class="bu">all</span>[np.lexsort((<span class="bu">all</span>[:, <span class="dv">2</span>], <span class="dv">-1</span> <span class="op">*</span> <span class="bu">all</span>[:, <span class="dv">1</span>]))]                             <span class="co">#</span></span>
<span id="cb43-14"><a href="boosting.html#cb43-14"></a></span>
<span id="cb43-15"><a href="boosting.html#cb43-15"></a>    <span class="co"># towards the Gini coefficient</span></span>
<span id="cb43-16"><a href="boosting.html#cb43-16"></a>    totalLosses <span class="op">=</span> <span class="bu">all</span>[:, <span class="dv">0</span>].<span class="bu">sum</span>()</span>
<span id="cb43-17"><a href="boosting.html#cb43-17"></a>    giniSum <span class="op">=</span> <span class="bu">all</span>[:, <span class="dv">0</span>].cumsum().<span class="bu">sum</span>() <span class="op">/</span> totalLosses</span>
<span id="cb43-18"><a href="boosting.html#cb43-18"></a></span>
<span id="cb43-19"><a href="boosting.html#cb43-19"></a>    giniSum <span class="op">-=</span> (<span class="bu">len</span>(actual) <span class="op">+</span> <span class="dv">1</span>) <span class="op">/</span> <span class="fl">2.</span></span>
<span id="cb43-20"><a href="boosting.html#cb43-20"></a>    <span class="cf">return</span> giniSum <span class="op">/</span> <span class="bu">len</span>(actual)</span>
<span id="cb43-21"><a href="boosting.html#cb43-21"></a></span>
<span id="cb43-22"><a href="boosting.html#cb43-22"></a><span class="co"># normalized Gini coefficient</span></span>
<span id="cb43-23"><a href="boosting.html#cb43-23"></a><span class="kw">def</span> gini_normalized_score(actual, pred):</span>
<span id="cb43-24"><a href="boosting.html#cb43-24"></a>    <span class="cf">return</span> gini(actual, pred) <span class="op">/</span> gini(actual, actual)</span>
<span id="cb43-25"><a href="boosting.html#cb43-25"></a></span>
<span id="cb43-26"><a href="boosting.html#cb43-26"></a><span class="co"># score using the normalized Gini</span></span>
<span id="cb43-27"><a href="boosting.html#cb43-27"></a>score_gini <span class="op">=</span> make_scorer(gini_normalized_score, greater_is_better<span class="op">=</span><span class="va">True</span>, needs_threshold <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Giniç³»æ•°ä¸AUC</li>
</ol>
<p>Giniç³»æ•°ä¸AUCä¹‹é—´å­˜åœ¨å¦‚ä¸‹ç­‰å¼å…³ç³»ï¼š</p>
<p><span class="math display">\[Gini = 2 \times AUC - 1\]</span></p>
<p>åœ¨æ­¤ä¾‹ä¸­ï¼ŒGiniç³»æ•°å°†ç”¨äºè®¡ç®—äº¤å‰éªŒè¯ä¸­æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„è¡¨ç°ã€‚</p>
</div>
<div id="å»ºç«‹adaboostæ¨¡å‹" class="section level3">
<h3><span class="header-section-number">4.9.6</span> å»ºç«‹AdaBoostæ¨¡å‹</h3>
<div id="st0" class="section level4">
<h4><span class="header-section-number">4.9.6.1</span> ST0</h4>
<p>é€‰å–treeä½œä¸ºåŸºæ¨¡å‹ï¼Œæ„å»ºSAMMEå’ŒSAMME.Ræ¨¡å‹ã€‚</p>
<p>é»˜è®¤å‚æ•°ï¼š<code>n_estimators = 50</code>ï¼Œ<code>learning_rate = 1</code></p>
<p><img src="plots/4/ada_st0.png" width="80%"  style="display: block; margin: auto;" /></p>
<p>SAMME.Ræ¨¡å‹çš„è¡¨ç°ä¼˜äºSAMMEæ¨¡å‹ã€‚</p>
</div>
<div id="st1" class="section level4">
<h4><span class="header-section-number">4.9.6.2</span> ST1</h4>
<p>æ„å»ºSAMME.Ræ¨¡å‹ï¼Œé€‰å–å‚æ•°<code>n_estimators = 500</code>ï¼Œ<code>learning_rate = 1</code>ï¼Œè§‚å¯Ÿä¸åŒ<code>max_depth</code>ä¸‹å¤–æ ·æœ¬æµ‹è¯•çš„AUCã€‚</p>
<p>å·¦å›¾<code>max_depth = 1</code>ï¼Œå³å›¾<code>max_depth = 3</code>ã€‚</p>
<p><img src="plots/4/ada_st1.png" width="80%"  style="display: block; margin: auto;" /></p>
<p>å½“<code>max_depth = 1</code>æ—¶ï¼Œæµ‹è¯•é›†ä¸Šï¼ŒSAMME.Rçš„æœ€å¤§AUCä¸º<strong>0.639</strong>ï¼Œåœ¨è¿­ä»£267æ¬¡æ—¶å–å¾—ï¼›</p>
<p>å½“<code>max_depth = 3</code>æ—¶ï¼Œæµ‹è¯•é›†ä¸Šï¼ŒSAMME.Rçš„æœ€å¤§AUCä¸º0.624ï¼Œåœ¨è¿­ä»£8æ¬¡æ—¶å–å¾—ï¼Œå‡ºç°äº†è¿‡æ‹Ÿåˆï¼›</p>
<p>å½“<code>max_depth = 5</code>ï¼Œè¿­ä»£æå°‘çš„æ¬¡æ•°å°±å‡ºç°äº†è¿‡æ‹Ÿåˆã€‚</p>
<p>å› æ­¤ï¼Œå½“å¢åŠ æ ‘çš„æœ€å¤§æ·±åº¦æ—¶ï¼Œå®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆï¼Œè¿™æ—¶éœ€è¦é™ä½å­¦ä¹ ç‡ä»¥é¿å…è¿‡æ‹Ÿåˆã€‚</p>
</div>
<div id="st2" class="section level4">
<h4><span class="header-section-number">4.9.6.3</span> ST2</h4>
<p>æ¥ä¸‹æ¥ï¼Œè®¾ç½®ä¸åŒçš„<code>max_depth</code>ã€<code>learning_rate</code>ã€<code>n_estimators</code>ï¼Œæ„å»ºSAMME.Ræ¨¡å‹ï¼Œæœå¯»å¤–æ ·æœ¬æµ‹è¯•ä¸ŠAUCæœ€å¤§çš„æ¨¡å‹ã€‚</p>
<p><img src="plots/4/ada_st2.png" width="80%"  style="display: block; margin: auto;" /></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œæœ€ä½³æ¨¡å‹çš„å‚æ•°æ˜¯<code>max_depth = 1</code>ï¼Œ<code>learning rate = 0.1</code>ï¼Œ<code>n_estimators = 400</code>ï¼Œæ­¤æ—¶AUCä¸º<strong>0.637</strong>ã€‚</p>
</div>
</div>
<div id="å»ºç«‹xgboostæ¨¡å‹" class="section level3">
<h3><span class="header-section-number">4.9.7</span> å»ºç«‹XGBoostæ¨¡å‹</h3>
<div id="st0-1" class="section level4">
<h4><span class="header-section-number">4.9.7.1</span> ST0</h4>
<p>é‡‡ç”¨é»˜è®¤å‚æ•°ï¼š<code>learning rate = 0.1</code>ï¼Œ<code>max_depth = 3</code>ï¼Œ<code>n_estimators = 100</code>ï¼Œæ„å»ºXGBoostæ¨¡å‹ã€‚</p>
<p>å¾—å‡ºout-of-sample AUCä¸º<strong>0.638</strong>ï¼Œè¿™å·²ç»å¥½äºAdaBoostçš„ST0ï¼ˆ0.635ï¼‰å’ŒST2ï¼ˆ0.637ï¼‰ï¼Œç¨å·®äºST1ï¼ˆ0.639ï¼‰ã€‚</p>
</div>
<div id="st1-1" class="section level4">
<h4><span class="header-section-number">4.9.7.2</span> ST1</h4>
<p>è®¾ç½®ä¸åŒçš„<code>max_depth</code>ã€<code>learning_rate</code>ã€<code>n_estimators</code>ï¼Œæ„å»ºXGBoostæ¨¡å‹ï¼Œæœå¯»å¤–æ ·æœ¬æµ‹è¯•ä¸ŠAUCæœ€å¤§çš„æ¨¡å‹ã€‚</p>
<p><img src="plots/4/xg_st1.png" width="60%"  style="display: block; margin: auto;" /></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>max_depth = 2</code>ï¼Œ<code>learning_rate = 0.1</code>ï¼Œ<code>n_estimators = 500</code>å’Œ<code>max_depth = 3</code>ï¼Œ<code>learning_rate = 0.1</code>ï¼Œ<code>n_estimators =  300</code>ï¼ŒAUCéƒ½å–åˆ°äº†æœ€å¤§ä¸º<strong>0.643</strong>ã€‚</p>
<p>ç‰¹å¾é‡è¦æ€§æ’åºå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="plots/4/feature_impo.png" width="80%"  style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ç»“è®º" class="section level3">
<h3><span class="header-section-number">4.9.8</span> ç»“è®º</h3>
<p>æ€»çš„æ¥è¯´ï¼Œåœ¨æ­¤æ•°æ®é›†ä¸Š:</p>
<p>SAMME.Rä¼˜äºSAMMEï¼ŒSAMME.Råœ¨å•å±‚æ ‘ã€é€‚åº¦çš„å­¦ä¹ ç‡å’Œè¾ƒå¤§çš„è¿­ä»£æ¬¡æ•°ä¸Šè¡¨ç°è¾ƒå¥½ï¼›</p>
<p>XGBoostä¼˜äºAdaBoostï¼ŒXGBooståœ¨è¾ƒæµ…çš„æ ‘ã€é€‚åº¦çš„å­¦ä¹ ç‡å’Œè¾ƒå¤§çš„è¿­ä»£æ¬¡æ•°ä¸Šè¡¨ç°è¾ƒå¥½ã€‚</p>
</div>
</div>
<div id="appendix-commonly-used-python-code-for-py-beginners" class="section level2">
<h2><span class="header-section-number">4.10</span> Appendix: Commonly used Python code (for py-beginners)</h2>
<div id="pythonæ ‡å‡†æ•°æ®ç±»å‹" class="section level3">
<h3><span class="header-section-number">4.10.1</span> Pythonæ ‡å‡†æ•°æ®ç±»å‹</h3>
<ul>
<li><p>Numbersï¼ˆæ•°å­—ï¼‰ï¼šç”¨äºå­˜å‚¨æ•°å€¼ï¼ŒåŒ…æ‹¬intï¼Œlongï¼Œfloatå’Œcomplexã€‚</p></li>
<li><p>Stringï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼šç”±æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿ç»„æˆçš„ä¸€ä¸²å­—ç¬¦ã€‚</p></li>
<li><p>Listï¼ˆåˆ—è¡¨ï¼‰ï¼šPythonä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å®Œæˆå¤§å¤šæ•°é›†åˆç±»çš„æ•°æ®ç»“æ„å®ç°ï¼Œå®ƒæ”¯æŒæ•°å­—ã€å­—ç¬¦ä¸²ç”šè‡³å¯ä»¥åŒ…å«åˆ—è¡¨ï¼ˆå³åµŒå¥—ï¼‰ã€‚</p></li>
<li><p>Tupleï¼ˆå…ƒç»„ï¼‰ï¼šå…ƒç»„ä¸èƒ½äºŒæ¬¡èµ‹å€¼ï¼Œç›¸å½“äºâ€œåªè¯»â€åˆ—è¡¨ã€‚</p></li>
<li><p>Dictionaryï¼ˆå­—å…¸ï¼‰ï¼šé™¤åˆ—è¡¨ä»¥å¤–pythonä¹‹ä¸­æœ€çµæ´»çš„å†…ç½®æ•°æ®ç»“æ„ç±»å‹ï¼Œä¸åˆ—è¡¨çš„åŒºåˆ«åœ¨äºâ€”â€”åˆ—è¡¨æ˜¯æœ‰åºçš„å¯¹è±¡é›†åˆï¼Œå­—å…¸æ˜¯æ— åºçš„å¯¹è±¡é›†åˆï¼Œå­—å…¸å½“ä¸­çš„å…ƒç´ æ˜¯é€šè¿‡é”®æ¥å­˜å–çš„ã€‚</p></li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="boosting.html#cb44-1"></a>n <span class="op">=</span> <span class="fl">3.6</span>  <span class="co"># æ•°å­—</span></span>
<span id="cb44-2"><a href="boosting.html#cb44-2"></a>s <span class="op">=</span> <span class="st">&#39;Hello, python!&#39;</span>  <span class="co"># å­—ç¬¦ä¸²</span></span>
<span id="cb44-3"><a href="boosting.html#cb44-3"></a>L <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&#39;a&#39;</span>]  <span class="co"># åˆ—è¡¨</span></span>
<span id="cb44-4"><a href="boosting.html#cb44-4"></a>t <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&#39;a&#39;</span>)  <span class="co"># å…ƒç»„</span></span>
<span id="cb44-5"><a href="boosting.html#cb44-5"></a>d <span class="op">=</span> {<span class="st">&#39;a&#39;</span>:<span class="dv">1</span>, <span class="st">&#39;b&#39;</span>:<span class="dv">2</span>}  <span class="co"># å­—å…¸</span></span>
<span id="cb44-6"><a href="boosting.html#cb44-6"></a><span class="bu">print</span>(n, s, L, t, d, sep <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span></code></pre></div>
</div>
<div id="pythonå†…ç½®å‡½æ•°" class="section level3">
<h3><span class="header-section-number">4.10.2</span> Pythonå†…ç½®å‡½æ•°</h3>
<ol style="list-style-type: decimal">
<li>è¾“å…¥è¾“å‡º</li>
</ol>
<ul>
<li><p><code>print()</code>å°†å¯¹è±¡è¾“å‡ºè‡³æ§åˆ¶å°</p></li>
<li><p><code>open()</code>æ‰“å¼€æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å¯¹è±¡</p></li>
<li><p><code>input()</code>è·å–æ§åˆ¶å°è¾“å…¥</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>è¿­ä»£ç›¸å…³</li>
</ol>
<ul>
<li><p><code>enumerate()</code>è¿”å›å…ƒç´ çš„åºå·ä¸å¯¹åº”å€¼</p></li>
<li><p><code>zip()</code>å°†å¤šä¸ªåºåˆ—ä¸­çš„å…ƒç´ é…å¯¹ï¼Œäº§ç”Ÿæ–°çš„å…ƒç»„åˆ—è¡¨</p></li>
<li><p><code>all()</code>å¦‚æœç»™å®šçš„å¯è¿­ä»£å‚æ•°ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºTrueåˆ™è¿”å›Trueï¼Œå¦åˆ™è¿”å›False</p></li>
<li><p><code>any()</code>å¦‚æœç»™å®šçš„å¯è¿­ä»£å‚æ•°ä¸­çš„ä»»ä¸€å…ƒç´ ä¸ºTrueåˆ™è¿”å›Trueï¼Œå¦åˆ™è¿”å›False</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>åºåˆ—å±æ€§</li>
</ol>
<ul>
<li><p><code>max()</code>åºåˆ—æœ€å¤§å€¼</p></li>
<li><p><code>min()</code>åºåˆ—æœ€å°å€¼</p></li>
<li><p><code>sum()</code>åºåˆ—çš„å’Œ</p></li>
<li><p><code>len()</code>åºåˆ—é•¿åº¦</p></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>åºåˆ—æ“ä½œ</li>
</ol>
<ul>
<li><p><code>range()</code>ç”Ÿæˆåºåˆ—</p></li>
<li><p><code>reversed()</code>å°†åºåˆ—é€†ç½®</p></li>
<li><p><code>sorted()</code>å¯¹åºåˆ—è¿›è¡Œæ’åº</p></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>å¯¹è±¡å±æ€§</li>
</ol>
<ul>
<li><p><code>dir()</code>è¿”å›å±æ€§åˆ—è¡¨</p></li>
<li><p><code>id()</code>è¿”å›å¯¹è±¡åœ°å€</p></li>
<li><p><code>isinstance()</code>åˆ¤æ–­å¯¹è±¡çš„ç±»å‹</p></li>
<li><p><code>type</code>è¿”å›å¯¹è±¡çš„ç±»å‹</p></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>æ˜ å°„ç±»å‹</li>
</ol>
<ul>
<li><p><code>eval()</code>å»é™¤å­—ç¬¦ä¸²çš„å•å¼•å·ï¼Œä»è€Œè·å–å¼•å·å†…éƒ¨å†…å®¹</p></li>
<li><p><code>map()</code>å°†ä¼ è¿›æ¥çš„å‡½æ•°åº”ç”¨äºåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¿­ä»£å™¨</p></li>
<li><p><code>slice()</code>ç”Ÿæˆåˆ‡ç‰‡</p></li>
</ul>
</div>
<div id="numpyåŒ…" class="section level3">
<h3><span class="header-section-number">4.10.3</span> numpyåŒ…</h3>
<p>NumPy(Numerical Python)æ˜¯Pythonçš„ä¸€ä¸ªæ‰©å±•ç¨‹åºåº“ï¼Œæ”¯æŒå¤§é‡çš„ç»´åº¦æ•°ç»„ä¸çŸ©é˜µè¿ç®—ï¼Œå®ƒä¹Ÿé’ˆå¯¹æ•°ç»„è¿ç®—æä¾›å¤§é‡çš„æ•°å­¦å‡½æ•°åº“ã€‚</p>
<ol style="list-style-type: decimal">
<li>åˆ›å»ºndarrayæ•°ç»„</li>
</ol>
<p>ndarrayæ˜¯ä¸€ç§å¤šç»´æ•°ç»„å¯¹è±¡ï¼Œå…¶ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„ã€‚</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="boosting.html#cb45-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb45-2"><a href="boosting.html#cb45-2"></a>a1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])  <span class="co"># åˆ›å»ºæ•°ç»„</span></span>
<span id="cb45-3"><a href="boosting.html#cb45-3"></a><span class="bu">print</span>(a1)</span>
<span id="cb45-4"><a href="boosting.html#cb45-4"></a><span class="bu">print</span>(a1.ndim)  <span class="co"># æ•°ç»„çš„ç»´åº¦</span></span>
<span id="cb45-5"><a href="boosting.html#cb45-5"></a><span class="bu">print</span>(a1.shape)  <span class="co"># æ•°ç»„çš„å½¢çŠ¶</span></span>
<span id="cb45-6"><a href="boosting.html#cb45-6"></a><span class="bu">print</span>(a1.dtype)  <span class="co"># æ•°ç»„çš„å…ƒç´ ç±»å‹</span></span>
<span id="cb45-7"><a href="boosting.html#cb45-7"></a><span class="bu">print</span>(a1.itemsize)  <span class="co"># æ¯ä¸ªå…ƒç´ çš„å­—èŠ‚å•ä½é•¿åº¦</span></span>
<span id="cb45-8"><a href="boosting.html#cb45-8"></a></span>
<span id="cb45-9"><a href="boosting.html#cb45-9"></a><span class="co"># å…¶ä»–åˆ›å»ºæ•°ç»„çš„æ–¹æ³•</span></span>
<span id="cb45-10"><a href="boosting.html#cb45-10"></a>a2 <span class="op">=</span> np.zeros(shape <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>), dtype <span class="op">=</span> <span class="bu">float</span>)  <span class="co"># åˆ›å»ºå…ƒç´ å…¨æ˜¯0çš„æ•°ç»„</span></span>
<span id="cb45-11"><a href="boosting.html#cb45-11"></a>a3 <span class="op">=</span> np.ones(shape <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>), dtype <span class="op">=</span> <span class="bu">int</span>)  <span class="co"># åˆ›å»ºå…ƒç´ å…¨æ˜¯1çš„æ•°ç»„</span></span>
<span id="cb45-12"><a href="boosting.html#cb45-12"></a>a4 <span class="op">=</span> np.arange(start <span class="op">=</span> <span class="dv">10</span>, stop <span class="op">=</span> <span class="dv">20</span>, step <span class="op">=</span> <span class="dv">2</span>)  <span class="co"># åˆ›å»ºæŒ‡å®šæ•°æ®èŒƒå›´çš„æ•°ç»„</span></span>
<span id="cb45-13"><a href="boosting.html#cb45-13"></a><span class="bu">print</span>(a1, a2, a3, a4, sep <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>ndarrayå¯¹è±¡çš„åˆ‡ç‰‡å’Œç´¢å¼•</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="boosting.html#cb46-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb46-2"><a href="boosting.html#cb46-2"></a>a <span class="op">=</span> np.arange(<span class="dv">24</span>).reshape((<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))  <span class="co"># åˆ›å»º2ç»´ã€3è¡Œã€4åˆ—çš„æ•°ç»„ï¼Œå…ƒç´ ä»0-23å¡«å……</span></span>
<span id="cb46-3"><a href="boosting.html#cb46-3"></a><span class="bu">print</span>(a[<span class="dv">0</span>, <span class="dv">0</span>:<span class="dv">2</span>, <span class="dv">1</span>:<span class="dv">3</span>])  <span class="co"># ç´¢å¼•ç¬¬1ä¸ªæ•°ç»„ç¬¬1-2è¡Œç¬¬2-3åˆ—</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="boosting.html#cb47-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb47-2"><a href="boosting.html#cb47-2"></a>arr <span class="op">=</span> np.arange(<span class="dv">10</span>)  <span class="co"># åˆ›å»ºå…ƒç´ ä¸º0-9çš„ä¸€ç»´æ•°ç»„</span></span>
<span id="cb47-3"><a href="boosting.html#cb47-3"></a>arr_s <span class="op">=</span> arr[<span class="dv">3</span>:<span class="dv">5</span>]  <span class="co"># åˆ‡ç‰‡ï¼Œæå‡ºæ•°ç»„çš„ç¬¬4ã€5ä¸ªå…ƒç´ </span></span>
<span id="cb47-4"><a href="boosting.html#cb47-4"></a>arr_s[:] <span class="op">=</span> <span class="dv">99</span>  <span class="co"># å°†99èµ‹å€¼ç»™åˆ‡ç‰‡arr_sä¸­çš„æ‰€æœ‰å…ƒç´ </span></span>
<span id="cb47-5"><a href="boosting.html#cb47-5"></a><span class="bu">print</span>(arr_s, arr, sep <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)  <span class="co"># ä¿®æ”¹ä¼šç›´æ¥åæ˜ åˆ°æºæ•°ç»„ä¸Š</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>æ•°å­¦è¿ç®—</li>
</ol>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="boosting.html#cb48-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-2"><a href="boosting.html#cb48-2"></a>a <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">5.55</span>, <span class="dv">123</span>, <span class="fl">0.567</span>, <span class="fl">25.532</span>])  </span>
<span id="cb48-3"><a href="boosting.html#cb48-3"></a>b <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb48-4"><a href="boosting.html#cb48-4"></a></span>
<span id="cb48-5"><a href="boosting.html#cb48-5"></a><span class="bu">print</span>(np.around(a, decimals <span class="op">=</span> <span class="dv">1</span>))  <span class="co"># å››èˆäº”å…¥è‡³1ä½å°æ•°</span></span>
<span id="cb48-6"><a href="boosting.html#cb48-6"></a><span class="bu">print</span>(np.floor(a))  <span class="co"># å‘ä¸‹å–æ•´</span></span>
<span id="cb48-7"><a href="boosting.html#cb48-7"></a><span class="bu">print</span>(np.ceil(a))  <span class="co"># å‘ä¸Šå–æ•´</span></span>
<span id="cb48-8"><a href="boosting.html#cb48-8"></a></span>
<span id="cb48-9"><a href="boosting.html#cb48-9"></a><span class="bu">print</span>(np.sqrt(a))  <span class="co"># å¼€æ ¹å·</span></span>
<span id="cb48-10"><a href="boosting.html#cb48-10"></a><span class="bu">print</span>(np.square(a))  <span class="co"># å¹³æ–¹</span></span>
<span id="cb48-11"><a href="boosting.html#cb48-11"></a><span class="bu">print</span>(np.log(a))  <span class="co"># å–å¯¹æ•°</span></span>
<span id="cb48-12"><a href="boosting.html#cb48-12"></a><span class="bu">print</span>(np.exp(a))  <span class="co"># å–æŒ‡æ•°</span></span>
<span id="cb48-13"><a href="boosting.html#cb48-13"></a><span class="bu">print</span>(np.sign(a))  <span class="co"># å–ç¬¦å·å‡½æ•°</span></span>
<span id="cb48-14"><a href="boosting.html#cb48-14"></a></span>
<span id="cb48-15"><a href="boosting.html#cb48-15"></a><span class="bu">print</span>(np.add(a, b))  <span class="co"># ä¸¤ä¸ªæ•°ç»„ç›¸åŠ </span></span>
<span id="cb48-16"><a href="boosting.html#cb48-16"></a><span class="bu">print</span>(np.subtract(a, b))  <span class="co"># ä¸¤ä¸ªæ•°ç»„ç›¸å‡</span></span>
<span id="cb48-17"><a href="boosting.html#cb48-17"></a><span class="bu">print</span>(np.multiply(a, b))  <span class="co"># ä¸¤ä¸ªæ•°ç»„ç›¸ä¹˜</span></span>
<span id="cb48-18"><a href="boosting.html#cb48-18"></a><span class="bu">print</span>(np.divide(a, b))  <span class="co"># ä¸¤ä¸ªæ•°ç»„ç›¸é™¤</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>ç»Ÿè®¡è¿ç®—</li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="boosting.html#cb49-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb49-2"><a href="boosting.html#cb49-2"></a>a <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">5</span>], [<span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">3</span>], [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>]])  </span>
<span id="cb49-3"><a href="boosting.html#cb49-3"></a></span>
<span id="cb49-4"><a href="boosting.html#cb49-4"></a><span class="bu">print</span>(np.<span class="bu">min</span>(a, axis <span class="op">=</span> <span class="dv">0</span>))  <span class="co"># æ²¿çºµè½´çš„æœ€å°å€¼</span></span>
<span id="cb49-5"><a href="boosting.html#cb49-5"></a><span class="bu">print</span>(np.<span class="bu">max</span>(a, axis <span class="op">=</span> <span class="dv">1</span>))  <span class="co"># æ²¿æ¨ªè½´çš„æœ€å¤§å€¼        # ä»¥ä¸‹å‡½æ•°å‡å¯ä»¥é€šè¿‡å‚æ•°axisé€‰æ‹©çºµè½´ï¼ˆaxis=0ï¼‰æˆ–æ¨ªè½´ï¼ˆaxis=1ï¼‰</span></span>
<span id="cb49-6"><a href="boosting.html#cb49-6"></a><span class="bu">print</span>(np.ptp(a))  <span class="co"># æ•°ç»„ä¸­å…ƒç´ æœ€å¤§å€¼ä¸æœ€å°å€¼çš„å·®</span></span>
<span id="cb49-7"><a href="boosting.html#cb49-7"></a><span class="bu">print</span>(np.percentile(a, q <span class="op">=</span> <span class="dv">70</span>, axis <span class="op">=</span> <span class="dv">0</span>))  <span class="co"># ç™¾åˆ†ä½æ•°</span></span>
<span id="cb49-8"><a href="boosting.html#cb49-8"></a><span class="bu">print</span>(np.<span class="bu">sum</span>(a))  <span class="co"># æ±‚å’Œ</span></span>
<span id="cb49-9"><a href="boosting.html#cb49-9"></a><span class="bu">print</span>(np.median(a))  <span class="co"># ä¸­ä½æ•°</span></span>
<span id="cb49-10"><a href="boosting.html#cb49-10"></a><span class="bu">print</span>(np.mean(a))  <span class="co"># å‡å€¼</span></span>
<span id="cb49-11"><a href="boosting.html#cb49-11"></a><span class="bu">print</span>(np.average(a, axis <span class="op">=</span> <span class="dv">0</span>, weights <span class="op">=</span> [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>], returned <span class="op">=</span> <span class="va">True</span>))  <span class="co"># åŠ æƒå¹³å‡æ•°</span></span>
<span id="cb49-12"><a href="boosting.html#cb49-12"></a><span class="bu">print</span>(np.std(a))  <span class="co"># æ ‡å‡†å·®</span></span>
<span id="cb49-13"><a href="boosting.html#cb49-13"></a><span class="bu">print</span>(np.var(a))  <span class="co"># æ–¹å·®</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>æ’åº</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="boosting.html#cb50-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb50-2"><a href="boosting.html#cb50-2"></a>a <span class="op">=</span> np.array([(<span class="st">&quot;raju&quot;</span>,<span class="dv">21</span>), (<span class="st">&quot;anil&quot;</span>,<span class="dv">25</span>), (<span class="st">&quot;ravi&quot;</span>,<span class="dv">17</span>), (<span class="st">&quot;amar&quot;</span>,<span class="dv">27</span>)], dtype <span class="op">=</span> np.dtype([(<span class="st">&#39;name&#39;</span>,<span class="st">&#39;S10&#39;</span>), (<span class="st">&#39;age&#39;</span>,<span class="bu">int</span>)]))</span>
<span id="cb50-3"><a href="boosting.html#cb50-3"></a></span>
<span id="cb50-4"><a href="boosting.html#cb50-4"></a><span class="bu">print</span>(a)</span>
<span id="cb50-5"><a href="boosting.html#cb50-5"></a><span class="bu">print</span>(np.sort(a, order <span class="op">=</span> <span class="st">&#39;age&#39;</span>))  <span class="co"># ä»å°åˆ°å¤§æ’åº</span></span>
<span id="cb50-6"><a href="boosting.html#cb50-6"></a><span class="bu">print</span>(np.argsort(a, order <span class="op">=</span> <span class="st">&#39;age&#39;</span>))  <span class="co"># ä»å°åˆ°å¤§æ’åºçš„ç´¢å¼•</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>çº¿æ€§ä»£æ•°</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="boosting.html#cb51-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb51-2"><a href="boosting.html#cb51-2"></a>a <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb51-3"><a href="boosting.html#cb51-3"></a>b <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb51-4"><a href="boosting.html#cb51-4"></a>c <span class="op">=</span> a.copy()  <span class="co"># å¤åˆ¶</span></span>
<span id="cb51-5"><a href="boosting.html#cb51-5"></a></span>
<span id="cb51-6"><a href="boosting.html#cb51-6"></a><span class="bu">print</span>(a)</span>
<span id="cb51-7"><a href="boosting.html#cb51-7"></a><span class="bu">print</span>(a.T)  <span class="co"># è½¬ç½®</span></span>
<span id="cb51-8"><a href="boosting.html#cb51-8"></a><span class="bu">print</span>(np.dot(a,b))  <span class="co"># æ•°ç»„ç‚¹ç§¯</span></span>
<span id="cb51-9"><a href="boosting.html#cb51-9"></a><span class="bu">print</span>(np.vdot(a,b))  <span class="co"># å‘é‡ç‚¹ç§¯, å¤šç»´æ•°ç»„ä¼šè¢«å±•å¼€</span></span>
<span id="cb51-10"><a href="boosting.html#cb51-10"></a><span class="bu">print</span>(np.inner(a,c))  <span class="co"># å‘é‡å†…ç§¯ï¼Œå¯¹äºæ›´é«˜çš„ç»´åº¦ï¼Œå®ƒè¿”å›æœ€åä¸€ä¸ªè½´ä¸Šçš„å’Œçš„ä¹˜ç§¯</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="boosting.html#cb52-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb52-2"><a href="boosting.html#cb52-2"></a>a <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb52-3"><a href="boosting.html#cb52-3"></a><span class="bu">print</span>(a)</span>
<span id="cb52-4"><a href="boosting.html#cb52-4"></a><span class="bu">print</span>(np.diag(a))  <span class="co"># å¯¹è§’é˜µ</span></span>
<span id="cb52-5"><a href="boosting.html#cb52-5"></a><span class="bu">print</span>(np.linalg.inv(a))  <span class="co"># é€†</span></span>
<span id="cb52-6"><a href="boosting.html#cb52-6"></a><span class="bu">print</span>(np.linalg.det(a))  <span class="co"># è¡Œåˆ—å¼</span></span>
<span id="cb52-7"><a href="boosting.html#cb52-7"></a><span class="bu">print</span>(np.linalg.eig(a))  <span class="co"># ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡</span></span>
<span id="cb52-8"><a href="boosting.html#cb52-8"></a><span class="bu">print</span>(np.linalg.svd(a))  <span class="co"># å¥‡å¼‚å€¼åˆ†è§£</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>éšæœºæ•°</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="boosting.html#cb53-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-2"><a href="boosting.html#cb53-2"></a>np.random.seed(<span class="dv">123</span>)  <span class="co"># éšæœºæ•°ç§å­</span></span>
<span id="cb53-3"><a href="boosting.html#cb53-3"></a></span>
<span id="cb53-4"><a href="boosting.html#cb53-4"></a><span class="bu">print</span>(np.random.rand(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># å‡åŒ€åˆ†å¸ƒ</span></span>
<span id="cb53-5"><a href="boosting.html#cb53-5"></a><span class="bu">print</span>(np.random.randn(<span class="dv">2</span>, <span class="dv">3</span>)) <span class="co"># æ ‡å‡†æ­£æ€åˆ†å¸ƒ</span></span>
<span id="cb53-6"><a href="boosting.html#cb53-6"></a><span class="bu">print</span>(np.random.randint(low <span class="op">=</span> <span class="dv">0</span>, high <span class="op">=</span> <span class="dv">100</span>, size <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">2</span>)))  <span class="co"># éšæœºæ•´æ•°</span></span>
<span id="cb53-7"><a href="boosting.html#cb53-7"></a></span>
<span id="cb53-8"><a href="boosting.html#cb53-8"></a><span class="co"># åˆ†å¸ƒ</span></span>
<span id="cb53-9"><a href="boosting.html#cb53-9"></a><span class="bu">print</span>(np.random.normal(loc <span class="op">=</span> <span class="dv">3</span>, scale <span class="op">=</span> <span class="dv">9</span>, size <span class="op">=</span> <span class="dv">2</span>))  <span class="co"># æ­£æ€</span></span>
<span id="cb53-10"><a href="boosting.html#cb53-10"></a><span class="bu">print</span>(np.random.poisson(lam <span class="op">=</span> <span class="dv">10</span>, size <span class="op">=</span> <span class="dv">6</span>))  <span class="co"># æ³Šæ¾</span></span>
<span id="cb53-11"><a href="boosting.html#cb53-11"></a><span class="bu">print</span>(np.random.binomial(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.1</span>, size <span class="op">=</span> (<span class="dv">2</span>, <span class="dv">2</span>)))  <span class="co"># äºŒé¡¹</span></span>
<span id="cb53-12"><a href="boosting.html#cb53-12"></a><span class="bu">print</span>(np.random.negative_binomial(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.1</span>, size <span class="op">=</span> <span class="dv">1</span>))  <span class="co"># è´ŸäºŒé¡¹</span></span>
<span id="cb53-13"><a href="boosting.html#cb53-13"></a><span class="bu">print</span>(np.random.gamma(shape <span class="op">=</span> <span class="dv">3</span>, scale <span class="op">=</span> <span class="dv">2</span>, size <span class="op">=</span> <span class="dv">10</span>))  <span class="co"># ä¼½é©¬</span></span></code></pre></div>
</div>
<div id="pandasåŒ…" class="section level3">
<h3><span class="header-section-number">4.10.4</span> pandasåŒ…</h3>
<p>pandasæ˜¯åŸºäºNumPyçš„ä¸€ä¸ªä¸ºè§£å†³æ•°æ®åˆ†æä»»åŠ¡è€Œåˆ›å»ºçš„åŒ…ï¼Œæä¾›äº†å¤§é‡èƒ½ä½¿æˆ‘ä»¬å¿«é€Ÿä¾¿æ·åœ°å¤„ç†æ•°æ®çš„å‡½æ•°å’Œæ–¹æ³•ã€‚</p>
<ol style="list-style-type: decimal">
<li>åˆ›å»ºDataFrame</li>
</ol>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="boosting.html#cb54-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb54-2"><a href="boosting.html#cb54-2"></a></span>
<span id="cb54-3"><a href="boosting.html#cb54-3"></a>data1 <span class="op">=</span> pd.read_csv(<span class="st">&#39;file.csv&#39;</span>, encoding <span class="op">=</span> <span class="st">&#39;gbk&#39;</span>)  <span class="co"># ä»å¤–éƒ¨è¯»å…¥csvæ–‡ä»¶</span></span>
<span id="cb54-4"><a href="boosting.html#cb54-4"></a></span>
<span id="cb54-5"><a href="boosting.html#cb54-5"></a>data2 <span class="op">=</span> {<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Nevada&#39;</span>, <span class="st">&#39;Nevada&#39;</span>],  <span class="co"># å…ˆåˆ›å»ºå­—å…¸</span></span>
<span id="cb54-6"><a href="boosting.html#cb54-6"></a>        <span class="st">&#39;year&#39;</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2001</span>, <span class="dv">2002</span>],</span>
<span id="cb54-7"><a href="boosting.html#cb54-7"></a>        <span class="st">&#39;pop&#39;</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">3.6</span>, <span class="fl">2.4</span>, <span class="fl">2.9</span>]}</span>
<span id="cb54-8"><a href="boosting.html#cb54-8"></a>data2 <span class="op">=</span> pd.DataFrame(data2, columns <span class="op">=</span> [<span class="st">&#39;year&#39;</span>, <span class="st">&#39;state&#39;</span>, <span class="st">&#39;pop&#39;</span>])  <span class="co"># åŸºäºå­—å…¸åˆ›å»ºDataFrame</span></span>
<span id="cb54-9"><a href="boosting.html#cb54-9"></a>data2[<span class="st">&#39;debt&#39;</span>] <span class="op">=</span> <span class="fl">16.5</span>  <span class="co"># æ–°å¢ä¸€åˆ—debt</span></span>
<span id="cb54-10"><a href="boosting.html#cb54-10"></a></span>
<span id="cb54-11"><a href="boosting.html#cb54-11"></a><span class="bu">print</span>(data1, data2, sep <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb54-12"><a href="boosting.html#cb54-12"></a></span>
<span id="cb54-13"><a href="boosting.html#cb54-13"></a><span class="bu">print</span>(data2.dtypes)  <span class="co"># å…ƒç´ ç±»å‹</span></span>
<span id="cb54-14"><a href="boosting.html#cb54-14"></a><span class="bu">print</span>(data2.columns)  <span class="co"># åˆ—å</span></span>
<span id="cb54-15"><a href="boosting.html#cb54-15"></a><span class="bu">print</span>(data2.shape)  <span class="co"># å½¢çŠ¶</span></span>
<span id="cb54-16"><a href="boosting.html#cb54-16"></a><span class="bu">print</span>(data2.head(<span class="dv">10</span>))  <span class="co"># çœ‹å‰10æ¡è®°å½•</span></span>
<span id="cb54-17"><a href="boosting.html#cb54-17"></a><span class="bu">print</span>(data2.tail(<span class="dv">5</span>))  <span class="co"># çœ‹å5æ¡è®°å½•</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>ç´¢å¼•</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="boosting.html#cb55-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb55-2"><a href="boosting.html#cb55-2"></a>data <span class="op">=</span> {<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Nevada&#39;</span>, <span class="st">&#39;Nevada&#39;</span>],</span>
<span id="cb55-3"><a href="boosting.html#cb55-3"></a>        <span class="st">&#39;year&#39;</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2001</span>, <span class="dv">2002</span>],</span>
<span id="cb55-4"><a href="boosting.html#cb55-4"></a>        <span class="st">&#39;pop&#39;</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">3.6</span>, <span class="fl">2.4</span>, <span class="fl">2.9</span>]}</span>
<span id="cb55-5"><a href="boosting.html#cb55-5"></a>data <span class="op">=</span> pd.DataFrame(data, columns <span class="op">=</span> [<span class="st">&#39;year&#39;</span>, <span class="st">&#39;state&#39;</span>, <span class="st">&#39;pop&#39;</span>])</span>
<span id="cb55-6"><a href="boosting.html#cb55-6"></a>data[<span class="st">&#39;debt&#39;</span>] <span class="op">=</span> <span class="fl">16.5</span></span>
<span id="cb55-7"><a href="boosting.html#cb55-7"></a></span>
<span id="cb55-8"><a href="boosting.html#cb55-8"></a><span class="bu">print</span>(data)</span>
<span id="cb55-9"><a href="boosting.html#cb55-9"></a><span class="bu">print</span>(data[<span class="dv">0</span>:<span class="dv">2</span>])  <span class="co"># ç´¢å¼•ç¬¬1-2è¡Œ</span></span>
<span id="cb55-10"><a href="boosting.html#cb55-10"></a><span class="bu">print</span>(data.iloc[<span class="dv">0</span>:<span class="dv">2</span>])  <span class="co"># ç´¢å¼•ç¬¬1-2è¡Œ</span></span>
<span id="cb55-11"><a href="boosting.html#cb55-11"></a><span class="bu">print</span>(data.loc[<span class="dv">0</span>:<span class="dv">2</span>])  <span class="co"># ç´¢å¼•indexä¸º0-2çš„è¡Œ</span></span>
<span id="cb55-12"><a href="boosting.html#cb55-12"></a><span class="bu">print</span>(data[<span class="st">&#39;year&#39;</span>])  <span class="co"># ç´¢å¼•åä¸ºyearçš„åˆ—</span></span>
<span id="cb55-13"><a href="boosting.html#cb55-13"></a><span class="bu">print</span>(data.loc[<span class="dv">0</span>,<span class="st">&#39;year&#39;</span>])</span>
<span id="cb55-14"><a href="boosting.html#cb55-14"></a><span class="bu">print</span>(data.iloc[<span class="dv">0</span>:<span class="dv">2</span>, <span class="dv">0</span>:<span class="dv">2</span>])  <span class="co"># ç´¢å¼•ç¬¬1-2è¡Œã€ç¬¬1-2åˆ—</span></span>
<span id="cb55-15"><a href="boosting.html#cb55-15"></a></span>
<span id="cb55-16"><a href="boosting.html#cb55-16"></a><span class="bu">print</span>(data[data[<span class="st">&#39;pop&#39;</span>]<span class="op">&gt;</span><span class="dv">2</span>])  <span class="co"># ç´¢å¼•pop&gt;2çš„è¡Œ</span></span>
<span id="cb55-17"><a href="boosting.html#cb55-17"></a><span class="bu">print</span>(data[(data[<span class="st">&#39;pop&#39;</span>]<span class="op">&gt;</span><span class="dv">2</span>) <span class="op">&amp;</span> (data[<span class="st">&#39;state&#39;</span>] <span class="op">==</span> <span class="st">&#39;Ohio&#39;</span>)])  <span class="co"># ç´¢å¼•pop&gt;2ä¸”stateæ˜¯Ohioçš„è¡Œ</span></span>
<span id="cb55-18"><a href="boosting.html#cb55-18"></a><span class="bu">print</span>(data[(data[<span class="st">&#39;pop&#39;</span>]<span class="op">&gt;</span><span class="dv">2</span>) <span class="op">&amp;</span> (data[<span class="st">&#39;state&#39;</span>] <span class="op">==</span> <span class="st">&#39;Ohio&#39;</span>)][[<span class="st">&#39;year&#39;</span>, <span class="st">&#39;debt&#39;</span>]])  <span class="co"># ç´¢å¼•pop&gt;2ä¸”stateæ˜¯Ohioçš„è¡Œã€åä¸ºyearå’Œdebtçš„åˆ—</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>æ•°æ®é¢„å¤„ç†</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="boosting.html#cb56-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb56-2"><a href="boosting.html#cb56-2"></a>data <span class="op">=</span> {<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Nevada&#39;</span>, <span class="st">&#39;Nevada&#39;</span>],</span>
<span id="cb56-3"><a href="boosting.html#cb56-3"></a>        <span class="st">&#39;year&#39;</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2001</span>, <span class="dv">2001</span>, <span class="dv">2002</span>],</span>
<span id="cb56-4"><a href="boosting.html#cb56-4"></a>        <span class="st">&#39;pop&#39;</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">1.7</span>, <span class="fl">2.4</span>, <span class="va">None</span>]}</span>
<span id="cb56-5"><a href="boosting.html#cb56-5"></a>data <span class="op">=</span> pd.DataFrame(data, columns <span class="op">=</span> [<span class="st">&#39;year&#39;</span>, <span class="st">&#39;state&#39;</span>, <span class="st">&#39;pop&#39;</span>])</span>
<span id="cb56-6"><a href="boosting.html#cb56-6"></a>data[<span class="st">&#39;debt&#39;</span>] <span class="op">=</span> <span class="fl">16.5</span></span>
<span id="cb56-7"><a href="boosting.html#cb56-7"></a><span class="bu">print</span>(data)</span>
<span id="cb56-8"><a href="boosting.html#cb56-8"></a><span class="bu">print</span>(data.drop_duplicates())  <span class="co"># åˆ é™¤é‡å¤è¡Œ</span></span>
<span id="cb56-9"><a href="boosting.html#cb56-9"></a><span class="bu">print</span>(data.dropna(axis <span class="op">=</span> <span class="dv">0</span>, how <span class="op">=</span> <span class="st">&quot;any&quot;</span>))  <span class="co"># åˆ é™¤æœ‰ç¼ºå¤±å€¼çš„è¡Œ</span></span>
<span id="cb56-10"><a href="boosting.html#cb56-10"></a><span class="bu">print</span>(data.drop([<span class="st">&#39;debt&#39;</span>], axis <span class="op">=</span> <span class="dv">1</span>))  <span class="co"># åˆ é™¤åˆ—debt</span></span>
<span id="cb56-11"><a href="boosting.html#cb56-11"></a></span>
<span id="cb56-12"><a href="boosting.html#cb56-12"></a><span class="bu">print</span>(pd.get_dummies(data, drop_first <span class="op">=</span> <span class="va">True</span>))  <span class="co"># ç”Ÿæˆå“‘å˜é‡</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>æ’åº</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="boosting.html#cb57-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb57-2"><a href="boosting.html#cb57-2"></a>data <span class="op">=</span> {<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Nevada&#39;</span>, <span class="st">&#39;Nevada&#39;</span>],</span>
<span id="cb57-3"><a href="boosting.html#cb57-3"></a>        <span class="st">&#39;year&#39;</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2001</span>, <span class="dv">2002</span>],</span>
<span id="cb57-4"><a href="boosting.html#cb57-4"></a>        <span class="st">&#39;pop&#39;</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">3.6</span>, <span class="fl">2.4</span>, <span class="fl">2.9</span>]}</span>
<span id="cb57-5"><a href="boosting.html#cb57-5"></a>data <span class="op">=</span> pd.DataFrame(data, columns <span class="op">=</span> [<span class="st">&#39;year&#39;</span>, <span class="st">&#39;state&#39;</span>, <span class="st">&#39;pop&#39;</span>])</span>
<span id="cb57-6"><a href="boosting.html#cb57-6"></a>data[<span class="st">&#39;debt&#39;</span>] <span class="op">=</span> <span class="fl">16.5</span></span>
<span id="cb57-7"><a href="boosting.html#cb57-7"></a></span>
<span id="cb57-8"><a href="boosting.html#cb57-8"></a><span class="bu">print</span>(data.sort_values(by <span class="op">=</span> <span class="st">&#39;year&#39;</span>, ascending <span class="op">=</span> <span class="va">True</span>))  <span class="co"># æŒ‰ç…§yearçš„å€¼å‡åº</span></span>
<span id="cb57-9"><a href="boosting.html#cb57-9"></a><span class="bu">print</span>(data.sort_index(axis <span class="op">=</span> <span class="dv">1</span>))  <span class="co"># æŒ‰ç…§åˆ—ç´¢å¼•å‡åº</span></span>
<span id="cb57-10"><a href="boosting.html#cb57-10"></a><span class="bu">print</span>(data.rank())  <span class="co"># æ±‚ç§©</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>ç»Ÿè®¡åˆ†æ</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="boosting.html#cb58-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb58-2"><a href="boosting.html#cb58-2"></a>data <span class="op">=</span> {<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Ohio&#39;</span>, <span class="st">&#39;Nevada&#39;</span>, <span class="st">&#39;Nevada&#39;</span>],</span>
<span id="cb58-3"><a href="boosting.html#cb58-3"></a>        <span class="st">&#39;year&#39;</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2001</span>, <span class="dv">2002</span>],</span>
<span id="cb58-4"><a href="boosting.html#cb58-4"></a>        <span class="st">&#39;pop&#39;</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">3.6</span>, <span class="fl">2.4</span>, <span class="fl">2.9</span>]}</span>
<span id="cb58-5"><a href="boosting.html#cb58-5"></a>data <span class="op">=</span> pd.DataFrame(data, columns <span class="op">=</span> [<span class="st">&#39;year&#39;</span>, <span class="st">&#39;state&#39;</span>, <span class="st">&#39;pop&#39;</span>])</span>
<span id="cb58-6"><a href="boosting.html#cb58-6"></a>data[<span class="st">&#39;debt&#39;</span>] <span class="op">=</span> <span class="fl">16.5</span></span>
<span id="cb58-7"><a href="boosting.html#cb58-7"></a></span>
<span id="cb58-8"><a href="boosting.html#cb58-8"></a><span class="bu">print</span>(data.describe())  <span class="co"># å¯¹æ¯åˆ—è®¡ç®—åŸºæœ¬ç»Ÿè®¡é‡</span></span>
<span id="cb58-9"><a href="boosting.html#cb58-9"></a><span class="bu">print</span>(data.count())  <span class="co"># è®¡æ•°</span></span>
<span id="cb58-10"><a href="boosting.html#cb58-10"></a><span class="bu">print</span>(data.<span class="bu">max</span>())  <span class="co"># æœ€å¤§å€¼</span></span>
<span id="cb58-11"><a href="boosting.html#cb58-11"></a><span class="bu">print</span>(data.<span class="bu">min</span>())  <span class="co"># æœ€å°å€¼</span></span>
<span id="cb58-12"><a href="boosting.html#cb58-12"></a><span class="bu">print</span>(data.<span class="bu">sum</span>())  <span class="co"># å’Œ</span></span>
<span id="cb58-13"><a href="boosting.html#cb58-13"></a><span class="bu">print</span>(data.mean())  <span class="co"># å‡å€¼</span></span>
<span id="cb58-14"><a href="boosting.html#cb58-14"></a><span class="bu">print</span>(data.median())  <span class="co"># ä¸­ä½æ•°</span></span>
<span id="cb58-15"><a href="boosting.html#cb58-15"></a><span class="bu">print</span>(data.var())  <span class="co"># æ–¹å·®</span></span>
<span id="cb58-16"><a href="boosting.html#cb58-16"></a><span class="bu">print</span>(data.std())  <span class="co"># æ ‡å‡†å·®</span></span>
<span id="cb58-17"><a href="boosting.html#cb58-17"></a><span class="bu">print</span>(data.cov())  <span class="co"># åæ–¹å·®</span></span>
<span id="cb58-18"><a href="boosting.html#cb58-18"></a><span class="bu">print</span>(data.corr())  <span class="co"># ç›¸å…³ç³»æ•°</span></span></code></pre></div>
</div>
<div id="matplotlibåŒ…" class="section level3">
<h3><span class="header-section-number">4.10.5</span> MatplotlibåŒ…</h3>
<p>Matplotlibæ˜¯ä¸€ä¸ªPython çš„2Dç»˜å›¾åº“ï¼Œå®ƒä»¥å„ç§ç¡¬æ‹·è´æ ¼å¼å’Œè·¨å¹³å°çš„äº¤äº’å¼ç¯å¢ƒç”Ÿæˆå‡ºç‰ˆè´¨é‡çº§åˆ«çš„å›¾å½¢ã€‚</p>
<ol style="list-style-type: decimal">
<li>æŠ˜çº¿å›¾</li>
</ol>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="boosting.html#cb59-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb59-2"><a href="boosting.html#cb59-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt </span>
<span id="cb59-3"><a href="boosting.html#cb59-3"></a> </span>
<span id="cb59-4"><a href="boosting.html#cb59-4"></a>x <span class="op">=</span> np.arange(<span class="dv">1</span>,<span class="dv">11</span>) </span>
<span id="cb59-5"><a href="boosting.html#cb59-5"></a>y <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">5</span> </span>
<span id="cb59-6"><a href="boosting.html#cb59-6"></a></span>
<span id="cb59-7"><a href="boosting.html#cb59-7"></a>plt.title(<span class="st">&#39;Matplotlib demo&#39;</span>) </span>
<span id="cb59-8"><a href="boosting.html#cb59-8"></a>plt.xlabel(<span class="st">&#39;x&#39;</span>) </span>
<span id="cb59-9"><a href="boosting.html#cb59-9"></a>plt.ylabel(<span class="st">&#39;y&#39;</span>) </span>
<span id="cb59-10"><a href="boosting.html#cb59-10"></a>plt.plot(x, y, ls <span class="op">=</span> <span class="st">&#39;--&#39;</span>, marker <span class="op">=</span> <span class="st">&#39;+&#39;</span>, color <span class="op">=</span> <span class="st">&#39;lightblue&#39;</span>)  <span class="co"># lsä¸ºçº¿å‹ï¼Œmarkerä¸ºæ ‡è®°ç±»å‹</span></span>
<span id="cb59-11"><a href="boosting.html#cb59-11"></a>plt.show()</span></code></pre></div>
<p><img src="plots/4/%E6%8A%98%E7%BA%BF%E5%9B%BE.png" width="50%"  style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>æ•£ç‚¹å›¾</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="boosting.html#cb60-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb60-2"><a href="boosting.html#cb60-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt </span>
<span id="cb60-3"><a href="boosting.html#cb60-3"></a></span>
<span id="cb60-4"><a href="boosting.html#cb60-4"></a>x <span class="op">=</span> np.random.random(<span class="dv">100</span>)</span>
<span id="cb60-5"><a href="boosting.html#cb60-5"></a>y <span class="op">=</span> np.random.random(<span class="dv">100</span>)</span>
<span id="cb60-6"><a href="boosting.html#cb60-6"></a></span>
<span id="cb60-7"><a href="boosting.html#cb60-7"></a>plt.scatter(x, y, s<span class="op">=</span>x<span class="op">*</span><span class="dv">1000</span>, color<span class="op">=</span><span class="st">&#39;pink&#39;</span>, marker<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">1</span>), alpha<span class="op">=</span><span class="fl">0.5</span>, lw<span class="op">=</span><span class="dv">2</span>)  <span class="co"># sä¸ºå›¾åƒå¤§å°ï¼Œlwä¸ºå›¾åƒè¾¹æ¡†å®½åº¦</span></span>
<span id="cb60-8"><a href="boosting.html#cb60-8"></a>plt.show()</span></code></pre></div>
<p><img src="plots/4/%E6%95%A3%E7%82%B9%E5%9B%BE.png" width="50%"  style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>ç®±çº¿å›¾</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="boosting.html#cb61-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb61-2"><a href="boosting.html#cb61-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb61-3"><a href="boosting.html#cb61-3"></a>x <span class="op">=</span> np.random.gamma(shape <span class="op">=</span> <span class="dv">3</span>, scale <span class="op">=</span> <span class="dv">2</span>, size <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb61-4"><a href="boosting.html#cb61-4"></a></span>
<span id="cb61-5"><a href="boosting.html#cb61-5"></a>plt.boxplot(x, vert<span class="op">=</span><span class="va">True</span>)  <span class="co"># vertæ§åˆ¶æ–¹å‘</span></span>
<span id="cb61-6"><a href="boosting.html#cb61-6"></a>plt.show()</span></code></pre></div>
<p><img src="plots/4/%E7%AE%B1%E7%BA%BF%E5%9B%BE.png" width="50%"  style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>æ¡å½¢å›¾</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="boosting.html#cb62-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb62-2"><a href="boosting.html#cb62-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb62-3"><a href="boosting.html#cb62-3"></a></span>
<span id="cb62-4"><a href="boosting.html#cb62-4"></a>x_index <span class="op">=</span> np.arange(<span class="dv">5</span>)   <span class="co">#æŸ±çš„ç´¢å¼•</span></span>
<span id="cb62-5"><a href="boosting.html#cb62-5"></a>x_data <span class="op">=</span> [<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>]</span>
<span id="cb62-6"><a href="boosting.html#cb62-6"></a>y1_data <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">27</span>]</span>
<span id="cb62-7"><a href="boosting.html#cb62-7"></a>y2_data <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">34</span>, <span class="dv">20</span>, <span class="dv">25</span>]</span>
<span id="cb62-8"><a href="boosting.html#cb62-8"></a></span>
<span id="cb62-9"><a href="boosting.html#cb62-9"></a>plt.bar(x_index, y1_data, width<span class="op">=</span><span class="fl">0.35</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">&#39;lightblue&#39;</span>, label<span class="op">=</span><span class="st">&#39;y1&#39;</span>)  <span class="co"># å‚æ•°ï¼šå·¦åç§»ã€é«˜åº¦ã€æŸ±å®½ã€é€æ˜åº¦ã€é¢œè‰²ã€å›¾ä¾‹</span></span>
<span id="cb62-10"><a href="boosting.html#cb62-10"></a>plt.bar(x_index <span class="op">+</span> <span class="fl">0.35</span>, y2_data, width<span class="op">=</span><span class="fl">0.35</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">&#39;pink&#39;</span>, label<span class="op">=</span><span class="st">&#39;y2&#39;</span>)</span>
<span id="cb62-11"><a href="boosting.html#cb62-11"></a></span>
<span id="cb62-12"><a href="boosting.html#cb62-12"></a>plt.xticks(x_index <span class="op">+</span> bar_width<span class="op">/</span><span class="dv">2</span>, x_data)  <span class="co"># xè½´åˆ»åº¦çº¿</span></span>
<span id="cb62-13"><a href="boosting.html#cb62-13"></a>plt.legend()  <span class="co"># æ˜¾ç¤ºå›¾ä¾‹</span></span>
<span id="cb62-14"><a href="boosting.html#cb62-14"></a>plt.show()</span></code></pre></div>
<p><img src="plots/4/%E6%9D%A1%E5%BD%A2%E5%9B%BE.png" width="50%"  style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>ç›´æ–¹å›¾</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="boosting.html#cb63-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb63-2"><a href="boosting.html#cb63-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb63-3"><a href="boosting.html#cb63-3"></a></span>
<span id="cb63-4"><a href="boosting.html#cb63-4"></a>x <span class="op">=</span> np.random.randn(<span class="dv">10000</span>)</span>
<span id="cb63-5"><a href="boosting.html#cb63-5"></a></span>
<span id="cb63-6"><a href="boosting.html#cb63-6"></a>plt.hist(x, bins<span class="op">=</span><span class="dv">40</span>, density<span class="op">=</span><span class="va">True</span>, histtype<span class="op">=</span><span class="st">&#39;bar&#39;</span>, color<span class="op">=</span><span class="st">&#39;lightblue&#39;</span>)</span>
<span id="cb63-7"><a href="boosting.html#cb63-7"></a>plt.show()</span></code></pre></div>
<p><img src="plots/4/%E7%9B%B4%E6%96%B9%E5%9B%BE.png" width="50%"  style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: decimal">
<li>é¥¼å›¾</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="boosting.html#cb64-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb64-2"><a href="boosting.html#cb64-2"></a></span>
<span id="cb64-3"><a href="boosting.html#cb64-3"></a>labels <span class="op">=</span> [<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>]</span>
<span id="cb64-4"><a href="boosting.html#cb64-4"></a>x <span class="op">=</span> [<span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">10</span>]</span>
<span id="cb64-5"><a href="boosting.html#cb64-5"></a>explode <span class="op">=</span> (<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb64-6"><a href="boosting.html#cb64-6"></a>colors <span class="op">=</span> [<span class="st">&#39;pink&#39;</span>, <span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;lightblue&#39;</span>, <span class="st">&#39;lightyellow&#39;</span>]</span>
<span id="cb64-7"><a href="boosting.html#cb64-7"></a>    </span>
<span id="cb64-8"><a href="boosting.html#cb64-8"></a>plt.pie(x, labels<span class="op">=</span>labels, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>, shadow<span class="op">=</span><span class="va">False</span>, explode<span class="op">=</span>explode, startangle<span class="op">=</span><span class="dv">90</span>, colors<span class="op">=</span>colors)</span>
<span id="cb64-9"><a href="boosting.html#cb64-9"></a>plt.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb64-10"><a href="boosting.html#cb64-10"></a>plt.legend(labels<span class="op">=</span>labels, loc<span class="op">=</span><span class="st">&#39;right&#39;</span>)</span>
<span id="cb64-11"><a href="boosting.html#cb64-11"></a>plt.show()</span></code></pre></div>
<p><img src="plots/4/%E9%A5%BC%E5%9B%BE.png" width="50%"  style="display: block; margin: auto;" /></p>
</div>
<div id="å¸¸ç”¨æ•™ç¨‹ç½‘å€" class="section level3">
<h3><span class="header-section-number">4.10.6</span> å¸¸ç”¨æ•™ç¨‹ç½‘å€</h3>
<ul>
<li><p><a href="https://www.runoob.com/python/python-tutorial.html">PythonåŸºç¡€æ•™ç¨‹</a></p></li>
<li><p><a href="https://docs.python.org/3/">Python3è¯´æ˜æ–‡æ¡£</a></p></li>
<li><p><a href="https://matplotlib.org/">matplotlibå®˜ç½‘</a></p></li>
<li><p><a href="https://scikit-learn.org/stable/">sklearnå­¦ä¹ </a></p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nn.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="unsupervised-learning.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": "github"
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
