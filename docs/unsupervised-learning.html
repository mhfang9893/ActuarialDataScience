<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 æ— ç›‘ç£å­¦ä¹ æ–¹æ³• | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</title>
  <meta name="description" content="The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 æ— ç›‘ç£å­¦ä¹ æ–¹æ³• | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format is bookdown::gitbook." />
  <meta name="github-repo" content="sxpyggy/Modern-Actuarial-Models" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 æ— ç›‘ç£å­¦ä¹ æ–¹æ³• | ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹" />
  
  <meta name="twitter:description" content="The output format is bookdown::gitbook." />
  

<meta name="author" content="Modern Actuarial Models" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="boosting.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ğŸ‘¨â€ğŸ« æ¬¢è¿</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ç­”ç–‘"><i class="fa fa-check"></i>ğŸ¤” ç­”ç–‘</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#è¯¾ç¨‹å®‰æ’"><i class="fa fa-check"></i>ğŸ—“ï¸ è¯¾ç¨‹å®‰æ’</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>ç®€ä»‹</a></li>
<li class="chapter" data-level="1" data-path="pre.html"><a href="pre.html"><i class="fa fa-check"></i><b>1</b> å‡†å¤‡å·¥ä½œ</a><ul>
<li class="chapter" data-level="1.1" data-path="pre.html"><a href="pre.html#å¸¸ç”¨é“¾æ¥"><i class="fa fa-check"></i><b>1.1</b> å¸¸ç”¨é“¾æ¥</a></li>
<li class="chapter" data-level="1.2" data-path="pre.html"><a href="pre.html#å…‹éš†ä»£ç "><i class="fa fa-check"></i><b>1.2</b> å…‹éš†ä»£ç </a></li>
<li class="chapter" data-level="1.3" data-path="pre.html"><a href="pre.html#r-interface-to-keras"><i class="fa fa-check"></i><b>1.3</b> R interface to Keras</a><ul>
<li class="chapter" data-level="1.3.1" data-path="pre.html"><a href="pre.html#rè‡ªåŠ¨å®‰è£…"><i class="fa fa-check"></i><b>1.3.1</b> Rè‡ªåŠ¨å®‰è£…</a></li>
<li class="chapter" data-level="1.3.2" data-path="pre.html"><a href="pre.html#ä½¿ç”¨reticulateå…³è”condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.3.2</b> ä½¿ç”¨reticulateå…³è”condaç¯å¢ƒ</a></li>
<li class="chapter" data-level="1.3.3" data-path="pre.html"><a href="pre.html#æŒ‡å®šcondaå®‰è£…"><i class="fa fa-check"></i><b>1.3.3</b> æŒ‡å®šcondaå®‰è£…</a></li>
<li class="chapter" data-level="1.3.4" data-path="pre.html"><a href="pre.html#ä½¿ç”¨reticulateå®‰è£…"><i class="fa fa-check"></i><b>1.3.4</b> ä½¿ç”¨reticulateå®‰è£…</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="pre.html"><a href="pre.html#r-interface-to-python"><i class="fa fa-check"></i><b>1.4</b> R interface to Python</a><ul>
<li class="chapter" data-level="1.4.1" data-path="pre.html"><a href="pre.html#reticulate-å¸¸è§å‘½ä»¤"><i class="fa fa-check"></i><b>1.4.1</b> reticulate å¸¸è§å‘½ä»¤</a></li>
<li class="chapter" data-level="1.4.2" data-path="pre.html"><a href="pre.html#åˆ‡æ¢rå…³è”çš„condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.4.2</b> åˆ‡æ¢Rå…³è”çš„condaç¯å¢ƒ</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="pre.html"><a href="pre.html#python"><i class="fa fa-check"></i><b>1.5</b> Python</a><ul>
<li class="chapter" data-level="1.5.1" data-path="pre.html"><a href="pre.html#condaç¯å¢ƒ"><i class="fa fa-check"></i><b>1.5.1</b> Condaç¯å¢ƒ</a></li>
<li class="chapter" data-level="1.5.2" data-path="pre.html"><a href="pre.html#å¸¸ç”¨çš„condaå‘½ä»¤"><i class="fa fa-check"></i><b>1.5.2</b> å¸¸ç”¨çš„Condaå‘½ä»¤</a></li>
<li class="chapter" data-level="1.5.3" data-path="pre.html"><a href="pre.html#tensorflowpytorch-gpu-version"><i class="fa fa-check"></i><b>1.5.3</b> Tensorflow/Pytorch GPU version</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="french.html"><a href="french.html"><i class="fa fa-check"></i><b>2</b> è½¦é™©ç´¢èµ”é¢‘ç‡é¢„æµ‹</a><ul>
<li class="chapter" data-level="2.1" data-path="french.html"><a href="french.html#èƒŒæ™¯ä»‹ç»"><i class="fa fa-check"></i><b>2.1</b> èƒŒæ™¯ä»‹ç»</a></li>
<li class="chapter" data-level="2.2" data-path="french.html"><a href="french.html#é¢„æµ‹æ¨¡å‹æ¦‚è¿°"><i class="fa fa-check"></i><b>2.2</b> é¢„æµ‹æ¨¡å‹æ¦‚è¿°</a></li>
<li class="chapter" data-level="2.3" data-path="french.html"><a href="french.html#ç‰¹å¾å·¥ç¨‹"><i class="fa fa-check"></i><b>2.3</b> ç‰¹å¾å·¥ç¨‹</a><ul>
<li class="chapter" data-level="2.3.1" data-path="french.html"><a href="french.html#æˆªæ–­"><i class="fa fa-check"></i><b>2.3.1</b> æˆªæ–­</a></li>
<li class="chapter" data-level="2.3.2" data-path="french.html"><a href="french.html#ç¦»æ•£åŒ–"><i class="fa fa-check"></i><b>2.3.2</b> ç¦»æ•£åŒ–</a></li>
<li class="chapter" data-level="2.3.3" data-path="french.html"><a href="french.html#è®¾å®šåŸºç¡€æ°´å¹³"><i class="fa fa-check"></i><b>2.3.3</b> è®¾å®šåŸºç¡€æ°´å¹³</a></li>
<li class="chapter" data-level="2.3.4" data-path="french.html"><a href="french.html#åå˜é‡å˜å½¢"><i class="fa fa-check"></i><b>2.3.4</b> åå˜é‡å˜å½¢</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="french.html"><a href="french.html#è®­ç»ƒé›†-éªŒè¯é›†-æµ‹è¯•é›†"><i class="fa fa-check"></i><b>2.4</b> è®­ç»ƒé›†-éªŒè¯é›†-æµ‹è¯•é›†</a></li>
<li class="chapter" data-level="2.5" data-path="french.html"><a href="french.html#æ³Šæ¾åå·®æŸå¤±å‡½æ•°"><i class="fa fa-check"></i><b>2.5</b> æ³Šæ¾åå·®æŸå¤±å‡½æ•°</a></li>
<li class="chapter" data-level="2.6" data-path="french.html"><a href="french.html#æ³Šæ¾å›å½’æ¨¡å‹"><i class="fa fa-check"></i><b>2.6</b> æ³Šæ¾å›å½’æ¨¡å‹</a></li>
<li class="chapter" data-level="2.7" data-path="french.html"><a href="french.html#æ³Šæ¾å¯åŠ æ¨¡å‹"><i class="fa fa-check"></i><b>2.7</b> æ³Šæ¾å¯åŠ æ¨¡å‹</a></li>
<li class="chapter" data-level="2.8" data-path="french.html"><a href="french.html#æ³Šæ¾å›å½’æ ‘"><i class="fa fa-check"></i><b>2.8</b> æ³Šæ¾å›å½’æ ‘</a></li>
<li class="chapter" data-level="2.9" data-path="french.html"><a href="french.html#éšæœºæ£®æ—"><i class="fa fa-check"></i><b>2.9</b> éšæœºæ£®æ—</a></li>
<li class="chapter" data-level="2.10" data-path="french.html"><a href="french.html#æ³Šæ¾æå‡æ ‘"><i class="fa fa-check"></i><b>2.10</b> æ³Šæ¾æå‡æ ‘</a></li>
<li class="chapter" data-level="2.11" data-path="french.html"><a href="french.html#æ¨¡å‹æ¯”è¾ƒ"><i class="fa fa-check"></i><b>2.11</b> æ¨¡å‹æ¯”è¾ƒ</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nn.html"><a href="nn.html"><i class="fa fa-check"></i><b>3</b> ç¥ç»ç½‘ç»œ</a><ul>
<li class="chapter" data-level="3.1" data-path="nn.html"><a href="nn.html#å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸€èˆ¬æ­¥éª¤"><i class="fa fa-check"></i><b>3.1</b> å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸€èˆ¬æ­¥éª¤</a><ul>
<li class="chapter" data-level="3.1.1" data-path="nn.html"><a href="nn.html#æ˜ç¡®ç›®æ ‡å’Œæ•°æ®ç±»å‹"><i class="fa fa-check"></i><b>3.1.1</b> æ˜ç¡®ç›®æ ‡å’Œæ•°æ®ç±»å‹</a></li>
<li class="chapter" data-level="3.1.2" data-path="nn.html"><a href="nn.html#æ•°æ®é¢„å¤„ç†"><i class="fa fa-check"></i><b>3.1.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="3.1.3" data-path="nn.html"><a href="nn.html#é€‰å–åˆé€‚çš„ç¥ç»ç½‘ç»œç±»å‹"><i class="fa fa-check"></i><b>3.1.3</b> é€‰å–åˆé€‚çš„ç¥ç»ç½‘ç»œç±»å‹</a></li>
<li class="chapter" data-level="3.1.4" data-path="nn.html"><a href="nn.html#å»ºç«‹ç¥ç»ç½‘ç»œå…¨è¿æ¥ç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>3.1.4</b> å»ºç«‹ç¥ç»ç½‘ç»œï¼ˆå…¨è¿æ¥ç¥ç»ç½‘ç»œï¼‰</a></li>
<li class="chapter" data-level="3.1.5" data-path="nn.html"><a href="nn.html#è®­ç»ƒç¥ç»ç½‘ç»œ"><i class="fa fa-check"></i><b>3.1.5</b> è®­ç»ƒç¥ç»ç½‘ç»œ</a></li>
<li class="chapter" data-level="3.1.6" data-path="nn.html"><a href="nn.html#è°ƒå‚"><i class="fa fa-check"></i><b>3.1.6</b> è°ƒå‚</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="nn.html"><a href="nn.html#æ•°æ®é¢„å¤„ç†-1"><i class="fa fa-check"></i><b>3.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="3.3" data-path="nn.html"><a href="nn.html#ç¥ç»ç½‘ç»œæå‡æ¨¡å‹-combined-actuarial-neural-network"><i class="fa fa-check"></i><b>3.3</b> ç¥ç»ç½‘ç»œæå‡æ¨¡å‹ ï¼ˆcombined actuarial neural networkï¼‰</a></li>
<li class="chapter" data-level="3.4" data-path="nn.html"><a href="nn.html#ç¥ç»ç½‘ç»œç»“æ„"><i class="fa fa-check"></i><b>3.4</b> ç¥ç»ç½‘ç»œç»“æ„</a><ul>
<li class="chapter" data-level="3.4.1" data-path="nn.html"><a href="nn.html#ç»“æ„å‚æ•°"><i class="fa fa-check"></i><b>3.4.1</b> ç»“æ„å‚æ•°</a></li>
<li class="chapter" data-level="3.4.2" data-path="nn.html"><a href="nn.html#è¾“å…¥å±‚"><i class="fa fa-check"></i><b>3.4.2</b> è¾“å…¥å±‚</a></li>
<li class="chapter" data-level="3.4.3" data-path="nn.html"><a href="nn.html#embedding-layer"><i class="fa fa-check"></i><b>3.4.3</b> Embedding layer</a></li>
<li class="chapter" data-level="3.4.4" data-path="nn.html"><a href="nn.html#éšè—å±‚"><i class="fa fa-check"></i><b>3.4.4</b> éšè—å±‚</a></li>
<li class="chapter" data-level="3.4.5" data-path="nn.html"><a href="nn.html#è¾“å‡ºå±‚"><i class="fa fa-check"></i><b>3.4.5</b> è¾“å‡ºå±‚</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="nn.html"><a href="nn.html#è®­ç»ƒç¥ç»ç½‘ç»œ-1"><i class="fa fa-check"></i><b>3.5</b> è®­ç»ƒç¥ç»ç½‘ç»œ</a></li>
<li class="chapter" data-level="3.6" data-path="nn.html"><a href="nn.html#æ€»ç»“"><i class="fa fa-check"></i><b>3.6</b> æ€»ç»“</a></li>
<li class="chapter" data-level="3.7" data-path="nn.html"><a href="nn.html#å…¶å®ƒæ¨¡å‹"><i class="fa fa-check"></i><b>3.7</b> å…¶å®ƒæ¨¡å‹</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="boosting.html"><a href="boosting.html"><i class="fa fa-check"></i><b>4</b> æå‡æ–¹æ³• (Boosting)</a><ul>
<li class="chapter" data-level="4.1" data-path="boosting.html"><a href="boosting.html#adaboost"><i class="fa fa-check"></i><b>4.1</b> AdaBoost</a></li>
<li class="chapter" data-level="4.2" data-path="boosting.html"><a href="boosting.html#logit-boost-real-discrete-gentle-adaboost"><i class="fa fa-check"></i><b>4.2</b> Logit Boost (real, discrete, gentle AdaBoost)</a></li>
<li class="chapter" data-level="4.3" data-path="boosting.html"><a href="boosting.html#adaboost.m1"><i class="fa fa-check"></i><b>4.3</b> AdaBoost.M1</a></li>
<li class="chapter" data-level="4.4" data-path="boosting.html"><a href="boosting.html#samme-stage-wise-additive-modeling-using-a-multi-class-exponential-loss-function"><i class="fa fa-check"></i><b>4.4</b> SAMME (Stage-wise Additive Modeling using a Multi-class Exponential loss function)</a></li>
<li class="chapter" data-level="4.5" data-path="boosting.html"><a href="boosting.html#samme.r-multi-class-real-adaboost"><i class="fa fa-check"></i><b>4.5</b> SAMME.R (multi-class real AdaBoost)</a></li>
<li class="chapter" data-level="4.6" data-path="boosting.html"><a href="boosting.html#gradient-boosting"><i class="fa fa-check"></i><b>4.6</b> Gradient Boosting</a></li>
<li class="chapter" data-level="4.7" data-path="boosting.html"><a href="boosting.html#newton-boosting"><i class="fa fa-check"></i><b>4.7</b> Newton Boosting</a></li>
<li class="chapter" data-level="4.8" data-path="boosting.html"><a href="boosting.html#xgboost"><i class="fa fa-check"></i><b>4.8</b> XGBoost</a></li>
<li class="chapter" data-level="4.9" data-path="boosting.html"><a href="boosting.html#case-study"><i class="fa fa-check"></i><b>4.9</b> Case study</a><ul>
<li class="chapter" data-level="4.9.1" data-path="boosting.html"><a href="boosting.html#æ•°æ®æè¿°"><i class="fa fa-check"></i><b>4.9.1</b> æ•°æ®æè¿°</a></li>
<li class="chapter" data-level="4.9.2" data-path="boosting.html"><a href="boosting.html#æ•°æ®é¢„å¤„ç†-2"><i class="fa fa-check"></i><b>4.9.2</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="4.9.3" data-path="boosting.html"><a href="boosting.html#ç‰¹å¾å·¥ç¨‹-1"><i class="fa fa-check"></i><b>4.9.3</b> ç‰¹å¾å·¥ç¨‹</a></li>
<li class="chapter" data-level="4.9.4" data-path="boosting.html"><a href="boosting.html#å»ºæ¨¡æµç¨‹"><i class="fa fa-check"></i><b>4.9.4</b> å»ºæ¨¡æµç¨‹</a></li>
<li class="chapter" data-level="4.9.5" data-path="boosting.html"><a href="boosting.html#æ¨¡å‹åº¦é‡giniç³»æ•°"><i class="fa fa-check"></i><b>4.9.5</b> æ¨¡å‹åº¦é‡â€”â€”Giniç³»æ•°</a></li>
<li class="chapter" data-level="4.9.6" data-path="boosting.html"><a href="boosting.html#å»ºç«‹adaboostæ¨¡å‹"><i class="fa fa-check"></i><b>4.9.6</b> å»ºç«‹AdaBoostæ¨¡å‹</a></li>
<li class="chapter" data-level="4.9.7" data-path="boosting.html"><a href="boosting.html#å»ºç«‹xgboostæ¨¡å‹"><i class="fa fa-check"></i><b>4.9.7</b> å»ºç«‹XGBoostæ¨¡å‹</a></li>
<li class="chapter" data-level="4.9.8" data-path="boosting.html"><a href="boosting.html#ç»“è®º"><i class="fa fa-check"></i><b>4.9.8</b> ç»“è®º</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="boosting.html"><a href="boosting.html#appendix-commonly-used-python-code-for-py-beginners"><i class="fa fa-check"></i><b>4.10</b> Appendix: Commonly used Python code (for py-beginners)</a><ul>
<li class="chapter" data-level="4.10.1" data-path="boosting.html"><a href="boosting.html#pythonæ ‡å‡†æ•°æ®ç±»å‹"><i class="fa fa-check"></i><b>4.10.1</b> Pythonæ ‡å‡†æ•°æ®ç±»å‹</a></li>
<li class="chapter" data-level="4.10.2" data-path="boosting.html"><a href="boosting.html#pythonå†…ç½®å‡½æ•°"><i class="fa fa-check"></i><b>4.10.2</b> Pythonå†…ç½®å‡½æ•°</a></li>
<li class="chapter" data-level="4.10.3" data-path="boosting.html"><a href="boosting.html#numpyåŒ…"><i class="fa fa-check"></i><b>4.10.3</b> numpyåŒ…</a></li>
<li class="chapter" data-level="4.10.4" data-path="boosting.html"><a href="boosting.html#pandasåŒ…"><i class="fa fa-check"></i><b>4.10.4</b> pandasåŒ…</a></li>
<li class="chapter" data-level="4.10.5" data-path="boosting.html"><a href="boosting.html#matplotlibåŒ…"><i class="fa fa-check"></i><b>4.10.5</b> MatplotlibåŒ…</a></li>
<li class="chapter" data-level="4.10.6" data-path="boosting.html"><a href="boosting.html#å¸¸ç”¨æ•™ç¨‹ç½‘å€"><i class="fa fa-check"></i><b>4.10.6</b> å¸¸ç”¨æ•™ç¨‹ç½‘å€</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>5</b> æ— ç›‘ç£å­¦ä¹ æ–¹æ³•</a><ul>
<li class="chapter" data-level="5.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä¸»æˆåˆ†åˆ†æ"><i class="fa fa-check"></i><b>5.1</b> ä¸»æˆåˆ†åˆ†æ</a></li>
<li class="chapter" data-level="5.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#è‡ªç¼–ç "><i class="fa fa-check"></i><b>5.2</b> è‡ªç¼–ç </a><ul>
<li class="chapter" data-level="5.2.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#æ¨¡å‹è®­ç»ƒ"><i class="fa fa-check"></i><b>5.2.1</b> æ¨¡å‹è®­ç»ƒ</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#èšç±»"><i class="fa fa-check"></i><b>5.3</b> èšç±»</a><ul>
<li class="chapter" data-level="5.3.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means-clustering"><i class="fa fa-check"></i><b>5.3.1</b> K-means clustering</a></li>
<li class="chapter" data-level="5.3.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-medoids-clustering-pam"><i class="fa fa-check"></i><b>5.3.2</b> K-medoids clustering (PAM)</a></li>
<li class="chapter" data-level="5.3.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#gaussian-mixture-modelsgmms"><i class="fa fa-check"></i><b>5.3.3</b> Gaussian mixture models(GMMs)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä½ç»´å¯è§†åŒ–"><i class="fa fa-check"></i><b>5.4</b> ä½ç»´å¯è§†åŒ–</a><ul>
<li class="chapter" data-level="5.4.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#t-sne"><i class="fa fa-check"></i><b>5.4.1</b> t-SNE</a></li>
<li class="chapter" data-level="5.4.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#umap"><i class="fa fa-check"></i><b>5.4.2</b> UMAP</a></li>
<li class="chapter" data-level="5.4.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#som"><i class="fa fa-check"></i><b>5.4.3</b> SOM</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#case-study-1"><i class="fa fa-check"></i><b>5.5</b> Case study</a><ul>
<li class="chapter" data-level="5.5.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#æ•°æ®é¢„å¤„ç†-3"><i class="fa fa-check"></i><b>5.5.1</b> æ•°æ®é¢„å¤„ç†</a></li>
<li class="chapter" data-level="5.5.2" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#ä¸»æˆåˆ†åˆ†æ-1"><i class="fa fa-check"></i><b>5.5.2</b> ä¸»æˆåˆ†åˆ†æ</a></li>
<li class="chapter" data-level="5.5.3" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#è‡ªç¼–ç -1"><i class="fa fa-check"></i><b>5.5.3</b> è‡ªç¼–ç </a></li>
<li class="chapter" data-level="5.5.4" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-means"><i class="fa fa-check"></i><b>5.5.4</b> K-means</a></li>
<li class="chapter" data-level="5.5.5" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#k-medoids"><i class="fa fa-check"></i><b>5.5.5</b> K-medoids</a></li>
<li class="chapter" data-level="5.5.6" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#gaussian-mixture-model"><i class="fa fa-check"></i><b>5.5.6</b> Gaussian mixture model</a></li>
<li class="chapter" data-level="5.5.7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#t-sne-1"><i class="fa fa-check"></i><b>5.5.7</b> t-SNE</a></li>
<li class="chapter" data-level="5.5.8" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#umap-1"><i class="fa fa-check"></i><b>5.5.8</b> UMAP</a></li>
<li class="chapter" data-level="5.5.9" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#kohonen-map"><i class="fa fa-check"></i><b>5.5.9</b> Kohonen map</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/sxpyggy/Modern-Actuarial-Models/tree/modern-actuarial-models" target="blank">GitHub ä»“åº“</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ç°ä»£ç²¾ç®—ç»Ÿè®¡æ¨¡å‹</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unsupervised-learning" class="section level1">
<h1><span class="header-section-number">5</span> æ— ç›‘ç£å­¦ä¹ æ–¹æ³•</h1>
<p><em>æ¢è¯‘ä¸­ã€æ–¹æ˜æ…§ã€ç‹æ™—ã€é«˜å…‰è¿œ</em></p>
<p>å¤§å­¦åŠä»¥åç”Ÿæ´»ä¸­æœ€å¸¸ç”¨çš„å­¦ä¹ æ–¹æ³•ã€‚</p>
<p>æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ç›®çš„æ˜¯é™ä½æ•°æ®ï¼ˆåå˜é‡ï¼Œç‰¹å¾ï¼‰ç»´åº¦ã€æŠŠæ¡ˆä¾‹æŒ‰ç…§ç›¸ä¼¼ç‰¹å¾èšç±»å¹¶ä»¥å›¾å½¢æ–¹å¼è¯´æ˜é«˜ç»´æ•°æ®çš„æŠ€æœ¯ã€‚æ— ç›‘ç£å­¦ä¹ ä¸è€ƒè™‘å“åº”å˜é‡ï¼Œä»…è€ƒè™‘è¿™äº›ç‰¹å¾æœ¬èº«çš„ç›¸ä¼¼æ€§ã€‚</p>
<p>æœ¬ç« å°†è€ƒè™‘ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>
<ul>
<li><p><strong>é™ç»´</strong>ï¼šä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰å’Œç“¶é¢ˆç¥ç»ç½‘ç»œï¼ˆBNNï¼‰ã€‚</p></li>
<li><p><strong>èšç±»</strong>ï¼š<span class="math inline">\(K\)</span>-meanså‡å€¼èšç±»ï¼ŒK-medoidsèšç±»ï¼Œé«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰</p></li>
<li><p><strong>å¯è§†åŒ–é«˜ç»´æ•°æ®</strong>ï¼šå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVAEï¼‰ï¼Œtåˆ†å¸ƒéšæœºé‚»è¿‘åµŒå…¥ï¼ˆt-SNEï¼‰ï¼Œç»Ÿä¸€æµå½¢é€¼è¿‘å’ŒæŠ•å½±ï¼ˆUMAPï¼‰ï¼Œè‡ªç»„ç»‡æ˜ å°„ï¼ˆSOMï¼‰å’ŒKohonenå›¾ã€‚</p></li>
</ul>
<p>å‡è®¾æ ·æœ¬é‡ä¸º<span class="math inline">\(n\)</span>çš„æ ·æœ¬æœ‰<span class="math inline">\(q\)</span>ä¸ªç‰¹å¾<span class="math inline">\(\mathbf{x}_1^*,\ldots,\mathbf{x}^*_n\in\mathbb{R}^q\)</span>ã€‚å…¶è®¾è®¡çŸ©é˜µä¸º
<span class="math display">\[\mathbf{X}=(\mathbf{x}_1^*,\ldots,\mathbf{x}^*_n)^\intercal\in\mathbb{R}^{n\times q}.\]</span>
æŠŠè®¾è®¡çŸ©é˜µçš„æ¯åˆ—è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå¾—åˆ°
<span class="math display">\[\mathbf{X}=(x_{i,j})_{1\le i \le n,1\le j\le q}\in\mathbb{R}^{n\times q}.\]</span>
å…¶ä¸­ï¼Œç¬¬<span class="math inline">\(i\)</span>è¡Œæ˜¯æ ·æœ¬<span class="math inline">\(i\)</span>çš„ç‰¹å¾<span class="math inline">\(\mathbf{x}_i\in\mathbb{R}^q, 1\le i\le n\)</span>, ç¬¬<span class="math inline">\(j\)</span>åˆ—æ˜¯ç¬¬<span class="math inline">\(j\)</span>ä¸ªç‰¹å¾<span class="math inline">\(x_j\in\mathbb{R}^n\)</span>.</p>
<div id="ä¸»æˆåˆ†åˆ†æ" class="section level2">
<h2><span class="header-section-number">5.1</span> ä¸»æˆåˆ†åˆ†æ</h2>
<p>ç®€è€Œè¨€ä¹‹ï¼Œä¸»æˆåˆ†åˆ†æçš„ç›®çš„æ˜¯é™ä½é«˜ç»´æ•°æ®çš„ç»´æ•°ï¼Œä½¿é‡æ„è¯¯å·®ç›¸å¯¹äºåŸå§‹æ•°æ®æœ€å°ã€‚å¦‚æœåº”ç”¨æˆåŠŸï¼Œå®ƒå‡å°‘äº†ç‰¹å¾ç©ºé—´çš„ç»´æ•°ï¼Œå¹¶ä¸”å®ƒå¯¹äº(ç²¾ç®—)å›å½’å»ºæ¨¡ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒæä¾›äº†å°‘é‡çš„ä¸ç›¸å…³çš„è§£é‡Šå˜é‡ã€‚</p>
<p>PCAé€‚ç”¨äºé«˜æ–¯åˆ†å¸ƒï¼Œè‹¥å˜é‡æ˜¾è‘—ä¸ç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆæ¯”å¦‚å–å¯¹æ•°æˆ–å…¶ä»–æ–¹æ³•ï¼‰ã€‚</p>
<p>çŸ©é˜µ<span class="math inline">\(\mathbf{X}\)</span>çš„ç§©ä¸º<span class="math inline">\(q\le n\)</span>ï¼Œå¯ä»¥æ‰¾åˆ°<span class="math inline">\(q\)</span>ä¸ªæ­£äº¤çš„<span class="math inline">\(q\)</span>ç»´åŸºå‘é‡<span class="math inline">\(\mathbf{v}_1,\ldots,\mathbf{v}_q\in\mathbb{R}^q\)</span>, ä½¿å¾—<span class="math inline">\(\mathbf{v}_1\)</span>ä¸º<span class="math inline">\(\mathbf{X}\)</span>æ³¢åŠ¨æœ€å¤§çš„æ–¹å‘ï¼Œ<span class="math inline">\(\mathbf{v}_2\)</span>ä¸ºä¸<span class="math inline">\(\mathbf{v}_1\)</span>æ­£äº¤æ–¹å‘ä¸Šçš„<span class="math inline">\(\mathbf{X}\)</span>æ³¢åŠ¨æœ€å¤§çš„æ–¹å‘ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p>
<p>ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºå¦‚ä¸‹ï¼š
<span class="math display">\[\mathbf{v}_1=\underset{||\omega||_2=1}{\arg \max}||\mathbf{X}\omega||_2^2=\underset{\omega^\intercal\omega=1}{\arg \max} (\omega^\intercal\mathbf{X}^\intercal\mathbf{X}\omega)\]</span></p>
<p><span class="math display">\[\mathbf{v}_2=\underset{||\omega||_2=1}{\arg \max}||\mathbf{X}\omega||_2^2 ~~~\text{ subject to } \mathbf{v}_1^\intercal\omega=0.\]</span></p>
<p><span class="math display">\[\ldots\]</span></p>
<p>ä¸»æˆåˆ†åˆ†æå¯é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°</p>
<ul>
<li><p>æ±‚<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}\)</span>æˆ–è€…<span class="math inline">\(\mathbf{X}\)</span>çš„åæ–¹å·®çŸ©é˜µ<span class="math inline">\(\mathbf{\Sigma}\)</span>çš„ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼ã€‚æ˜“çŸ¥<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}=n\times\mathbf{\Sigma}\)</span>ï¼Œæ‰€ä»¥å®ƒä»¬çš„ç‰¹å¾å‘é‡ç›¸åŒã€‚ç¬¬ä¸€ä¸ªç‰¹å¾å‘é‡å³ä¸º<span class="math inline">\(\mathbf{v}_1\)</span>ï¼Œç¬¬äºŒä¸ªç‰¹å¾å‘é‡ä¸º<span class="math inline">\(\mathbf{v}_2\)</span>ã€‚å‰ä¸¤ä¸ªä¸»æˆåˆ†ä¸º<span class="math inline">\(\mathbf{X}\mathbf{v}_1,\mathbf{X}\mathbf{v}_2\)</span></p></li>
<li><p>å¯¹<span class="math inline">\(\mathbf{X}\)</span>è¿›è¡Œå¥‡å¼‚å€¼ï¼ˆsingular value decompositionï¼‰åˆ†è§£:<span class="math display">\[\mathbf{X}=U\Lambda V^\intercal.\]</span>å…¶ä¸­ï¼Œå¯¹è§’çŸ©é˜µ<span class="math inline">\(\Lambda=\text{diag}(\lambda_1,\ldots,\lambda_q)\)</span>çš„å…ƒç´ ä¸º<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}\)</span>çš„ç‰¹å¾å€¼ï¼Œ<span class="math inline">\(V\)</span>ä¸º<span class="math inline">\(\mathbf{X}^\intercal \mathbf{X}\)</span>çš„ç‰¹å¾å‘é‡ã€‚ä¸»æˆåˆ†å¯ä»¥é€šè¿‡<span class="math inline">\(\mathbf{X}V\)</span>æ±‚å¾—ã€‚</p></li>
</ul>
<p>åˆ©ç”¨å‰<span class="math inline">\(p\)</span>ä¸ªä¸»æˆåˆ†å¯ä»¥é‡æ„è®¾è®¡çŸ©é˜µçš„è¿‘ä¼¼å€¼<span class="math display">\[\mathbf{X}_p=U\text{diag}(\lambda_1,\ldots,\lambda_p,0,\ldots,0)V^{\intercal}.\]</span> è¯¥è¿‘ä¼¼å€¼ä¸ºä»¥ä¸‹æå€¼é—®é¢˜çš„æ ¹<span class="math display">\[\underset{B\in\mathbb{R}^{n\times q}}{\arg \min}||\mathbf{X}-B||^2 ~~\text{subject to rank}(B)\le q,\]</span> å³çŸ©é˜µ<span class="math inline">\(\mathbf{X}_p\)</span>æ˜¯æ‰€æœ‰ç§©ä¸º<span class="math inline">\(p\)</span>çš„çŸ©é˜µä¸­ï¼Œä¸åŸå§‹è®¾è®¡çŸ©é˜µ<span class="math inline">\(\mathbf{X}\)</span>é‡ç»„å¹³æ–¹è¯¯å·®(FèŒƒæ•°)æœ€å°çš„çŸ©é˜µã€‚</p>
</div>
<div id="è‡ªç¼–ç " class="section level2">
<h2><span class="header-section-number">5.2</span> è‡ªç¼–ç </h2>
<p>PCAå¯¹å¼‚å¸¸å€¼å¾ˆæ•æ„Ÿï¼Œä¹Ÿæœ‰ç¨³å¥çš„PCAç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼ŒCrouxç­‰äººç»™å‡ºäº†ä¸€ä¸ªåŸºäºä¸­å€¼ç»å¯¹åå·®(MADs)çš„ç®—æ³•ï¼ŒRåŒ…ï¼špcaPPã€‚
ä¸»æˆåˆ†åˆ†æå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªè‡ªåŠ¨ç¼–ç å™¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ›´ä¸€èˆ¬åœ°ä»‹ç»è‡ªåŠ¨ç¼–ç å™¨ï¼Œä¾‹å¦‚BNNã€‚</p>
<p>è‡ªç¼–ç åŒ…å«ç¼–ç å’Œè§£ç ä¸¤ä¸ªé•œé¢å¯¹ç§°çš„æ˜ å°„ï¼š</p>
<ul>
<li><p>ç¼–ç : <span class="math inline">\(\phi:\mathbb{R}^q\rightarrow\mathbb{R}^p\)</span></p></li>
<li><p>è§£ç : <span class="math inline">\(\psi=\mathbb{R}^p\rightarrow\mathbb{R}^q\)</span></p></li>
</ul>
<p>ä½œä¸ºéçº¿æ€§è‡ªç¼–ç å™¨çš„ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è€ƒè™‘ç“¶é¢ˆç¥ç»ç½‘ç»œ(BNN)ã€‚ä¸ºäº†æˆåŠŸæ ¡å‡†ä¸€ä¸ªBNNï¼Œå®ƒçš„éšè—å±‚æ•°åº”è¯¥æ˜¯å¥‡æ•°<span class="math inline">\(d\)</span> (<span class="math inline">\(d\)</span>ç§°ä¸ºç¥ç»ç½‘ç»œçš„æ·±åº¦)ï¼Œå¹¶ä¸”ä¸­å¿ƒéšè—å±‚åº”è¯¥æ˜¯ä½ç»´çš„ï¼Œæœ‰<span class="math inline">\(p\)</span>ä¸ªéšè—ç¥ç»å…ƒï¼Œæ‰€æœ‰å‰©ä½™çš„éšè—å±‚åº”è¯¥æ˜¯å›´ç»•è¿™ä¸ªä¸­å¿ƒéšè—å±‚å¯¹ç§°çš„ã€‚å› æ­¤å¯¹äºæ·±åº¦<span class="math inline">\(d = 3\)</span>çš„BNNï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å›¾<a href="unsupervised-learning.html#fig:bnn">5.1</a>å±•ç¤ºçš„ç¥ç»ç½‘ç»œç»“æ„</p>
<div class="figure" style="text-align: center"><span id="fig:bnn"></span>
<img src="plots/5/bnn.png" alt="è‡ªç¼–ç  q=5,p=2" width="40%" />
<p class="caption">
Figure 5.1: è‡ªç¼–ç  q=5,p=2
</p>
</div>
<div id="æ¨¡å‹è®­ç»ƒ" class="section level3">
<h3><span class="header-section-number">5.2.1</span> æ¨¡å‹è®­ç»ƒ</h3>
<p>å›¾<a href="unsupervised-learning.html#fig:bnn-train">5.2</a>å±•ç¤ºäº†è‡ªç¼–ç çš„è®­ç»ƒè¿‡ç¨‹ã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:bnn-train"></span>
<img src="plots/5/bnn_train.png" alt="è‡ªç¼–ç è®­ç»ƒè¿‡ç¨‹" width="60%"  />
<p class="caption">
Figure 5.2: è‡ªç¼–ç è®­ç»ƒè¿‡ç¨‹
</p>
</div>
<p>å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
</div>
</div>
<div id="èšç±»" class="section level2">
<h2><span class="header-section-number">5.3</span> èšç±»</h2>
<ol style="list-style-type: decimal">
<li><p>åˆ†å±‚èšç±»ï¼šä¸éœ€äº‹å…ˆæŒ‡å®šèšç±»ä¸ªæ•° ï¼ˆ1ï¼‰è‡ªä¸‹è€Œä¸Šï¼šåˆå§‹nç±»ï¼Œå†å°†ç›¸è·æœ€è¿‘çš„ä¸¤ç±»åˆå¹¶ï¼Œå»ºç«‹ä¸€ä¸ªæ–°çš„ç±»ï¼Œç›´åˆ°æœ€ååˆå¹¶æˆä¸€ç±»ï¼›ï¼ˆ2ï¼‰è‡ªä¸Šè€Œä¸‹ï¼šåˆå§‹1ç±»ï¼Œå†å°†ç›¸è·æœ€è¿œçš„æ ·æœ¬åˆ†è£‚æˆä¸¤ç±»ï¼Œç›´åˆ°æœ€ååˆ†è£‚æˆnä¸ªç±»ã€‚</p></li>
<li><p>åŸºäºè´¨å¿ƒçš„èšç±»: K-means, K-medoids</p></li>
<li><p>åŸºäºåˆ†å¸ƒçš„èšç±»: Gaussian mixture models(GMMs)</p></li>
</ol>
<div id="k-means-clustering" class="section level3">
<h3><span class="header-section-number">5.3.1</span> K-means clustering</h3>
<p>K-meansèšç±»æ˜¯ä¸€ç§åŸºäºè´¨å¿ƒï¼ˆcentroid-basedï¼‰çš„èšç±»æ–¹æ³•ï¼Œå®ƒå°†<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬ç‚¹<span class="math inline">\(\mathbf{x}_i\in\mathcal{X}\subset\mathbb{R}^q\)</span>åˆ’åˆ†ä¸º<span class="math inline">\(K\)</span>ä¸ªä¸ç›¸äº¤çš„ç±»:<span class="math display">\[\mathcal{C}_K:\mathbb{R}^q\rightarrow\mathcal{K}=\{1,\ldots,K\},~~\mathbf{x}\mapsto\mathcal{C}_K(\mathbf{x})\]</span>ï¼Œä»¥ä¸Šç»™å‡ºäº†å¯¹ç‰¹å¾ç©ºé—´<span class="math inline">\(\mathcal{X}\)</span>çš„ä¸€ä¸ªåˆ†å‰²<span class="math inline">\((C_1,\ldots,C_K)\)</span>ï¼Œå…¶ä¸­<span class="math display">\[C_k=\{\mathbf{x}\in\mathcal{X};\mathcal{C}_K(\mathbf{x})=k\}\]</span></p>
<p>ç¡®å®š<span class="math inline">\(\mathcal{C}_K\)</span>çš„åŸåˆ™æ˜¯ä½¿æ€»ç±»å†…å·®å¼‚æœ€å°ï¼Œè¿™å¯ä»¥è½¬åŒ–ä¸ºè®¡ç®—ä½¿ç±»å†…ç¦»å·®å¹³æ–¹å’Œæ€»å’Œæœ€å°çš„ä¸€ä¸ªåˆ†å‰²ï¼Œæ‰€æ„é€ çš„ç›®æ ‡å‡½æ•°ä¸º ï¼š
<span class="math display">\[\underset{(C_1,\ldots,C_K)}{\arg \min}\sum_{k=1}^K\sum_{\mathbf{x}_i\in C_k\cap\mathcal{X}}d(\mathbf{\mu}_k,\mathbf{x}_i)=\underset{(C_1,\ldots,C_K)}{\arg \min}\sum_{k=1}^K\sum_{\mathbf{x}_i\in C_k\cap\mathcal{X}}||\mathbf{\mu}_k,\mathbf{x}_i||_2^2\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\mathbf{\mu}_k\)</span>ä¸ºç±»å‡å€¼å‘é‡ï¼Œå› æ­¤ç›®æ ‡å‡½æ•°è¡¡é‡äº†ç±»å†…æ ·æœ¬ç‚¹å›´ç»•ç±»å‡å€¼å‘é‡çš„ç´§å¯†ç¨‹åº¦ï¼Œå…¶å€¼è¶Šå°æ„å‘³ç€ç±»å†…æ ·æœ¬ç›¸ä¼¼åº¦è¶Šé«˜ï¼Œèšç±»æ•ˆæœè¶Šå¥½ã€‚ä½†æ˜¯ä¸Šè¿°ç›®æ ‡å‡½æ•°å¹¶ä¸å®¹æ˜“æ‰¾åˆ°æœ€ä¼˜è§£ï¼Œè¿™éœ€è¦è€ƒè™‘<span class="math inline">\(n\)</span>ä¸ªæ ·æœ¬ç‚¹æ‰€æœ‰å¯èƒ½çš„ç±»åˆ’åˆ†ï¼Œå› æ­¤K-meansç®—æ³•é‡‡ç”¨äº†è´ªå¿ƒç­–ç•¥ï¼Œé€šè¿‡è¿­ä»£ä¼˜åŒ–æ¥è¿‘ä¼¼æ±‚è§£ä¸Šè¿°ç›®æ ‡å‡½æ•°ã€‚</p>
</div>
<div id="k-medoids-clustering-pam" class="section level3">
<h3><span class="header-section-number">5.3.2</span> K-medoids clustering (PAM)</h3>
</div>
<div id="gaussian-mixture-modelsgmms" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Gaussian mixture models(GMMs)</h3>
</div>
</div>
<div id="ä½ç»´å¯è§†åŒ–" class="section level2">
<h2><span class="header-section-number">5.4</span> ä½ç»´å¯è§†åŒ–</h2>
<div id="t-sne" class="section level3">
<h3><span class="header-section-number">5.4.1</span> t-SNE</h3>
<p>tåˆ†å¸ƒ-éšæœºé‚»è¿‘åµŒå…¥(t-SNE, t-distributed stochastic neighbor embedding)ç”± Laurens van der Maatenå’ŒGeoffrey Hintonåœ¨2008å¹´æå‡ºã€‚t-SNEæœ¬è´¨æ˜¯ä¸€ç§åµŒå…¥æ¨¡å‹ï¼Œèƒ½å¤Ÿå°†é«˜ç»´ç©ºé—´ä¸­çš„æ•°æ®æ˜ å°„åˆ°ä½ç»´ç©ºé—´ä¸­ï¼Œå¹¶ä¿ç•™æ•°æ®é›†çš„å±€éƒ¨ç‰¹æ€§ã€‚</p>
<p>åŸºæœ¬åŸç†
t-SNEå°†æ•°æ®ç‚¹ä¹‹é—´çš„ç›¸ä¼¼åº¦è½¬åŒ–ä¸ºæ¡ä»¶æ¦‚ç‡ï¼ŒåŸå§‹ç©ºé—´ä¸­æ•°æ®ç‚¹çš„ç›¸ä¼¼åº¦ç”±é«˜æ–¯è”åˆåˆ†å¸ƒè¡¨ç¤ºï¼ŒåµŒå…¥ç©ºé—´ä¸­æ•°æ®ç‚¹çš„ç›¸ä¼¼åº¦ç”±tåˆ†å¸ƒè¡¨ç¤ºã€‚
å°†åŸå§‹ç©ºé—´å’ŒåµŒå…¥ç©ºé—´çš„è”åˆæ¦‚ç‡åˆ†å¸ƒçš„KLæ•£åº¦ä½œä¸ºæŸå¤±å‡½æ•°(loss function)ï¼Œè¯„ä¼°åµŒå…¥æ•ˆæœçš„å¥½åã€‚é€šè¿‡æ¢¯åº¦ä¸‹é™ç®—æ³•æœ€å°åŒ–æŸå¤±å‡½æ•°ï¼Œæœ€ç»ˆè·å¾—æ”¶æ•›ç»“æœã€‚</p>
</div>
<div id="umap" class="section level3">
<h3><span class="header-section-number">5.4.2</span> UMAP</h3>
<p>ç»Ÿä¸€æµå½¢é€¼è¿‘ä¸æŠ•å½±(UMAP, Uniform Manifold Approximation and Projection)æ˜¯å»ºç«‹åœ¨é»æ›¼å‡ ä½•å’Œä»£æ•°æ‹“æ‰‘ç†è®ºæ¡†æ¶ä¸Šçš„æ–°çš„é™ç»´æµå½¢å­¦ä¹ æŠ€æœ¯ã€‚åœ¨å¯è§†åŒ–è´¨é‡æ–¹é¢ï¼ŒUMAPç®—æ³•ä¸t-SNEå…·æœ‰ç«äº‰ä¼˜åŠ¿ï¼Œä½†æ˜¯å®ƒä¿ç•™äº†æ›´å¤šå…¨å±€ç»“æ„ã€å…·æœ‰ä¼˜è¶Šçš„è¿è¡Œæ€§èƒ½ã€æ›´å¥½çš„å¯æ‰©å±•æ€§ã€‚</p>
<p>åŸºæœ¬åŸç†</p>
<ol style="list-style-type: decimal">
<li><p>è®¡ç®—é«˜ç»´çš„æµå½¢ç»“æ„ç‰¹å¾ï¼Œç¡®å®šé«˜ç»´ç©ºé—´ä¸­å„ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œä»è€Œæ„é€ é«˜ç»´çš„æ•°æ®åˆ†å¸ƒç»“æ„ã€‚</p></li>
<li><p>å°†å®ƒä»¬æŠ•å½±åˆ°ä½ç»´ç©ºé—´ï¼Œæ ¹æ®é«˜ç»´ç©ºé—´ç‚¹ä¸ç‚¹ä¹‹é—´çš„ç›¸å¯¹å…³ç³»ï¼Œæå–ç‰¹å¾å€¼ï¼Œåœ¨ä½ç»´ç©ºé—´ä¸­é‡æ„è¿™ç§è·ç¦»å…³ç³»ï¼Œå¹¶è®¡ç®—ä½ç»´ç©ºé—´ä¸­å„ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚</p></li>
</ol>
<p>3ã€‚ ä½¿ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ¥æœ€å°åŒ–è¿™äº›è·ç¦»ä¹‹é—´çš„å·®å¼‚ã€‚</p>
</div>
<div id="som" class="section level3">
<h3><span class="header-section-number">5.4.3</span> SOM</h3>
<p>è‡ªç»„ç»‡æ˜ å°„(Self-organizing map, SOM)æ˜¯ä¸€ç§ç«äº‰å‹ç¥ç»ç½‘ç»œï¼Œç”±è¾“å…¥å±‚å’Œç«äº‰å±‚ï¼ˆå¸¸è§2ç»´ï¼‰æ„æˆã€‚</p>
<ul>
<li><p><strong>è¾“å…¥å±‚</strong>ç¥ç»å…ƒçš„æ•°é‡ç”±è¾“å…¥å‘é‡çš„ç»´åº¦å†³å®šï¼Œä¸€ä¸ªç¥ç»å…ƒå¯¹åº”ä¸€ä¸ªç‰¹å¾</p></li>
<li><p><strong>ç«äº‰å±‚</strong>çš„å¸¸è§ç»“æ„ï¼šçŸ©å½¢(Rectangular)ã€å…­è¾¹å½¢(Hexagonal) ç«äº‰å±‚ç¥ç»å…ƒçš„æ•°é‡å†³å®šäº†æœ€ç»ˆæ¨¡å‹çš„ç²’åº¦ä¸è§„æ¨¡ï¼Œå¯¹æœ€ç»ˆæ¨¡å‹çš„å‡†ç¡®æ€§ä¸æ³›åŒ–èƒ½åŠ›å½±å“å¾ˆå¤§ã€‚</p></li>
<li><p><strong>åŸºæœ¬åŸç†</strong>ï¼šè¿ç”¨ç«äº‰å­¦ä¹ (competitive learning)ç­–ç•¥ï¼Œç«äº‰å±‚å„ç¥ç»å…ƒç«äº‰å¯¹è¾“å…¥å±‚å“åº”çš„æœºä¼šï¼Œæœ€åä»…æœ‰ä¸€ä¸ªç¥ç»å…ƒè·èƒœï¼Œä»£è¡¨å¯¹è¾“å…¥å±‚çš„åˆ†ç±»ã€‚å¦‚æ­¤è¿­ä»£ï¼Œé€æ­¥ä¼˜åŒ–ç½‘ç»œã€‚</p></li>
</ul>
<p>å›¾<a href="unsupervised-learning.html#fig:som">5.3</a>å±•ç¤ºäº†SOMçš„ç»“æ„ã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:som"></span>
<img src="plots/5/som.png" alt="SOM" width="60%"  />
<p class="caption">
Figure 5.3: SOM
</p>
</div>
</div>
</div>
<div id="case-study-1" class="section level2">
<h2><span class="header-section-number">5.5</span> Case study</h2>
<table>
<thead>
<tr class="header">
<th align="center">å˜é‡</th>
<th align="center">ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">brand</td>
<td align="center">factor</td>
<td>43ä¸ªæ±½è½¦å“ç‰Œ</td>
</tr>
<tr class="even">
<td align="center">type</td>
<td align="center">factor</td>
<td>96ä¸ªæ°´å¹³</td>
</tr>
<tr class="odd">
<td align="center">model</td>
<td align="center">factor</td>
<td>113ä¸ªæ°´å¹³</td>
</tr>
<tr class="even">
<td align="center">seats</td>
<td align="center">int</td>
<td>åº§ä½æ•°</td>
</tr>
<tr class="odd">
<td align="center">max_power</td>
<td align="center">int</td>
<td>å‘åŠ¨æœºæœ€å¤§åŠŸç‡(kW),å–å¯¹æ•°</td>
</tr>
<tr class="even">
<td align="center">max_torque</td>
<td align="center">num</td>
<td>æœ€å¤§è½¬çŸ©(Nm),å–å¯¹æ•°</td>
</tr>
<tr class="odd">
<td align="center">cubic_capacity</td>
<td align="center">int</td>
<td>å®¹é‡(cm<span class="math inline">\(^3\)</span>),å–å¯¹æ•°</td>
</tr>
<tr class="even">
<td align="center">weight</td>
<td align="center">int</td>
<td>è½¦é‡(kg)ï¼Œå–å¯¹æ•°</td>
</tr>
<tr class="odd">
<td align="center">max_engine_speed</td>
<td align="center">int</td>
<td>å‘åŠ¨æœºæœ€å¤§è½¬é€Ÿ(rpm)</td>
</tr>
<tr class="even">
<td align="center">seconds_to_100</td>
<td align="center">int</td>
<td>è¾¾åˆ°100km/hæ‰€éœ€è¦ç§’æ•°</td>
</tr>
<tr class="odd">
<td align="center">top_speed</td>
<td align="center">int</td>
<td>æœ€å¤§è¡Œé©¶é€Ÿåº¦(km/h)</td>
</tr>
<tr class="even">
<td align="center">sports_car</td>
<td align="center">int</td>
<td>è·‘è½¦</td>
</tr>
<tr class="odd">
<td align="center">tau</td>
<td align="center">num</td>
<td>ä¸“å®¶è¯„åˆ†</td>
</tr>
</tbody>
</table>
<div id="æ•°æ®é¢„å¤„ç†-3" class="section level3">
<h3><span class="header-section-number">5.5.1</span> æ•°æ®é¢„å¤„ç†</h3>
</div>
<div id="ä¸»æˆåˆ†åˆ†æ-1" class="section level3">
<h3><span class="header-section-number">5.5.2</span> ä¸»æˆåˆ†åˆ†æ</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="unsupervised-learning.html#cb65-1"></a><span class="co"># standardize matrix</span></span>
<span id="cb65-2"><a href="unsupervised-learning.html#cb65-2"></a>X &lt;-<span class="st"> </span>X01<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">colMeans</span>(X01<span class="op">^</span><span class="dv">2</span>))[<span class="kw">col</span>(X01)]</span>
<span id="cb65-3"><a href="unsupervised-learning.html#cb65-3"></a></span>
<span id="cb65-4"><a href="unsupervised-learning.html#cb65-4"></a><span class="co"># eigenvectors and eigenvalues</span></span>
<span id="cb65-5"><a href="unsupervised-learning.html#cb65-5"></a>X1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X)</span>
<span id="cb65-6"><a href="unsupervised-learning.html#cb65-6"></a><span class="kw">nrow</span>(X1)</span>
<span id="cb65-7"><a href="unsupervised-learning.html#cb65-7"></a>A &lt;-<span class="st">  </span><span class="kw">t</span>(X1) <span class="op">%*%</span><span class="st"> </span>X1</span>
<span id="cb65-8"><a href="unsupervised-learning.html#cb65-8"></a>A</span>
<span id="cb65-9"><a href="unsupervised-learning.html#cb65-9"></a><span class="kw">sum</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>value)<span class="op">/</span><span class="dv">5</span></span>
<span id="cb65-10"><a href="unsupervised-learning.html#cb65-10"></a><span class="kw">sqrt</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>value)      <span class="co"># singular values</span></span>
<span id="cb65-11"><a href="unsupervised-learning.html#cb65-11"></a><span class="kw">sqrt</span>(<span class="kw">eigen</span>(A)<span class="op">$</span>value<span class="op">/</span><span class="kw">nrow</span>(X1))   <span class="co"># scaled eigenvalues</span></span>
<span id="cb65-12"><a href="unsupervised-learning.html#cb65-12"></a><span class="kw">eigen</span>(A)<span class="op">$</span>vector</span>
<span id="cb65-13"><a href="unsupervised-learning.html#cb65-13"></a>A1&lt;-<span class="kw">cor</span>(X1)</span>
<span id="cb65-14"><a href="unsupervised-learning.html#cb65-14"></a>A1<span class="op">*</span><span class="kw">nrow</span>(X1)</span>
<span id="cb65-15"><a href="unsupervised-learning.html#cb65-15"></a><span class="kw">sqrt</span>(<span class="kw">eigen</span>(A1)<span class="op">$</span>value)  </span>
<span id="cb65-16"><a href="unsupervised-learning.html#cb65-16"></a><span class="kw">eigen</span>(A1)<span class="op">$</span>vector</span>
<span id="cb65-17"><a href="unsupervised-learning.html#cb65-17"></a><span class="kw">eigen</span>(A1)<span class="op">$</span>value</span>
<span id="cb65-18"><a href="unsupervised-learning.html#cb65-18"></a></span>
<span id="cb65-19"><a href="unsupervised-learning.html#cb65-19"></a><span class="co"># singular value decomposition</span></span>
<span id="cb65-20"><a href="unsupervised-learning.html#cb65-20"></a>SVD &lt;-<span class="st"> </span><span class="kw">svd</span>(X1)</span>
<span id="cb65-21"><a href="unsupervised-learning.html#cb65-21"></a>SVD<span class="op">$</span>d                       <span class="co"># singular values</span></span>
<span id="cb65-22"><a href="unsupervised-learning.html#cb65-22"></a><span class="kw">rbind</span>(SVD<span class="op">$</span>v[,<span class="dv">1</span>],SVD<span class="op">$</span>v[,<span class="dv">2</span>])  <span class="co"># first two right singular vectors</span></span>
<span id="cb65-23"><a href="unsupervised-learning.html#cb65-23"></a></span>
<span id="cb65-24"><a href="unsupervised-learning.html#cb65-24"></a><span class="co"># PCA with package PCA</span></span>
<span id="cb65-25"><a href="unsupervised-learning.html#cb65-25"></a>t.pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(X1,<span class="dt">cor=</span><span class="ot">TRUE</span>)</span>
<span id="cb65-26"><a href="unsupervised-learning.html#cb65-26"></a>t.pca<span class="op">$</span>loadings          </span>
<span id="cb65-27"><a href="unsupervised-learning.html#cb65-27"></a><span class="kw">summary</span>(t.pca)</span>
<span id="cb65-28"><a href="unsupervised-learning.html#cb65-28"></a><span class="kw">eigen</span>(A1)<span class="op">$</span>value<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(A1)<span class="op">$</span>value)</span>
<span id="cb65-29"><a href="unsupervised-learning.html#cb65-29"></a></span>
<span id="cb65-30"><a href="unsupervised-learning.html#cb65-30"></a><span class="co"># PCA Sports Cars weights</span></span>
<span id="cb65-31"><a href="unsupervised-learning.html#cb65-31"></a>alpha &lt;-<span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">1</span>]<span class="op">/</span>sds</span>
<span id="cb65-32"><a href="unsupervised-learning.html#cb65-32"></a>(alpha_star &lt;-<span class="st"> </span><span class="kw">c</span>(alpha[<span class="dv">1</span>],alpha[<span class="dv">2</span>]<span class="op">-</span>alpha[<span class="dv">1</span>], alpha[<span class="dv">3</span>], alpha[<span class="dv">4</span>], alpha[<span class="dv">5</span>]<span class="op">-</span>alpha[<span class="dv">2</span>])<span class="op">/</span>alpha[<span class="dv">1</span>])</span>
<span id="cb65-33"><a href="unsupervised-learning.html#cb65-33"></a></span>
<span id="cb65-34"><a href="unsupervised-learning.html#cb65-34"></a><span class="co"># plot first two principal components</span></span>
<span id="cb65-35"><a href="unsupervised-learning.html#cb65-35"></a>dat3 &lt;-<span class="st"> </span>d.data </span>
<span id="cb65-36"><a href="unsupervised-learning.html#cb65-36"></a>dat3<span class="op">$</span>v1 &lt;-<span class="st"> </span>X1 <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">1</span>]</span>
<span id="cb65-37"><a href="unsupervised-learning.html#cb65-37"></a>dat3<span class="op">$</span>v2 &lt;-<span class="st"> </span>X1 <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">2</span>]</span>
<span id="cb65-38"><a href="unsupervised-learning.html#cb65-38"></a></span>
<span id="cb65-39"><a href="unsupervised-learning.html#cb65-39"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">ylab=</span><span class="st">&quot;2nd principal component&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;1st principal component&quot;</span>, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;principal components analysis&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb65-40"><a href="unsupervised-learning.html#cb65-40"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(dat3<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),]</span>
<span id="cb65-41"><a href="unsupervised-learning.html#cb65-41"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb65-42"><a href="unsupervised-learning.html#cb65-42"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(dat3<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),]</span>
<span id="cb65-43"><a href="unsupervised-learning.html#cb65-43"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb65-44"><a href="unsupervised-learning.html#cb65-44"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;tau&gt;=21&quot;</span>, <span class="st">&quot;17&lt;=tau&lt;21&quot;</span>, <span class="st">&quot;tau&lt;17 (sports car)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb65-45"><a href="unsupervised-learning.html#cb65-45"></a></span>
<span id="cb65-46"><a href="unsupervised-learning.html#cb65-46"></a><span class="co"># reconstruction error</span></span>
<span id="cb65-47"><a href="unsupervised-learning.html#cb65-47"></a>reconstruction.PCA &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(<span class="dv">5</span>))</span>
<span id="cb65-48"><a href="unsupervised-learning.html#cb65-48"></a></span>
<span id="cb65-49"><a href="unsupervised-learning.html#cb65-49"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb65-50"><a href="unsupervised-learning.html#cb65-50"></a>  Xp &lt;-<span class="st"> </span>SVD<span class="op">$</span>v[,<span class="dv">1</span><span class="op">:</span>p] <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(SVD<span class="op">$</span>v[,<span class="dv">1</span><span class="op">:</span>p]) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X)</span>
<span id="cb65-51"><a href="unsupervised-learning.html#cb65-51"></a>  Xp &lt;-<span class="st"> </span><span class="kw">t</span>(Xp)</span>
<span id="cb65-52"><a href="unsupervised-learning.html#cb65-52"></a>  reconstruction.PCA[p] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">as.matrix</span>((X<span class="op">-</span>Xp)<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">nrow</span>(X))</span>
<span id="cb65-53"><a href="unsupervised-learning.html#cb65-53"></a>               }</span>
<span id="cb65-54"><a href="unsupervised-learning.html#cb65-54"></a><span class="kw">round</span>(reconstruction.PCA,<span class="dv">2</span>)               </span>
<span id="cb65-55"><a href="unsupervised-learning.html#cb65-55"></a></span>
<span id="cb65-56"><a href="unsupervised-learning.html#cb65-56"></a><span class="co"># scatter plot</span></span>
<span id="cb65-57"><a href="unsupervised-learning.html#cb65-57"></a>switch_sign &lt;-<span class="st"> </span><span class="dv">-1</span>           <span class="co"># switch sign of the first component to make svd and princomp compatible</span></span>
<span id="cb65-58"><a href="unsupervised-learning.html#cb65-58"></a>tt.pca &lt;-<span class="st"> </span>t.pca<span class="op">$</span>scores</span>
<span id="cb65-59"><a href="unsupervised-learning.html#cb65-59"></a>tt.pca[,<span class="dv">1</span>] &lt;-<span class="st"> </span>switch_sign <span class="op">*</span>tt.pca[,<span class="dv">1</span>]</span>
<span id="cb65-60"><a href="unsupervised-learning.html#cb65-60"></a><span class="kw">pairs</span>(tt.pca,<span class="dt">diag.panel=</span>panel.qq,<span class="dt">upper.panel=</span>panel.cor)</span>
<span id="cb65-61"><a href="unsupervised-learning.html#cb65-61"></a></span>
<span id="cb65-62"><a href="unsupervised-learning.html#cb65-62"></a><span class="co"># biplot</span></span>
<span id="cb65-63"><a href="unsupervised-learning.html#cb65-63"></a>tt.pca &lt;-<span class="st"> </span>t.pca</span>
<span id="cb65-64"><a href="unsupervised-learning.html#cb65-64"></a>tt.pca<span class="op">$</span>scores[,<span class="dv">1</span>] &lt;-<span class="st">  </span>switch_sign <span class="op">*</span><span class="st"> </span>tt.pca<span class="op">$</span>scores[,<span class="dv">1</span>]</span>
<span id="cb65-65"><a href="unsupervised-learning.html#cb65-65"></a>tt.pca<span class="op">$</span>loadings[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>switch_sign <span class="op">*</span><span class="st"> </span>tt.pca<span class="op">$</span>loadings[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span>] </span>
<span id="cb65-66"><a href="unsupervised-learning.html#cb65-66"></a><span class="kw">biplot</span>(tt.pca,<span class="dt">choices=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">scale=</span><span class="dv">0</span>, <span class="dt">expand=</span><span class="dv">2</span>, <span class="dt">xlab=</span><span class="st">&quot;1st principal component&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;2nd principal component&quot;</span>, <span class="dt">cex=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">1.5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>))</span></code></pre></div>
</div>
<div id="è‡ªç¼–ç -1" class="section level3">
<h3><span class="header-section-number">5.5.3</span> è‡ªç¼–ç </h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="unsupervised-learning.html#cb66-1"></a>bottleneck<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(q00, q22){</span>
<span id="cb66-2"><a href="unsupervised-learning.html#cb66-2"></a>   Input &lt;-<span class="st"> </span><span class="kw">layer_input</span>(<span class="dt">shape =</span> <span class="kw">c</span>(q00), <span class="dt">dtype =</span> <span class="st">&#39;float32&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;Input&#39;</span>)</span>
<span id="cb66-3"><a href="unsupervised-learning.html#cb66-3"></a>   </span>
<span id="cb66-4"><a href="unsupervised-learning.html#cb66-4"></a>   Output =<span class="st"> </span>Input <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb66-5"><a href="unsupervised-learning.html#cb66-5"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q22, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Bottleneck&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb66-6"><a href="unsupervised-learning.html#cb66-6"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q00, <span class="dt">activation=</span><span class="st">&#39;linear&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Output&#39;</span>)</span>
<span id="cb66-7"><a href="unsupervised-learning.html#cb66-7"></a></span>
<span id="cb66-8"><a href="unsupervised-learning.html#cb66-8"></a>   model &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs =</span> Input, <span class="dt">outputs =</span> Output)</span>
<span id="cb66-9"><a href="unsupervised-learning.html#cb66-9"></a>   </span>
<span id="cb66-10"><a href="unsupervised-learning.html#cb66-10"></a>   model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">compile</span>(<span class="dt">optimizer =</span> <span class="kw">optimizer_nadam</span>(), <span class="dt">loss =</span> <span class="st">&#39;mean_squared_error&#39;</span>)</span>
<span id="cb66-11"><a href="unsupervised-learning.html#cb66-11"></a>   model</span>
<span id="cb66-12"><a href="unsupervised-learning.html#cb66-12"></a>   }</span>
<span id="cb66-13"><a href="unsupervised-learning.html#cb66-13"></a></span>
<span id="cb66-14"><a href="unsupervised-learning.html#cb66-14"></a>bottleneck<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(q00, q11, q22){   </span>
<span id="cb66-15"><a href="unsupervised-learning.html#cb66-15"></a>   Input &lt;-<span class="st"> </span><span class="kw">layer_input</span>(<span class="dt">shape =</span> <span class="kw">c</span>(q00), <span class="dt">dtype =</span> <span class="st">&#39;float32&#39;</span>, <span class="dt">name =</span> <span class="st">&#39;Input&#39;</span>)</span>
<span id="cb66-16"><a href="unsupervised-learning.html#cb66-16"></a>   </span>
<span id="cb66-17"><a href="unsupervised-learning.html#cb66-17"></a>   Encoder =<span class="st"> </span>Input <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb66-18"><a href="unsupervised-learning.html#cb66-18"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q11, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Layer1&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb66-19"><a href="unsupervised-learning.html#cb66-19"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q22, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Bottleneck&#39;</span>) </span>
<span id="cb66-20"><a href="unsupervised-learning.html#cb66-20"></a></span>
<span id="cb66-21"><a href="unsupervised-learning.html#cb66-21"></a>   Decoder =<span class="st"> </span>Encoder <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb66-22"><a href="unsupervised-learning.html#cb66-22"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q11, <span class="dt">activation=</span><span class="st">&#39;tanh&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Layer3&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb66-23"><a href="unsupervised-learning.html#cb66-23"></a><span class="st">          </span><span class="kw">layer_dense</span>(<span class="dt">units=</span>q00, <span class="dt">activation=</span><span class="st">&#39;linear&#39;</span>, <span class="dt">use_bias=</span><span class="ot">FALSE</span>, <span class="dt">name=</span><span class="st">&#39;Output&#39;</span>)</span>
<span id="cb66-24"><a href="unsupervised-learning.html#cb66-24"></a></span>
<span id="cb66-25"><a href="unsupervised-learning.html#cb66-25"></a>   model &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs =</span> Input, <span class="dt">outputs =</span> Decoder)</span>
<span id="cb66-26"><a href="unsupervised-learning.html#cb66-26"></a>   model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">compile</span>(<span class="dt">optimizer =</span> <span class="kw">optimizer_nadam</span>(), <span class="dt">loss =</span> <span class="st">&#39;mean_squared_error&#39;</span>)</span>
<span id="cb66-27"><a href="unsupervised-learning.html#cb66-27"></a>   model</span>
<span id="cb66-28"><a href="unsupervised-learning.html#cb66-28"></a>   }</span>
<span id="cb66-29"><a href="unsupervised-learning.html#cb66-29"></a></span>
<span id="cb66-30"><a href="unsupervised-learning.html#cb66-30"></a><span class="co"># bottleneck architecture</span></span>
<span id="cb66-31"><a href="unsupervised-learning.html#cb66-31"></a>q1 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb66-32"><a href="unsupervised-learning.html#cb66-32"></a>q2 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb66-33"><a href="unsupervised-learning.html#cb66-33"></a>q0 &lt;-<span class="st"> </span><span class="kw">ncol</span>(X)</span>
<span id="cb66-34"><a href="unsupervised-learning.html#cb66-34"></a></span>
<span id="cb66-35"><a href="unsupervised-learning.html#cb66-35"></a><span class="co"># pre-training 1: merging layers 1 and 3 (skipping bottleneck)</span></span>
<span id="cb66-36"><a href="unsupervised-learning.html#cb66-36"></a>model<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">bottleneck.1</span>(q0, q1)</span>
<span id="cb66-37"><a href="unsupervised-learning.html#cb66-37"></a>model<span class="fl">.1</span></span>
<span id="cb66-38"><a href="unsupervised-learning.html#cb66-38"></a>epochs &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb66-39"><a href="unsupervised-learning.html#cb66-39"></a>batch_size &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb66-40"><a href="unsupervised-learning.html#cb66-40"></a></span>
<span id="cb66-41"><a href="unsupervised-learning.html#cb66-41"></a><span class="co"># fit the merged model</span></span>
<span id="cb66-42"><a href="unsupervised-learning.html#cb66-42"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb66-43"><a href="unsupervised-learning.html#cb66-43"></a>  fit &lt;-<span class="st"> </span>model<span class="fl">.1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fit</span>(<span class="kw">as.matrix</span>(X), <span class="kw">as.matrix</span>(X), <span class="dt">epochs=</span>epochs, <span class="dt">batch_size=</span>batch_size, <span class="dt">verbose=</span><span class="dv">0</span>)</span>
<span id="cb66-44"><a href="unsupervised-learning.html#cb66-44"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb66-45"><a href="unsupervised-learning.html#cb66-45"></a></span>
<span id="cb66-46"><a href="unsupervised-learning.html#cb66-46"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss)), <span class="dt">y=</span><span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0),  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0))),<span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="st">&#39;epochs&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Frobenius norm loss&#39;</span>, <span class="dt">main=</span><span class="st">&quot;gradient descent algorithm&quot;</span>) </span>
<span id="cb66-47"><a href="unsupervised-learning.html#cb66-47"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="fl">0.6124</span>), <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb66-48"><a href="unsupervised-learning.html#cb66-48"></a> </span>
<span id="cb66-49"><a href="unsupervised-learning.html#cb66-49"></a><span class="co"># neuron activations in the central layer </span></span>
<span id="cb66-50"><a href="unsupervised-learning.html#cb66-50"></a>zz &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs=</span>model<span class="fl">.1</span><span class="op">$</span>input, <span class="dt">outputs=</span><span class="kw">get_layer</span>(model<span class="fl">.1</span>, <span class="st">&#39;Bottleneck&#39;</span>)<span class="op">$</span>output)</span>
<span id="cb66-51"><a href="unsupervised-learning.html#cb66-51"></a>yy &lt;-<span class="st"> </span>zz <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb66-52"><a href="unsupervised-learning.html#cb66-52"></a></span>
<span id="cb66-53"><a href="unsupervised-learning.html#cb66-53"></a><span class="co"># pre-training 2: middlepart</span></span>
<span id="cb66-54"><a href="unsupervised-learning.html#cb66-54"></a>model<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">bottleneck.1</span>(q1, q2)</span>
<span id="cb66-55"><a href="unsupervised-learning.html#cb66-55"></a>model<span class="fl">.2</span></span>
<span id="cb66-56"><a href="unsupervised-learning.html#cb66-56"></a>epochs &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb66-57"><a href="unsupervised-learning.html#cb66-57"></a></span>
<span id="cb66-58"><a href="unsupervised-learning.html#cb66-58"></a><span class="co"># fit the merged model</span></span>
<span id="cb66-59"><a href="unsupervised-learning.html#cb66-59"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb66-60"><a href="unsupervised-learning.html#cb66-60"></a>  fit &lt;-<span class="st"> </span>model<span class="fl">.2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fit</span>(<span class="kw">as.matrix</span>(yy), <span class="kw">as.matrix</span>(yy), <span class="dt">epochs=</span>epochs, <span class="dt">batch_size=</span>batch_size, <span class="dt">verbose=</span><span class="dv">0</span>)</span>
<span id="cb66-61"><a href="unsupervised-learning.html#cb66-61"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb66-62"><a href="unsupervised-learning.html#cb66-62"></a></span>
<span id="cb66-63"><a href="unsupervised-learning.html#cb66-63"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss)), <span class="dt">y=</span><span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0),  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0))),<span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="st">&#39;epochs&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Frobenius norm loss&#39;</span>, <span class="dt">main=</span><span class="st">&quot;gradient descent algorithm&quot;</span>) </span>
<span id="cb66-64"><a href="unsupervised-learning.html#cb66-64"></a></span>
<span id="cb66-65"><a href="unsupervised-learning.html#cb66-65"></a><span class="co"># fitting the full model</span></span>
<span id="cb66-66"><a href="unsupervised-learning.html#cb66-66"></a>model<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">bottleneck.3</span>(q0, q1, q2)</span>
<span id="cb66-67"><a href="unsupervised-learning.html#cb66-67"></a>model<span class="fl">.3</span></span>
<span id="cb66-68"><a href="unsupervised-learning.html#cb66-68"></a></span>
<span id="cb66-69"><a href="unsupervised-learning.html#cb66-69"></a><span class="co"># set weights</span></span>
<span id="cb66-70"><a href="unsupervised-learning.html#cb66-70"></a>weight<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">get_weights</span>(model<span class="fl">.3</span>)</span>
<span id="cb66-71"><a href="unsupervised-learning.html#cb66-71"></a>weight<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">get_weights</span>(model<span class="fl">.1</span>)</span>
<span id="cb66-72"><a href="unsupervised-learning.html#cb66-72"></a>weight<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">get_weights</span>(model<span class="fl">.2</span>)</span>
<span id="cb66-73"><a href="unsupervised-learning.html#cb66-73"></a>weight<span class="fl">.3</span>[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.1</span>[[<span class="dv">1</span>]]</span>
<span id="cb66-74"><a href="unsupervised-learning.html#cb66-74"></a>weight<span class="fl">.3</span>[[<span class="dv">4</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.1</span>[[<span class="dv">2</span>]]</span>
<span id="cb66-75"><a href="unsupervised-learning.html#cb66-75"></a>weight<span class="fl">.3</span>[[<span class="dv">2</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.2</span>[[<span class="dv">1</span>]]</span>
<span id="cb66-76"><a href="unsupervised-learning.html#cb66-76"></a>weight<span class="fl">.3</span>[[<span class="dv">3</span>]] &lt;-<span class="st"> </span>weight<span class="fl">.2</span>[[<span class="dv">2</span>]]</span>
<span id="cb66-77"><a href="unsupervised-learning.html#cb66-77"></a><span class="kw">set_weights</span>(model<span class="fl">.3</span>, weight<span class="fl">.3</span>)</span>
<span id="cb66-78"><a href="unsupervised-learning.html#cb66-78"></a>fit0 &lt;-<span class="st"> </span>model<span class="fl">.3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb66-79"><a href="unsupervised-learning.html#cb66-79"></a></span>
<span id="cb66-80"><a href="unsupervised-learning.html#cb66-80"></a><span class="co"># reconstruction error of the pre-calibrated network</span></span>
<span id="cb66-81"><a href="unsupervised-learning.html#cb66-81"></a><span class="co"># note that this error may differ from the tutorial because we did not set a seed</span></span>
<span id="cb66-82"><a href="unsupervised-learning.html#cb66-82"></a><span class="kw">round</span>(<span class="kw">Frobenius.loss</span>(X,fit0),<span class="dv">4</span>)</span>
<span id="cb66-83"><a href="unsupervised-learning.html#cb66-83"></a></span>
<span id="cb66-84"><a href="unsupervised-learning.html#cb66-84"></a><span class="co"># calibrate full bottleneck network</span></span>
<span id="cb66-85"><a href="unsupervised-learning.html#cb66-85"></a>epochs &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb66-86"><a href="unsupervised-learning.html#cb66-86"></a>batch_size &lt;-<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb66-87"><a href="unsupervised-learning.html#cb66-87"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb66-88"><a href="unsupervised-learning.html#cb66-88"></a>  fit &lt;-<span class="st"> </span>model<span class="fl">.3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fit</span>(<span class="kw">as.matrix</span>(X), <span class="kw">as.matrix</span>(X), <span class="dt">epochs=</span>epochs, <span class="dt">batch_size=</span>batch_size, <span class="dt">verbose=</span><span class="dv">0</span>)</span>
<span id="cb66-89"><a href="unsupervised-learning.html#cb66-89"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb66-90"><a href="unsupervised-learning.html#cb66-90"></a></span>
<span id="cb66-91"><a href="unsupervised-learning.html#cb66-91"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss)), <span class="dt">y=</span><span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="kw">sqrt</span>(fit[[<span class="dv">2</span>]]<span class="op">$</span>loss<span class="op">*</span>q0))),<span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="st">&#39;epochs&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Frobenius norm loss&#39;</span>, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;gradient descent algorithm&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>) </span>
<span id="cb66-92"><a href="unsupervised-learning.html#cb66-92"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="fl">0.6124</span>), <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>) </span>
<span id="cb66-93"><a href="unsupervised-learning.html#cb66-93"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;decrease GDM&quot;</span>, <span class="st">&quot;PCA(p=2)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">19</span>,<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb66-94"><a href="unsupervised-learning.html#cb66-94"></a></span>
<span id="cb66-95"><a href="unsupervised-learning.html#cb66-95"></a><span class="co"># reconstruction error (slightly differs from 0.5611 because of missing seed)</span></span>
<span id="cb66-96"><a href="unsupervised-learning.html#cb66-96"></a>fit0 &lt;-<span class="st"> </span>model<span class="fl">.3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb66-97"><a href="unsupervised-learning.html#cb66-97"></a><span class="kw">round</span>(<span class="kw">Frobenius.loss</span>(X,fit0),<span class="dv">4</span>)</span>
<span id="cb66-98"><a href="unsupervised-learning.html#cb66-98"></a></span>
<span id="cb66-99"><a href="unsupervised-learning.html#cb66-99"></a><span class="co"># read off the bottleneck activations</span></span>
<span id="cb66-100"><a href="unsupervised-learning.html#cb66-100"></a>encoder &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs=</span>model<span class="fl">.3</span><span class="op">$</span>input, <span class="dt">outputs=</span><span class="kw">get_layer</span>(model<span class="fl">.3</span>, <span class="st">&#39;Bottleneck&#39;</span>)<span class="op">$</span>output)</span>
<span id="cb66-101"><a href="unsupervised-learning.html#cb66-101"></a>y&lt;-<span class="st"> </span><span class="kw">predict</span>(encoder,<span class="kw">as.matrix</span>(X))</span>
<span id="cb66-102"><a href="unsupervised-learning.html#cb66-102"></a>y0 &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(y))<span class="op">*</span><span class="fl">1.1</span></span>
<span id="cb66-103"><a href="unsupervised-learning.html#cb66-103"></a></span>
<span id="cb66-104"><a href="unsupervised-learning.html#cb66-104"></a><span class="co"># note that we may need sign switches to make it comparable to PCA</span></span>
<span id="cb66-105"><a href="unsupervised-learning.html#cb66-105"></a><span class="kw">plot</span>(<span class="dt">x=</span>y[,<span class="dv">1</span>], <span class="dt">y=</span>y[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>y0,y0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>y0,y0), <span class="dt">ylab=</span><span class="st">&quot;2nd bottleneck neuron&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;1st bottleneck neuron&quot;</span>, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;bottleneck neural network autoencoder&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb66-106"><a href="unsupervised-learning.html#cb66-106"></a>dat0 &lt;-<span class="st"> </span>y[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),]</span>
<span id="cb66-107"><a href="unsupervised-learning.html#cb66-107"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0[,<span class="dv">1</span>], <span class="dt">y=</span>dat0[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb66-108"><a href="unsupervised-learning.html#cb66-108"></a>dat0 &lt;-<span class="st"> </span>y[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),]</span>
<span id="cb66-109"><a href="unsupervised-learning.html#cb66-109"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0[,<span class="dv">1</span>], <span class="dt">y=</span>dat0[,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb66-110"><a href="unsupervised-learning.html#cb66-110"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;tau&gt;=21&quot;</span>, <span class="st">&quot;17&lt;=tau&lt;21&quot;</span>, <span class="st">&quot;tau&lt;17 (sports car)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
<p>ä»è¿™ä¸ªå›¾ä¸­æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œä¸¤ç§æ–¹æ³•éƒ½å¾—åˆ°äº†ç›¸ä¼¼çš„ç»“æœã€‚
ä½†åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒBNNçš„é‡æ„è¯¯å·®è¾ƒå°ã€‚åœ¨å°‘æ•°æƒ…å†µä¸‹ï¼ŒBNNå¯ä»¥å¾—åˆ°æ›´å¥½çš„é‡å»ºç»“æœ(å³ä¸‹è§’çš„æ©™è‰²ç‚¹)ã€‚
è¿™ä¸ªä¾‹å­çš„ä¸»è¦ç»“è®ºæ˜¯ï¼Œå¯¹äºä½ç»´æ•°çš„é—®é¢˜ï¼Œä¸»æˆåˆ†åˆ†æé€šå¸¸å°±å¯ä»¥äº†ï¼Œå› ä¸ºéçº¿æ€§çš„éƒ¨åˆ†å¹¶æ²¡æœ‰å‘æŒ¥å…³é”®ä½œç”¨ã€‚</p>
</div>
<div id="k-means" class="section level3">
<h3><span class="header-section-number">5.5.4</span> K-means</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="unsupervised-learning.html#cb67-1"></a><span class="co"># initialize</span></span>
<span id="cb67-2"><a href="unsupervised-learning.html#cb67-2"></a>Kaverage &lt;-<span class="st"> </span><span class="kw">colMeans</span>(X)</span>
<span id="cb67-3"><a href="unsupervised-learning.html#cb67-3"></a>K0 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb67-4"><a href="unsupervised-learning.html#cb67-4"></a>TWCD &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(K0))  <span class="co"># total within-cluster dissimilarity</span></span>
<span id="cb67-5"><a href="unsupervised-learning.html#cb67-5"></a>Classifier &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>, <span class="kw">c</span>(K0, <span class="kw">nrow</span>(X)))</span>
<span id="cb67-6"><a href="unsupervised-learning.html#cb67-6"></a>(TWCD[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">colSums</span>(<span class="kw">as.matrix</span>(X<span class="op">^</span><span class="dv">2</span>))))</span>
<span id="cb67-7"><a href="unsupervised-learning.html#cb67-7"></a></span>
<span id="cb67-8"><a href="unsupervised-learning.html#cb67-8"></a><span class="co"># run K-means algorithm</span></span>
<span id="cb67-9"><a href="unsupervised-learning.html#cb67-9"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb67-10"><a href="unsupervised-learning.html#cb67-10"></a><span class="cf">for</span> (K <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>K0){ </span>
<span id="cb67-11"><a href="unsupervised-learning.html#cb67-11"></a>   <span class="cf">if</span> (K<span class="op">==</span><span class="dv">2</span>){(K_res &lt;-<span class="st"> </span><span class="kw">kmeans</span>(X,K) )}</span>
<span id="cb67-12"><a href="unsupervised-learning.html#cb67-12"></a>   <span class="cf">if</span> (K<span class="op">&gt;</span><span class="dv">2</span>){(K_res  &lt;-<span class="st"> </span><span class="kw">kmeans</span>(X,K_centers) )}</span>
<span id="cb67-13"><a href="unsupervised-learning.html#cb67-13"></a>   TWCD[K] &lt;-<span class="st"> </span><span class="kw">sum</span>(K_res<span class="op">$</span>withins)</span>
<span id="cb67-14"><a href="unsupervised-learning.html#cb67-14"></a>   Classifier[K,] &lt;-<span class="st"> </span>K_res<span class="op">$</span>cluster</span>
<span id="cb67-15"><a href="unsupervised-learning.html#cb67-15"></a>   K_centers &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="kw">c</span>(K<span class="op">+</span><span class="dv">1</span>, <span class="kw">ncol</span>(X)))</span>
<span id="cb67-16"><a href="unsupervised-learning.html#cb67-16"></a>   K_centers[K<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span>Kaverage</span>
<span id="cb67-17"><a href="unsupervised-learning.html#cb67-17"></a>   K_centers[<span class="dv">1</span><span class="op">:</span>K,] &lt;-<span class="st"> </span>K_res<span class="op">$</span>centers </span>
<span id="cb67-18"><a href="unsupervised-learning.html#cb67-18"></a>                }</span>
<span id="cb67-19"><a href="unsupervised-learning.html#cb67-19"></a></span>
<span id="cb67-20"><a href="unsupervised-learning.html#cb67-20"></a><span class="co"># plot losses                </span></span>
<span id="cb67-21"><a href="unsupervised-learning.html#cb67-21"></a>xtitle &lt;-<span class="st"> &quot;decrease in total within-cluster dissimilarity &quot;</span></span>
<span id="cb67-22"><a href="unsupervised-learning.html#cb67-22"></a><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>K0), <span class="dt">y=</span>TWCD, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(TWCD)), <span class="dt">main=</span><span class="kw">list</span>(xtitle, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylab=</span><span class="st">&quot;total within-cluster dissimilarity&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;hyperparameter K&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb67-23"><a href="unsupervised-learning.html#cb67-23"></a><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>K0), <span class="dt">y=</span>TWCD, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span>
<span id="cb67-24"><a href="unsupervised-learning.html#cb67-24"></a></span>
<span id="cb67-25"><a href="unsupervised-learning.html#cb67-25"></a><span class="co"># singular value decomposition</span></span>
<span id="cb67-26"><a href="unsupervised-learning.html#cb67-26"></a>SVD &lt;-<span class="st"> </span><span class="kw">svd</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb67-27"><a href="unsupervised-learning.html#cb67-27"></a>pca &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb67-28"><a href="unsupervised-learning.html#cb67-28"></a>dat3 &lt;-<span class="st"> </span>d.data</span>
<span id="cb67-29"><a href="unsupervised-learning.html#cb67-29"></a>dat3<span class="op">$</span>v1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">1</span>]]</span>
<span id="cb67-30"><a href="unsupervised-learning.html#cb67-30"></a>dat3<span class="op">$</span>v2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">2</span>]]</span>
<span id="cb67-31"><a href="unsupervised-learning.html#cb67-31"></a></span>
<span id="cb67-32"><a href="unsupervised-learning.html#cb67-32"></a>lim0 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb67-33"><a href="unsupervised-learning.html#cb67-33"></a></span>
<span id="cb67-34"><a href="unsupervised-learning.html#cb67-34"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;K-means vs. PCA&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb67-35"><a href="unsupervised-learning.html#cb67-35"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(Classifier[<span class="dv">4</span>,]<span class="op">==</span><span class="dv">4</span>),]</span>
<span id="cb67-36"><a href="unsupervised-learning.html#cb67-36"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb67-37"><a href="unsupervised-learning.html#cb67-37"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(Classifier[<span class="dv">4</span>,]<span class="op">==</span><span class="dv">1</span>),]</span>
<span id="cb67-38"><a href="unsupervised-learning.html#cb67-38"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb67-39"><a href="unsupervised-learning.html#cb67-39"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(Classifier[<span class="dv">4</span>,]<span class="op">==</span><span class="dv">3</span>),]</span>
<span id="cb67-40"><a href="unsupervised-learning.html#cb67-40"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb67-41"><a href="unsupervised-learning.html#cb67-41"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;cluster 1&quot;</span>, <span class="st">&quot;cluster 2&quot;</span>, <span class="st">&quot;cluster 3&quot;</span>, <span class="st">&quot;cluster 4&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="k-medoids" class="section level3">
<h3><span class="header-section-number">5.5.5</span> K-medoids</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="unsupervised-learning.html#cb68-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb68-2"><a href="unsupervised-learning.html#cb68-2"></a>(K_res &lt;-<span class="st"> </span><span class="kw">pam</span>(X, <span class="dt">k=</span><span class="dv">4</span>, <span class="dt">metric=</span><span class="st">&quot;manhattan&quot;</span>, <span class="dt">diss=</span><span class="ot">FALSE</span>))</span>
<span id="cb68-3"><a href="unsupervised-learning.html#cb68-3"></a></span>
<span id="cb68-4"><a href="unsupervised-learning.html#cb68-4"></a><span class="co"># plot K-medoids versus PCA</span></span>
<span id="cb68-5"><a href="unsupervised-learning.html#cb68-5"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;K-medoids vs. PCA&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb68-6"><a href="unsupervised-learning.html#cb68-6"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(K_res<span class="op">$</span>cluster<span class="op">==</span><span class="dv">4</span>),]</span>
<span id="cb68-7"><a href="unsupervised-learning.html#cb68-7"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb68-8"><a href="unsupervised-learning.html#cb68-8"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(K_res<span class="op">$</span>cluster<span class="op">==</span><span class="dv">3</span>),]</span>
<span id="cb68-9"><a href="unsupervised-learning.html#cb68-9"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb68-10"><a href="unsupervised-learning.html#cb68-10"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(K_res<span class="op">$</span>cluster<span class="op">==</span><span class="dv">2</span>),]</span>
<span id="cb68-11"><a href="unsupervised-learning.html#cb68-11"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb68-12"><a href="unsupervised-learning.html#cb68-12"></a><span class="kw">points</span>(<span class="dt">x=</span>dat3[K_res<span class="op">$</span>id.med,<span class="st">&quot;v1&quot;</span>],<span class="dt">y=</span>dat3[K_res<span class="op">$</span>id.med,<span class="st">&quot;v2&quot;</span>], <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="dv">2</span>)</span>
<span id="cb68-13"><a href="unsupervised-learning.html#cb68-13"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;cluster 1&quot;</span>, <span class="st">&quot;cluster 2&quot;</span>, <span class="st">&quot;cluster 3&quot;</span>, <span class="st">&quot;cluster 4&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="gaussian-mixture-model" class="section level3">
<h3><span class="header-section-number">5.5.6</span> Gaussian mixture model</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="unsupervised-learning.html#cb69-1"></a>seed &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb69-2"><a href="unsupervised-learning.html#cb69-2"></a><span class="kw">set.seed</span>(seed)</span>
<span id="cb69-3"><a href="unsupervised-learning.html#cb69-3"></a>K_res &lt;-<span class="st"> </span><span class="kw">GMM</span>(X, <span class="dt">gaussian_comps=</span><span class="dv">4</span>, <span class="dt">dist_mode=</span><span class="st">&quot;eucl_dist&quot;</span>, <span class="dt">seed_mode=</span><span class="st">&quot;random_subset&quot;</span>, <span class="dt">em_iter=</span><span class="dv">5</span>, <span class="dt">seed=</span>seed)</span>
<span id="cb69-4"><a href="unsupervised-learning.html#cb69-4"></a><span class="kw">summary</span>(K_res)</span>
<span id="cb69-5"><a href="unsupervised-learning.html#cb69-5"></a>clust &lt;-<span class="st"> </span><span class="kw">predict_GMM</span>(X, K_res<span class="op">$</span>centroids, K_res<span class="op">$</span>covariance_matrices, K_res<span class="op">$</span>weights)<span class="op">$</span>cluster_labels</span>
<span id="cb69-6"><a href="unsupervised-learning.html#cb69-6"></a></span>
<span id="cb69-7"><a href="unsupervised-learning.html#cb69-7"></a>pred &lt;-<span class="st"> </span><span class="kw">predict_GMM</span>(X, K_res<span class="op">$</span>centroids, K_res<span class="op">$</span>covariance_matrices, K_res<span class="op">$</span>weights)</span>
<span id="cb69-8"><a href="unsupervised-learning.html#cb69-8"></a><span class="kw">names</span>(pred)</span>
<span id="cb69-9"><a href="unsupervised-learning.html#cb69-9"></a></span>
<span id="cb69-10"><a href="unsupervised-learning.html#cb69-10"></a>pred<span class="op">$</span>cluster_labels[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb69-11"><a href="unsupervised-learning.html#cb69-11"></a>pred<span class="op">$</span>cluster_proba[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</span>
<span id="cb69-12"><a href="unsupervised-learning.html#cb69-12"></a></span>
<span id="cb69-13"><a href="unsupervised-learning.html#cb69-13"></a>K_res<span class="op">$</span>centroids</span>
<span id="cb69-14"><a href="unsupervised-learning.html#cb69-14"></a></span>
<span id="cb69-15"><a href="unsupervised-learning.html#cb69-15"></a><span class="co"># singular value decomposition</span></span>
<span id="cb69-16"><a href="unsupervised-learning.html#cb69-16"></a>SVD &lt;-<span class="st"> </span><span class="kw">svd</span>(<span class="kw">as.matrix</span>(X))</span>
<span id="cb69-17"><a href="unsupervised-learning.html#cb69-17"></a></span>
<span id="cb69-18"><a href="unsupervised-learning.html#cb69-18"></a>pca &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb69-19"><a href="unsupervised-learning.html#cb69-19"></a>dat3 &lt;-<span class="st"> </span>d.data</span>
<span id="cb69-20"><a href="unsupervised-learning.html#cb69-20"></a>dat3<span class="op">$</span>v1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">1</span>]]</span>
<span id="cb69-21"><a href="unsupervised-learning.html#cb69-21"></a>dat3<span class="op">$</span>v2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X) <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">2</span>]]</span>
<span id="cb69-22"><a href="unsupervised-learning.html#cb69-22"></a></span>
<span id="cb69-23"><a href="unsupervised-learning.html#cb69-23"></a>(kk1 &lt;-<span class="st"> </span>K_res<span class="op">$</span>centroids <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">1</span>]])</span>
<span id="cb69-24"><a href="unsupervised-learning.html#cb69-24"></a>(kk2 &lt;-<span class="st"> </span>K_res<span class="op">$</span>centroids <span class="op">%*%</span><span class="st"> </span>SVD<span class="op">$</span>v[,pca[<span class="dv">2</span>]])</span>
<span id="cb69-25"><a href="unsupervised-learning.html#cb69-25"></a></span>
<span id="cb69-26"><a href="unsupervised-learning.html#cb69-26"></a>lim0 &lt;-<span class="st"> </span><span class="dv">7</span></span>
<span id="cb69-27"><a href="unsupervised-learning.html#cb69-27"></a></span>
<span id="cb69-28"><a href="unsupervised-learning.html#cb69-28"></a><span class="kw">plot</span>(<span class="dt">x=</span>dat3<span class="op">$</span>v1, <span class="dt">y=</span>dat3<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>lim0,lim0), <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">2</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;principal component &quot;</span>, pca[<span class="dv">1</span>], <span class="dt">sep=</span><span class="st">&quot;&quot;</span>),, <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;GMM(diagonal) vs. PCA&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb69-29"><a href="unsupervised-learning.html#cb69-29"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(clust<span class="op">==</span><span class="dv">0</span>),]</span>
<span id="cb69-30"><a href="unsupervised-learning.html#cb69-30"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb69-31"><a href="unsupervised-learning.html#cb69-31"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(clust<span class="op">==</span><span class="dv">3</span>),]</span>
<span id="cb69-32"><a href="unsupervised-learning.html#cb69-32"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb69-33"><a href="unsupervised-learning.html#cb69-33"></a>dat0 &lt;-<span class="st"> </span>dat3[<span class="kw">which</span>(clust<span class="op">==</span><span class="dv">1</span>),]</span>
<span id="cb69-34"><a href="unsupervised-learning.html#cb69-34"></a><span class="kw">points</span>(<span class="dt">x=</span>dat0<span class="op">$</span>v1, <span class="dt">y=</span>dat0<span class="op">$</span>v2, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb69-35"><a href="unsupervised-learning.html#cb69-35"></a><span class="kw">points</span>(<span class="dt">x=</span>kk1,<span class="dt">y=</span>kk2, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="dv">2</span>)</span>
<span id="cb69-36"><a href="unsupervised-learning.html#cb69-36"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;cluster 1&quot;</span>, <span class="st">&quot;cluster 2&quot;</span>, <span class="st">&quot;cluster 3&quot;</span>, <span class="st">&quot;cluster 4&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
<p>å›¾<a href="unsupervised-learning.html#fig:cluster-results">5.4</a>å±•ç¤ºäº†èšç±»çš„ç»“æœï¼ŒGMMsæœ€å¥½ã€‚</p>
<div class="figure" style="text-align: center"><span id="fig:cluster-results"></span>
<img src="plots/5/cluster.png" alt="èšç±»æ¯”è¾ƒ" width="60%"  />
<p class="caption">
Figure 5.4: èšç±»æ¯”è¾ƒ
</p>
</div>
</div>
<div id="t-sne-1" class="section level3">
<h3><span class="header-section-number">5.5.7</span> t-SNE</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="unsupervised-learning.html#cb70-1"></a><span class="kw">require</span>(MASS)</span>
<span id="cb70-2"><a href="unsupervised-learning.html#cb70-2"></a><span class="kw">library</span>(plyr)</span>
<span id="cb70-3"><a href="unsupervised-learning.html#cb70-3"></a><span class="kw">library</span>(stringr)</span>
<span id="cb70-4"><a href="unsupervised-learning.html#cb70-4"></a><span class="kw">library</span>(plotrix)</span>
<span id="cb70-5"><a href="unsupervised-learning.html#cb70-5"></a><span class="kw">library</span>(matrixStats)</span>
<span id="cb70-6"><a href="unsupervised-learning.html#cb70-6"></a><span class="kw">library</span>(tsne)</span>
<span id="cb70-7"><a href="unsupervised-learning.html#cb70-7"></a><span class="kw">library</span>(umap)</span>
<span id="cb70-8"><a href="unsupervised-learning.html#cb70-8"></a><span class="kw">library</span>(kohonen)</span>
<span id="cb70-9"><a href="unsupervised-learning.html#cb70-9"></a>seed &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb70-10"><a href="unsupervised-learning.html#cb70-10"></a><span class="kw">set.seed</span>(seed)</span>
<span id="cb70-11"><a href="unsupervised-learning.html#cb70-11"></a><span class="co"># it takes roughly 50 seconds</span></span>
<span id="cb70-12"><a href="unsupervised-learning.html#cb70-12"></a><span class="co"># KL divergence 0.427991566501587</span></span>
<span id="cb70-13"><a href="unsupervised-learning.html#cb70-13"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb70-14"><a href="unsupervised-learning.html#cb70-14"></a>   (K_res &lt;-<span class="st"> </span><span class="kw">tsne</span>(X, <span class="dt">k=</span><span class="dv">2</span>, <span class="dt">initial_dim=</span><span class="kw">ncol</span>(X), <span class="dt">perplexity=</span><span class="dv">30</span>))</span>
<span id="cb70-15"><a href="unsupervised-learning.html#cb70-15"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb70-16"><a href="unsupervised-learning.html#cb70-16"></a></span>
<span id="cb70-17"><a href="unsupervised-learning.html#cb70-17"></a>i1 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb70-18"><a href="unsupervised-learning.html#cb70-18"></a>i2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb70-19"><a href="unsupervised-learning.html#cb70-19"></a>sign0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb70-20"><a href="unsupervised-learning.html#cb70-20"></a></span>
<span id="cb70-21"><a href="unsupervised-learning.html#cb70-21"></a>K_res1 &lt;-<span class="st"> </span>K_res[,<span class="kw">c</span>(i1,i2)]</span>
<span id="cb70-22"><a href="unsupervised-learning.html#cb70-22"></a>K_res1 &lt;-<span class="st"> </span>sign0 <span class="op">*</span><span class="st"> </span>K_res1</span>
<span id="cb70-23"><a href="unsupervised-learning.html#cb70-23"></a><span class="kw">plot</span>(K_res1, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;component &quot;</span>, i2, <span class="dt">paste=</span><span class="st">&quot;&quot;</span>), <span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;component &quot;</span>, i1, <span class="dt">paste=</span><span class="st">&quot;&quot;</span>), <span class="dt">main=</span><span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;t-SNE with seed &quot;</span>, seed, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">cex=</span><span class="fl">1.5</span>))</span>
<span id="cb70-24"><a href="unsupervised-learning.html#cb70-24"></a>dat0 &lt;-<span class="st"> </span>K_res1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),]</span>
<span id="cb70-25"><a href="unsupervised-learning.html#cb70-25"></a><span class="kw">points</span>(dat0, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb70-26"><a href="unsupervised-learning.html#cb70-26"></a>dat0 &lt;-<span class="st"> </span>K_res1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),]</span>
<span id="cb70-27"><a href="unsupervised-learning.html#cb70-27"></a><span class="kw">points</span>(dat0, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb70-28"><a href="unsupervised-learning.html#cb70-28"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;tau&gt;=21&quot;</span>, <span class="st">&quot;17&lt;=tau&lt;21&quot;</span>, <span class="st">&quot;tau&lt;17 (sports car)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="umap-1" class="section level3">
<h3><span class="header-section-number">5.5.8</span> UMAP</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="unsupervised-learning.html#cb71-1"></a>kNeighbors &lt;-<span class="st"> </span><span class="dv">15</span>     <span class="co"># default is 15</span></span>
<span id="cb71-2"><a href="unsupervised-learning.html#cb71-2"></a>seed &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb71-3"><a href="unsupervised-learning.html#cb71-3"></a><span class="kw">set.seed</span>(seed)</span>
<span id="cb71-4"><a href="unsupervised-learning.html#cb71-4"></a>min_dist &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb71-5"><a href="unsupervised-learning.html#cb71-5"></a></span>
<span id="cb71-6"><a href="unsupervised-learning.html#cb71-6"></a>umap.param &lt;-<span class="st"> </span>umap.defaults</span>
<span id="cb71-7"><a href="unsupervised-learning.html#cb71-7"></a>umap.param<span class="op">$</span>n_components &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb71-8"><a href="unsupervised-learning.html#cb71-8"></a>umap.param<span class="op">$</span>n_neighbors &lt;-<span class="st"> </span>kNeighbors  </span>
<span id="cb71-9"><a href="unsupervised-learning.html#cb71-9"></a>umap.param<span class="op">$</span>random_state &lt;-<span class="st"> </span>seed </span>
<span id="cb71-10"><a href="unsupervised-learning.html#cb71-10"></a>umap.param<span class="op">$</span>min_dist &lt;-<span class="st"> </span>min_dist </span>
<span id="cb71-11"><a href="unsupervised-learning.html#cb71-11"></a></span>
<span id="cb71-12"><a href="unsupervised-learning.html#cb71-12"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb71-13"><a href="unsupervised-learning.html#cb71-13"></a>   (K_res &lt;-<span class="st"> </span><span class="kw">umap</span>(X, <span class="dt">config=</span>umap.param, <span class="dt">method=</span><span class="st">&quot;naive&quot;</span>))</span>
<span id="cb71-14"><a href="unsupervised-learning.html#cb71-14"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb71-15"><a href="unsupervised-learning.html#cb71-15"></a></span>
<span id="cb71-16"><a href="unsupervised-learning.html#cb71-16"></a>i1 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb71-17"><a href="unsupervised-learning.html#cb71-17"></a>i2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb71-18"><a href="unsupervised-learning.html#cb71-18"></a>sign0 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb71-19"><a href="unsupervised-learning.html#cb71-19"></a></span>
<span id="cb71-20"><a href="unsupervised-learning.html#cb71-20"></a>K_res1 &lt;-<span class="st"> </span>K_res<span class="op">$</span>layout[,<span class="kw">c</span>(i1,i2)]</span>
<span id="cb71-21"><a href="unsupervised-learning.html#cb71-21"></a>K_res1 &lt;-<span class="st"> </span>sign0 <span class="op">*</span><span class="st"> </span>K_res1</span>
<span id="cb71-22"><a href="unsupervised-learning.html#cb71-22"></a><span class="kw">plot</span>(K_res1, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>, <span class="dt">ylab=</span><span class="kw">paste</span>(<span class="st">&quot;component &quot;</span>, i2, <span class="dt">paste=</span><span class="st">&quot;&quot;</span>), <span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;component &quot;</span>, i1, <span class="dt">paste=</span><span class="st">&quot;&quot;</span>), <span class="dt">main=</span><span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;UMAP (k=&quot;</span>, kNeighbors, <span class="st">&quot; NN and min_dist=&quot;</span>, min_dist,<span class="st">&quot;)&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">cex=</span><span class="fl">1.5</span>))</span>
<span id="cb71-23"><a href="unsupervised-learning.html#cb71-23"></a>dat0 &lt;-<span class="st"> </span>K_res1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>),]</span>
<span id="cb71-24"><a href="unsupervised-learning.html#cb71-24"></a><span class="kw">points</span>(dat0, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb71-25"><a href="unsupervised-learning.html#cb71-25"></a>dat0 &lt;-<span class="st"> </span>K_res1[<span class="kw">which</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">17</span>),]</span>
<span id="cb71-26"><a href="unsupervised-learning.html#cb71-26"></a><span class="kw">points</span>(dat0, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb71-27"><a href="unsupervised-learning.html#cb71-27"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;tau&gt;=21&quot;</span>, <span class="st">&quot;17&lt;=tau&lt;21&quot;</span>, <span class="st">&quot;tau&lt;17 (sports car)&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">lwd=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
</div>
<div id="kohonen-map" class="section level3">
<h3><span class="header-section-number">5.5.9</span> Kohonen map</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="unsupervised-learning.html#cb72-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb72-2"><a href="unsupervised-learning.html#cb72-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb72-3"><a href="unsupervised-learning.html#cb72-3"></a></span>
<span id="cb72-4"><a href="unsupervised-learning.html#cb72-4"></a><span class="kw">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb72-5"><a href="unsupervised-learning.html#cb72-5"></a>{t1 &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb72-6"><a href="unsupervised-learning.html#cb72-6"></a> som.X &lt;-<span class="st"> </span><span class="kw">som</span>(<span class="kw">as.matrix</span>(X), <span class="dt">grid =</span> <span class="kw">somgrid</span>(<span class="dt">xdim=</span>n1, <span class="dt">ydim=</span>n2, <span class="dt">topo=</span><span class="st">&quot;rectangular&quot;</span>), </span>
<span id="cb72-7"><a href="unsupervised-learning.html#cb72-7"></a>                            <span class="dt">rlen=</span> <span class="dv">100</span>, <span class="dt">dist.fcts=</span><span class="st">&quot;sumofsquares&quot;</span>)</span>
<span id="cb72-8"><a href="unsupervised-learning.html#cb72-8"></a><span class="kw">proc.time</span>()<span class="op">-</span>t1}</span>
<span id="cb72-9"><a href="unsupervised-learning.html#cb72-9"></a></span>
<span id="cb72-10"><a href="unsupervised-learning.html#cb72-10"></a></span>
<span id="cb72-11"><a href="unsupervised-learning.html#cb72-11"></a><span class="kw">summary</span>(som.X)</span>
<span id="cb72-12"><a href="unsupervised-learning.html#cb72-12"></a></span>
<span id="cb72-13"><a href="unsupervised-learning.html#cb72-13"></a><span class="kw">plot</span>(som.X,<span class="kw">c</span>(<span class="st">&quot;changes&quot;</span>), <span class="dt">main=</span><span class="kw">list</span>(<span class="st">&quot;training progress&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>)            <span class="co"># training progress</span></span>
<span id="cb72-14"><a href="unsupervised-learning.html#cb72-14"></a></span>
<span id="cb72-15"><a href="unsupervised-learning.html#cb72-15"></a><span class="kw">plot</span>(som.X,<span class="kw">c</span>(<span class="st">&quot;counts&quot;</span>), <span class="dt">main=</span><span class="st">&quot;allocation counts to neurons&quot;</span>, <span class="dt">cex.lab=</span><span class="fl">1.5</span>)</span>
<span id="cb72-16"><a href="unsupervised-learning.html#cb72-16"></a></span>
<span id="cb72-17"><a href="unsupervised-learning.html#cb72-17"></a>d.data<span class="op">$</span>tau2 &lt;-<span class="st"> </span>d.data<span class="op">$</span>sports_car<span class="op">+</span><span class="kw">as.integer</span>(d.data<span class="op">$</span>tau<span class="op">&lt;</span><span class="dv">21</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb72-18"><a href="unsupervised-learning.html#cb72-18"></a><span class="kw">plot</span>(som.X,<span class="kw">c</span>(<span class="st">&quot;mapping&quot;</span>), <span class="dt">classif=</span><span class="kw">predict</span>(som.X), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>)[d.data<span class="op">$</span>tau2], <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">main=</span><span class="st">&quot;allocation of cases to neurons&quot;</span>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="boosting.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": "github"
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
